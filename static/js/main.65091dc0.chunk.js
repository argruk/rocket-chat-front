(this["webpackJsonprocket-chat-front"]=this["webpackJsonprocket-chat-front"]||[]).push([[0],{100:function(e,t,a){e.exports=a.p+"static/media/notification.56a9110c.mp3"},164:function(e,t,a){},170:function(e,t,a){},234:function(e,t,a){e.exports=a.p+"static/media/lol.f8b7a2e4.mp3"},235:function(e,t,a){e.exports=a.p+"static/media/dr_stone_ending.470614e2.mp3"},262:function(e,t,a){e.exports=a(438)},267:function(e,t,a){},279:function(e,t){},281:function(e,t){},317:function(e,t){},318:function(e,t){},391:function(e,t,a){},394:function(e,t,a){},426:function(e,t,a){},438:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(20),o=a.n(c),s=(a(267),a(268),a(9)),l=a.n(s),i=a(16),u=a(8),m=a(74),d=a(83),f=a(62),h=a(36),p=a(25);function g(e){var t=e.setIsMobile,a=Object(n.useState)(!0),c=Object(u.a)(a,2),o=c[0],s=c[1],l=function(e){t(e),s(!1)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{show:o,onHide:function(){return s(!1)},centered:!0},r.a.createElement(h.a.Body,{closebutton:"true",className:"tc"},r.a.createElement("h3",null,"Swtich to mobile version"),r.a.createElement("div",null,r.a.createElement(p.a,{variant:"primary",onClick:function(){return l(!0)}},"Yes"),r.a.createElement(p.a,{style:{marginLeft:"10%"},variant:"secondary",onClick:function(){return l(!1)}},"No")))))}a(170);var v=a(234),E=a.n(v),b=a(235),y=a.n(b),w=a(47),O=Object({NODE_ENV:"production",PUBLIC_URL:"/rocket-chat-front"}).REACT_APP_APILINK,k=Object({NODE_ENV:"production",PUBLIC_URL:"/rocket-chat-front"}).REACT_APP_TOKEN_SIGNATURE,j=Object({NODE_ENV:"production",PUBLIC_URL:"/rocket-chat-front"}).REACT_APP_TOKEN_AESKEY,x=Object({NODE_ENV:"production",PUBLIC_URL:"/rocket-chat-front"}).REACT_APP_TOKEN_AESIV,C=["Audio","Add Contact","My Account","Logout"],S=["witcher","drStone"],N=[{str:"weak",color:"red"},{str:"weakish",color:"darkorange"},{str:"medium",color:"#E1CB0C"},{str:"okay",color:"springgreen"},{str:"strong",color:"green"}],I=["/faq","/release","/vsuccess","/vfailed"],A=[{question:"Q: What do I do here?",answer:"A: You send messages to other people, could you imagine!!!"},{question:"Q: How to get started?",answer:"A: Please register, then add other people and talk to them as much as you want. Please mind the warning above when you submit any data."},{question:"Q: Who are the creators of this miracle?",answer:"A: Bohdan Boss and Artem Daddy :))"},{question:"Q: What are future plans for this project?",answer:"A: Show WhatsApp and Telegram how to make good apps..."},{question:"Q: Why can I not send emoji without text on PC?",answer:"A: This is a known issue and might be fixed later, hold tight!"},{question:"Q: Are my messages 100% secure?",answer:"A: Let's say sending credit card details is not a good idea, but gossips are totally fine."},{question:"Q: How can I suggest improvements?",answer:"A: Just start a chat with one of the Creators and show us your ideas."},{question:"Q: Lorem Ipsum?",answer:"A: Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."}],L=[{version:"v0.3",changes:["Security updates","Notification settings","More efficient live communication","Email verification","Login with Google","Bugfixes and other minor improvements","Semi-advanced security for messages","Added cookies support"]},{version:"v0.2.1",changes:["Bugfixes and UI improvements"]},{version:"v0.2",changes:["Chats are sorted based on last message","Automatic reconnection in case of disconnect","Online/Offline status of users with notifications","Account settings with live update","Emoji for desktop users","Bugfixes and other minor improvements"]},{version:"v0.1",changes:["Registration/Login","Live messages","Message history is saved and is reloaded on login","Can add others to contact list","Audio settings"]}],U=a(63),M=a.n(U);function T(e){return F.apply(this,arguments)}function F(){return(F=Object(i.a)(l.a.mark((function e(t){var a,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=M.a.sign({userId:t},k),e.next=4,fetch("".concat(O,"/api/getallchats"),{method:"post",headers:{"Content-type":"application/json"},body:JSON.stringify({token:a})});case 4:return n=e.sent,e.next=7,n.json();case 7:return n=e.sent,e.abrupt("return",n);case 11:throw e.prev=11,e.t0=e.catch(0),e.t0;case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}function B(e,t,a){return P.apply(this,arguments)}function P(){return(P=Object(i.a)(l.a.mark((function e(t,a,n){var r,c,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],e.prev=1,c=M.a.sign({chatId:t,totalMessages:n},k),e.next=5,fetch("".concat(O,"/api/getlastmessages"),{method:"post",headers:{"Content-type":"application/json"},body:JSON.stringify({token:c})});case 5:return o=e.sent,e.next=8,o.json();case 8:return o=e.sent,e.next=11,o.forEach((function(e){var t=e.userId===a.userId?0:1;r.push(new w.Message({id:t,message:e.messageText}))}));case 11:return e.abrupt("return",r);case 14:throw e.prev=14,e.t0=e.catch(1),e.t0;case 17:case"end":return e.stop()}}),e,null,[[1,14]])})))).apply(this,arguments)}function R(e,t){return D.apply(this,arguments)}function D(){return(D=Object(i.a)(l.a.mark((function e(t,a){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(O,"/api/").concat(a),{method:"post",headers:{"Content-type":"application/json"},body:JSON.stringify(t)});case 3:return n=e.sent,r=n.status,e.next=7,n.json();case 7:return n=e.sent,Y(r,n.text),e.abrupt("return",n);case 12:throw e.prev=12,e.t0=e.catch(0),e.t0;case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}function q(){return(q=Object(i.a)(l.a.mark((function e(t,a){var n,r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log(O),n=M.a.sign({userId:t,emailToAdd:a},k),e.next=5,fetch("".concat(O,"/api/addchat"),{method:"post",headers:{"Content-type":"application/json"},body:JSON.stringify({token:n})});case 5:return r=e.sent,c=r.status,e.next=9,r.json();case 9:return r=e.sent,Y(c,r.text),e.abrupt("return",r);case 14:throw e.prev=14,e.t0=e.catch(0),e.t0;case 17:case"end":return e.stop()}}),e,null,[[0,14]])})))).apply(this,arguments)}function W(){return(W=Object(i.a)(l.a.mark((function e(t,a,n,r,c){var o,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o=M.a.sign({userId:t,sound:a,newchat:n,newmessage:r,connection:c},k),e.next=4,fetch("".concat(O,"/api/settingsapply"),{method:"post",headers:{"Content-type":"application/json"},body:JSON.stringify({token:o})});case 4:return s=e.sent,Y(s.status,s.text),e.abrupt("return","ok");case 10:throw e.prev=10,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function _(e){return H.apply(this,arguments)}function H(){return(H=Object(i.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=M.a.sign({userId:t},k),e.next=3,fetch("".concat(O,"/api/disconnect"),{method:"post",headers:{"Content-type":"application/json"},body:JSON.stringify({token:a})});case 3:404===e.sent.status&&console.log("Couldnt find a user");case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(e,t){switch(e){case 400:throw new Error(t);case 500:case 404:throw new Error("Server error,try again later")}}function K(e,t){var a=[];return e.forEach((function(e){var n,r;e.lastMessage?(n=e.lastMessage.userId===t?0:1,r={id:e.chatId,image:e.friendImageUrl,isOnline:e.isOnline,lastMessagesAreFetched:!1,name:e.friendUserName,msg:[new w.Message({id:n,message:e.lastMessage.messageText})]}):r={id:e.chatId,image:e.friendImageUrl,isOnline:e.isOnline,lastMessagesAreFetched:!1,name:e.friendUserName,msg:[]},a.push(r)})),a}var Q=function(e,t){var a=0,n=!0,r=!1,c=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){if(o.value.id===e)return a;a++}}catch(l){r=!0,c=l}finally{try{n||null==s.return||s.return()}finally{if(r)throw c}}return-1},G=function(){var e=Object(i.a)(l.a.mark((function e(t,a,n){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,B(t,a,n.msg.length);case 3:return r=e.sent,n.msg.forEach((function(e){r.push(e)})),n.lastMessagesAreFetched=!0,n.msg=[],n.msg=Object(m.a)(r),e.abrupt("return",n);case 11:throw e.prev=11,e.t0=e.catch(0),e.t0;case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,a,n){return e.apply(this,arguments)}}(),J=function(e,t){var a={},n={found:!1};e.forEach((function(e){var t=e.id;a[t]=1}));var r=!0,c=!1,o=void 0;try{for(var s,l=t[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var i=s.value;if(i in a){n.found=!0,n.id=i;break}}}catch(u){c=!0,o=u}finally{try{r||null==l.return||l.return()}finally{if(c)throw o}}return n},z=a(236),V=a.n(z),Z=a(44),$=a(260),X=a(97);var ee=function(e){var t=e.show,a=e.handleClose,c=e.updateAudio,o=e.chooseSong,s=Object(n.useState)(0),l=Object(u.a)(s,2),i=l[0],m=l[1],d=Object(n.useState)(""),f=Object(u.a)(d,2),p=f[0],g=f[1],v=function(e){return e?"primary":"secondary"};return r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{show:t,onHide:a,centered:!0},r.a.createElement(h.a.Body,null,r.a.createElement("h3",null,"Audio settings"),r.a.createElement("h5",null,"Current song"),r.a.createElement(Z.a,null,r.a.createElement(Z.a.Toggle,{variant:"success",id:"dropdown-basic"},p?r.a.createElement(r.a.Fragment,null,p):r.a.createElement(r.a.Fragment,null,"Choose song ")),r.a.createElement(Z.a.Menu,null,S.map((function(e){return r.a.createElement(Z.a.Item,{key:e,onClick:function(){return function(e){m(0),o(e),g(e)}(e)}},e)})))),r.a.createElement("h4",null," Playback "),r.a.createElement($.a,{type:"radio",name:"options",value:i,onChange:function(e){m(e),e&&p?c(!0):e||c(!1)}},r.a.createElement(X.a,{variant:v(Boolean(i)),value:1},"On"),r.a.createElement(X.a,{variant:v(!Boolean(i)),value:0},"Off")))))},te=a(56),ae=a(237);var ne=function(e){var t=e.show,a=e.handleClose,c=e.createNewChat,o=Object(n.useState)(""),s=Object(u.a)(o,2),l=s[0],i=s[1],m=Object(n.useState)(""),d=Object(u.a)(m,2),f=d[0],g=d[1],v=Object(n.useContext)(mt).user,E=v?v.userId:0;return r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{show:t,onHide:a,centered:!0},r.a.createElement(h.a.Body,null,r.a.createElement("h3",null,"Add contact "),r.a.createElement(te.a,{onSubmit:function(e){e.preventDefault(),function(e,t){return q.apply(this,arguments)}(E,l).then((function(e){if(e){var t=e.chatId,n=e.userName,r=e.friendImageUrl;c(t,n,r),a()}})).catch((function(e){e.toString().includes("Failed to fetch")?g("No response from the server"):g(e.message)}))}},r.a.createElement(te.a.Group,{controlId:"formBasicEmail"},r.a.createElement(te.a.Label,null,"Email address"),r.a.createElement(te.a.Control,{type:"email",placeholder:"Enter email",onChange:function(e){return i(e.target.value)}}),r.a.createElement(te.a.Text,{className:"text-muted"},"Add bohdan@rocket.chat / artem@rocket.chat to provide feedback or just to chat.")),f?r.a.createElement(ae.a,null,r.a.createElement("div",{className:"dark-red"},f)):r.a.createElement(r.a.Fragment,null),r.a.createElement(p.a,{variant:"primary",type:"submit",disabled:!(l.length>0)},"Add friend")))))},re=a(136),ce=a(55),oe=a(241),se=a(61),le=a(82),ie=a(239),ue=a.n(ie);var me=function(e){var t=e.type,a=e.UpdateUserData,c=Object(n.useState)(""),o=Object(u.a)(c,2),s=o[0],l=o[1],i=Object(n.useState)({show:!1,type:""}),m=Object(u.a)(i,2),d=m[0],f=m[1];function h(){return s.length>2}return r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:function(e){e.preventDefault();var n={type:t,value:s};"image"!==t||ue()(s)?(a(n.type,n.value),f({show:!0,type:"success"})):f({show:!0,type:"danger"}),l("")}},r.a.createElement(te.a.Row,null,r.a.createElement(se.a,null,r.a.createElement(te.a.Control,{placeholder:"new "+t,value:s,onChange:function(e){return l(e.target.value)}})),r.a.createElement(se.a,null,r.a.createElement(p.a,{type:"submit",variant:h()?"primary":"secondary",disabled:!h()}," Update!")),d.show?r.a.createElement(le.a,{variant:d.type,onClose:function(){return f({show:!1,type:""})},dismissible:!0,className:"ma2"},"danger"===d.type?"Your ".concat(t," change failed with many errors!"):"Your "+t+" was changed successfully!"):r.a.createElement("div",null))))},de=a(240),fe=a.n(de);var he=function(e){var t=e.name,a=e.activeSwitches,c=e.handleChange,o=Object(n.useState)(""),s=Object(u.a)(o,2),l=s[0],i=s[1];Object(n.useEffect)((function(){var e=t.match(/([A-Z]?[^A-Z]*)/g).slice(0,-1),a="";if(e){var n=!0,r=!1,c=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=o.value;a+=" "+(l=m(l))}}catch(u){r=!0,c=u}finally{try{n||null==s.return||s.return()}finally{if(r)throw c}}}else a=t=m(t);i(a)}));var m=function(e){var t=e.charAt(0);return t===t.toLowerCase()&&t!==t.toUpperCase()?t.toUpperCase()+e.substring(1):e};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"col-8",style:{marginRight:"5px"}},l),r.a.createElement("div",{className:"col-2"},r.a.createElement("label",null,r.a.createElement(fe.a,{onChange:function(){return c(t)},checked:Boolean(a[t]),onColor:"#86d3ff",onHandleColor:"#2693e6",handleDiameter:30,uncheckedIcon:!1,checkedIcon:!1,boxShadow:"0px 1px 5px rgba(0, 0, 0, 0.6)",activeBoxShadow:"0px 0px 1px 10px rgba(0, 0, 0, 0.2)",height:20,width:48}))))};var pe=function(e){var t=e.UpdateUserData,a=(e.handleClose,Object(n.useContext)(mt).user),c=Object(n.useState)(a.notificationSettings),o=Object(u.a)(c,2),s=o[0],l=o[1],i=Object(n.useState)({show:!1,type:""}),m=Object(u.a)(i,2),f=m[0],h=m[1];function g(e){var t=Object(d.a)({},s);t[e]=!t[e],l(t)}return r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t("notifications",s);var n=s.sound,r=s.newChatReceived,c=s.newMessageReceived,o=s.connectionChanged;(function(e,t,a,n,r){return W.apply(this,arguments)})(a.userId,n,r,c,o).then((function(){return h({show:!0,type:"success"})})).catch((function(e){h({show:!0,type:"danger"}),console.log(e)}))}},r.a.createElement("label",null,r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row h-auto",style:{alignContent:"start"}},Object.keys(s).map((function(e,t){return 0===t?r.a.createElement("div",{key:e}):r.a.createElement(he,{handleChange:g,activeSwitches:s,name:e,key:e})}))))),r.a.createElement("br",null),f.show?r.a.createElement(le.a,{variant:f.type,onClose:function(){return h({show:!1,type:""})},dismissible:!0,className:"ma2"},"danger"===f.type?"Failed to save notification settings!":"Notification settings changed successfully!"):r.a.createElement("div",null),r.a.createElement("br",null)," ",r.a.createElement(p.a,{type:"submit"}," Save ")))};var ge=function(e){var t=e.show,a=e.handleClose,c=e.UpdateUserData,o=Object(n.useContext)(mt).user;return r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{show:t,onHide:a,centered:!0},r.a.createElement(h.a.Body,null,r.a.createElement("h3",null,"My Account"),r.a.createElement(oe.a,{defaultActiveKey:"Picture",id:"uncontrolled-tab-example"},r.a.createElement(ce.a,{eventKey:"Picture",title:"Picture"},o.imageUrl?r.a.createElement(re.a,null,r.a.createElement(re.a.Image,{roundedCircle:!0,width:100,height:120,alt:"profile picc",src:o.imageUrl}),r.a.createElement(re.a.Caption,null,"Your profile picture."),r.a.createElement("div",null,r.a.createElement(me,{UpdateUserData:c,type:"image"}))):r.a.createElement("span",{className:"ma2"}," You have no pic",r.a.createElement("div",null,r.a.createElement(me,{UpdateUserData:c,type:"image"})))),r.a.createElement(ce.a,{eventKey:"Name",title:"Name"},r.a.createElement("div",{className:"ma2 "},r.a.createElement("h6",null,"Your current name is ",r.a.createElement("strong",null,o.userName)),r.a.createElement(me,{UpdateUserData:c,type:"name"}))),r.a.createElement(ce.a,{eventKey:"Notifications",title:"Notifications"},r.a.createElement("div",{className:"ma2 "},r.a.createElement(pe,{UpdateUserData:c})))),r.a.createElement(p.a,{style:{float:"right"},onClick:function(){return a()}},"Close"))))};var ve=function(e){var t=e.updateAudio,a=e.logout,c=e.chooseSong,o=e.createNewChat,s=e.UpdateUserData,l=Object(n.useState)({type:"",seen:!1}),i=Object(u.a)(l,2),m=i[0],d=i[1],f=function(){return d({type:"",seen:!1})};return r.a.createElement(r.a.Fragment,null,r.a.createElement(Z.a,null,r.a.createElement(Z.a.Toggle,{variant:"secondary",size:"sm",id:"dropdown-basic"},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},r.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),r.a.createElement("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}))),r.a.createElement(Z.a.Menu,null,C.map((function(e,t){return"Logout"===e?r.a.createElement(Z.a.Item,{key:e,onClick:a},C[t]):r.a.createElement(Z.a.Item,{key:e,onClick:function(){return e=C[t],d({type:e,seen:!0});var e}},C[t]," ")})))),{"Add Contact":r.a.createElement(ne,{show:m.seen,handleClose:f,createNewChat:o}),Audio:r.a.createElement(ee,{show:m.seen,handleClose:f,updateAudio:t,chooseSong:c}),"My Account":r.a.createElement(ge,{show:m.seen,handleClose:f,UpdateUserData:s}),Logout:r.a.createElement(r.a.Fragment,null)}[m.type])},Ee=(a(391),a(19));a(393);var be=function(e){var t=e.clickOnChat,a=e.setChatIndex,c=Object(n.useContext)(mt).chats,o=Object(n.useContext)(_e),s=o.chatIndex,l=o.isMobile,i={margin:"2px",backgroundColor:"#383838",color:"white"},u={margin:"0px ",marginBottom:"5px ",marginTop:"5px ",backgroundColor:"black",color:"white"};return r.a.createElement(Ee.m,null,r.a.createElement(Ee.c,{className:"scrollable"},c.map((function(e,n){return r.a.createElement("div",{onClick:function(){return function(e,n){t(e,n,!0),a(n)}(e.id,n)},key:e.id},r.a.createElement(Ee.d,{style:n!==s||l?i:u},e.image?r.a.createElement(Ee.b,{imgUrl:e.image}):r.a.createElement(Ee.b,{letter:e.name.charAt(0),style:{color:"black !important"}}),r.a.createElement(Ee.e,null,r.a.createElement(Ee.h,{justify:!0},r.a.createElement(Ee.n,{ellipsis:!0},e.name),r.a.createElement(Ee.j,null,e.isOnline?r.a.createElement("status-indicator",{active:!0}):r.a.createElement("div",null))),r.a.createElement(Ee.j,{ellipsis:!0},e.msg.length>0?e.msg[e.msg.length-1].message:"Say something"))))}))))};function ye(e){var t=e.createNewChat,a=e.LoadTenMessages,c=e.updAudio,o=e.setSong,s=e.logout,l=e.setChatIndex,i=e.UpdateUserData,u=Object(n.useContext)(_e).isMobile;return r.a.createElement("div",{className:u?"left-side col-12":"left-side col-4 col-sm-4 col-md-4 col-lg-2 col-xl-2"},r.a.createElement(ve,{createNewChat:t,updateAudio:c,chooseSong:o,logout:function(){return s()},UpdateUserData:i}),r.a.createElement(be,{clickOnChat:a,setChatIndex:l}))}var we=a(259),Oe=a(258),ke=a(249),je=a.n(ke);var xe=function(e){var t=e.onSendClick,a=Object(n.useContext)(_e).isMobile,c=r.a.createElement(Oe.a,{id:"popover-basic"},r.a.createElement(je.a,{onEmojiClick:function(e,t){document.querySelector(".lc-1pj3shq").value+=t.emoji}}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ee.m,null,r.a.createElement(Ee.k,{onSend:function(){var e;e=document.querySelector(".lc-1pj3shq").value,t(e)},onChange:function(e){"change"===e.type&&(document.querySelector(".lc-1pj3shq").value+=e.type.value)}},r.a.createElement(Ee.h,{align:"center"},r.a.createElement(Ee.g,{fit:!0},r.a.createElement("label",{htmlFor:"file-upload",className:"custom-file-upload"},r.a.createElement("input",{type:"file",style:{display:"none"}})),r.a.createElement(Ee.a,null)),r.a.createElement(Ee.l,{fill:"true"}),r.a.createElement(Ee.i,{fit:!0})),a?r.a.createElement("div",{style:{height:"45px"}}):r.a.createElement(Ee.h,{verticalAlign:"center",justify:"left"},r.a.createElement(we.a,{trigger:"click",placement:"top",overlay:c},r.a.createElement(Ee.g,{fit:!0},r.a.createElement(Ee.f,{onClick:function(){}})))))))};a(394);var Ce=function(e){var t=e.chatData,a=e.onSend,c=e.loadTen,o=e.GoBack,s=Object(n.useContext)(_e),l=s.chatId,i=s.chatIndex,u=s.isMobile,m=function(e){c(l,i,!1)};return r.a.createElement("div",{id:"chat-side"},u?r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row header"},r.a.createElement(p.a,{type:"button",variant:"secondary",className:"col-2 arrow-back ",onClick:function(){return o("left")}},r.a.createElement("span",{className:"btn-label"},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},r.a.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"}),r.a.createElement("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"}))),"Back"),r.a.createElement("div",{className:"white tc col-10",style:{backgroundColor:"#6c757d"}},r.a.createElement("strong",{className:"black"},t.name)," is",r.a.createElement("span",{className:t.isOnline?"dark-blue":"white"}," ",t.isOnline?" online":" offline"),r.a.createElement("h5",{className:"hover-bg-white-40 pointer",onClick:m},"Load more messages")))):r.a.createElement("h4",{className:"white tc hover-bg-white-40 pointer col-10",onClick:m},"Load more"),r.a.createElement(w.ChatFeed,{ClassName:"feed",showSenderName:!0,messages:t.msg}),r.a.createElement("footer",{className:"footer"},r.a.createElement(xe,{onSendClick:a})))};function Se(e){var t=e.LoadTenMessages,a=e.SendMessage,c=e.GoBack,o=Object(n.useContext)(mt).chats,s=Object(n.useContext)(_e),l=s.chatIndex,i=s.isMobile;return r.a.createElement("div",{className:i?"right-side col-12":"right-side col-8 col-sm-8 col-md-8 col-lg-10 col-xl-10 "},r.a.createElement("div",{className:"overflow-hidden"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},-1===l?r.a.createElement("div",{className:"tc center col align-self-center",id:"idle-msg"},"Click on a chat to start messaging!"):r.a.createElement("div",{className:"col"},r.a.createElement(Ce,{loadTen:t,chatData:o[l],onSend:a,GoBack:c}))))))}var Ne=a(257),Ie=a(100),Ae=a.n(Ie),Le=a(57),Ue=a.n(Le);function Me(e){var t=e.name,a=e.sound;return r.a.createElement("div",null,r.a.createElement("strong",null,"New chat!"),r.a.createElement("div",null,r.a.createElement("strong",null,t)," created a chat with you!"),a?r.a.createElement(Ue.a,{url:Ae.a,autoLoad:!0,playStatus:Ue.a.status.PLAYING}):r.a.createElement("div",null))}function Te(e){var t=e.name,a=e.body,n=e.sound;return r.a.createElement("div",null,r.a.createElement("strong",null,t),r.a.createElement("div",null,a),n?r.a.createElement(Ue.a,{url:Ae.a,autoLoad:!0,playStatus:Ue.a.status.PLAYING}):r.a.createElement("div",null))}function Fe(e){var t=e.online,a=e.sound;return r.a.createElement("div",null,r.a.createElement("strong",null,"Connection status changed!"),r.a.createElement("div",null,t?"You are online now":"You went offline, your messages will not be sent!"),t?r.a.createElement("div",null):r.a.createElement("div",null,"We will try to reconnect you!"),a?r.a.createElement(Ue.a,{url:Ae.a,autoLoad:!0,playStatus:Ue.a.status.PLAYING}):r.a.createElement("div",null))}function Be(e){var t=e.isLast,a=e.nextTime,c=e.sound,o=Object(n.useState)(a),s=Object(u.a)(o,2),l=s[0],i=s[1];return Object(n.useEffect)((function(){var e=setInterval((function(){return i(l-1)}),1e3);return function(){clearInterval(e)}}),[l]),r.a.createElement("div",null,r.a.createElement("strong",null,"Reconnection failed!"),r.a.createElement("div",null,t?"Failed to reconnect, please reload the page or try again later.":"We will try again in ".concat(l," seconds.")),c?r.a.createElement(Ue.a,{url:Ae.a,autoLoad:!0,playStatus:Ue.a.status.PLAYING}):r.a.createElement("div",null))}var Pe=a(224);function Re(){return(Re=Object(i.a)(l.a.mark((function e(t,a,n,c,o,s){var i,u,d,f,h,p;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=(new Ne.a).withUrl("".concat(O,"/chat")).build(),t((function(e){return u=e,e})),u){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,e.next=7,i.start();case 7:d=i.connection.transport.webSocket.url,"",f=0;case 10:if(!(f<d.length)){e.next=17;break}if("="!==d.charAt(f)){e.next=14;break}return d.slice(f+1),e.abrupt("break",17);case 14:f++,e.next=10;break;case 17:return e.next=19,i.invoke("UserWentOfflineOrOnline",!0,u.userId);case 19:h=u.notificationSettings,p=h.sound,h.connectionChanged&&c(r.a.createElement(Fe,{online:!0,sound:p}),"success",3e3),i.onclose((function(){var e;if(_(u.userId),t((function(t){return e=t,t})),e){var s=e.notificationSettings,l=s.sound;s.connectionChanged&&c(r.a.createElement(Fe,{sound:l,online:!1}),"warning",3e3),De(0,i,n,c).then((function(){o(-1),a((function(e){var t=Object(m.a)(e);return t.forEach((function(e){e.msg=[],e.lastMessagesAreFetched=!1})),t}))})).catch((function(e){return console.log(e)}))}})),i.on("sendDirectMessage",(function(e,n,l){var i,u=Pe.AES.decrypt(l,Pe.enc.Base64.parse(j),{iv:Pe.enc.Base64.parse(x)});l=Pe.enc.Utf8.stringify(u),t((function(e){return i=e,e}));var m=i.notificationSettings,d=m.sound,f=m.newMessageReceived;a((function(t){var a=Q(n,t);if(-1!==a&&i.userId!==e){var u=Object.assign([],t);u[a].msg.push(new w.Message({id:1,message:l})),u[a].isOnline=!0,f&&c(r.a.createElement(Te,{sound:d,name:u[a].name,body:l}),"info",5e3);var m,h=u[a];return u.splice(a,1),u.unshift(h),s((function(e){return m=e,e})),o((function(){return Q(m,u)})),u}return t}))})),i.on("UserWentOfflineOrOnline",(function(e,t,n){a((function(a){var r=Object.assign([],a);if(t!==u.userId){var c=J(a,n);if(c.found)r[Q(c.id,a)].isOnline=e}return r}))})),i.on("UserDataChanged",(function(e,t,n,r){u.userId!==e&&a((function(e){var a=Object(m.a)(e),c=J(e,t);c.found&&(a[Q(c.id,e)][n]=r);return a}))})),i.on("getChat",(function(e,n){var o;if(t((function(e){return o=e,e})),u.userId===e){a((function(e){var t=Object.assign([],e);return t.push({id:n.chatId,image:n.image,isOnline:!0,name:n.chatName,msg:[]}),Object.assign([],t)}));var s=o.notificationSettings,l=s.sound;s.newChatReceived&&c(r.a.createElement(Me,{name:n.chatName,sound:l}),"info",5e3)}})),e.next=33;break;case 28:e.prev=28,e.t0=e.catch(4),console.log(e.t0),c(r.a.createElement(Fe,{online:!1}),"warning",3e3),De(0,i,n,c,u.notificationSettings);case 33:return e.abrupt("return",i);case 34:case"end":return e.stop()}}),e,null,[[4,28]])})))).apply(this,arguments)}function De(e,t,a,n,r){return qe.apply(this,arguments)}function qe(){return(qe=Object(i.a)(l.a.mark((function e(t,a,n,c,o){var s,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:3e3,s=o.sound,i=o.connectionChanged,setTimeout((function(){a.start().then((function(){return n(a),i&&c(r.a.createElement(Fe,{online:!0,sound:s}),"success",4e3),new Promise((function(e,t){return e(!0)}))})).catch((function(){if(!(t<4))return c(r.a.createElement(Be,{isLast:!0}),"error",7e4),!1;i&&c(r.a.createElement(Be,{sound:s,nextTime:3e3*(t+1)/1e3,isLast:!1}),"warning",3e3*(t+1)),De(t+1,a,n,c)}))}),3e3*t);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var We=a(128),_e=r.a.createContext({chatId:null,chatIndex:null,isMobile:!1}),He=function(e){var t=e.setChats,a=e.SendMessage,c=e.logout,o=e.createNewChat,s=e.setUser,l=e.setHubConnection,i=Object(n.useContext)(mt),h=i.user,p=i.chats,v=V()(),b=Object(We.useToasts)(),w=b.addToast,O=b.removeToast,k=Object(n.useState)(-1),j=Object(u.a)(k,2),x=j[0],C=j[1],S=Object(n.useState)(-1),N=Object(u.a)(S,2),I=N[0],A=N[1],L=Object(n.useState)(null),U=Object(u.a)(L,2),M=U[0],T=U[1],F=Object(n.useState)(!1),B=Object(u.a)(F,2),P=B[0],R=B[1],D=Object(n.useState)(!1),q=Object(u.a)(D,2),W=q[0],_=q[1],H=Object(n.useState)("left"),Y=Object(u.a)(H,2),K=Y[0],Q=Y[1];Object(n.useEffect)((function(){(function(e,t,a,n,r,c){return Re.apply(this,arguments)})(s,t,l,J,A,C).then((function(e){l(e)}))}),[]);var J=function(e,t,a){w(e,{appearance:t,autoDismiss:!1},(function(e){a<6e4&&setTimeout((function(){return O(e)}),a)}))},z=function(e,t){var a;l((function(e){return a=e,e})),s((function(a){var n=Object(d.a)({},a);switch(e){case"image":n.imageUrl=t;break;case"name":n.userName=t;break;case"notifications":n.notificationSettings=t}return n})),"notifications"!==e&&a.invoke("UserDataChanged",h.userId,e,t)},Z=function(e,a,n){n&&C(e);var r=Object(m.a)(p),c=r[a];if(!c.lastMessagesAreFetched&&c.msg.length>10&&(c.lastMessagesAreFetched=!0),!c.lastMessagesAreFetched||!n&&c.msg.length>10){var o=c.msg.length;G(e,h,c).then((function(e){o!==e.msg.length&&(t(r),document.getElementsByClassName("chat-history")[0].scrollTop=0)})).catch((function(e){console.log(e),alert("error loading messages")}))}},$=function(e){var t=document.getElementsByTagName("audio")[0];e?t.play():t.pause()},X=function(e){a(x,I)(e),A(0)};return Object(n.useEffect)((function(){h||R(!0)}),[v,h]),r.a.createElement(r.a.Fragment,null,r.a.createElement(_e.Provider,{value:{chatId:x,chatIndex:I,isMobile:W}},v.isMobile()?r.a.createElement(g,{setIsMobile:_}):r.a.createElement("div",null),P?r.a.createElement(f.a,{to:"/"}):r.a.createElement("div",{className:"row"},r.a.createElement("audio",{src:function(e){switch(e){case"witcher":return E.a;case"drStone":return y.a;default:return}}(M),preload:"true",loop:!0}),W?"left"===K?r.a.createElement(ye,{LoadTenMessages:Z,createNewChat:o,logout:c,setChatIndex:function(e){A(e),Q("right")},setSong:T,updAudio:$,UpdateUserData:z}):r.a.createElement(Se,{LoadTenMessages:Z,SendMessage:X,GoBack:Q}):r.a.createElement(r.a.Fragment,null,r.a.createElement(ye,{LoadTenMessages:Z,createNewChat:o,logout:c,setChatIndex:A,setSong:T,updAudio:$,UpdateUserData:z}),r.a.createElement(Se,{LoadTenMessages:Z,SendMessage:X})))))},Ye=a(80),Ke=a(101),Qe=a(29),Ge=a(238),Je=(a(164),a(54)),ze=a(39),Ve=a(130);a(425);function Ze(e){var t=e.loginOrRegister,a=Object(n.useState)(""),c=Object(u.a)(a,2),o=c[0],s=c[1],m=Object(n.useState)(""),d=Object(u.a)(m,2),h=d[0],g=d[1],v=Object(n.useState)(""),E=Object(u.a)(v,2),b=E[0],y=E[1],w=Object(n.useState)(!1),O=Object(u.a)(w,2),k=O[0],j=O[1],x=Object(n.useState)(!1),C=Object(u.a)(x,2),S=C[0],N=C[1];function I(){return o.length>0&&b.length>0}function A(){return(A=Object(i.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,L("login");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(e,t){return U.apply(this,arguments)}function U(){return(U=Object(i.a)(l.a.mark((function e(a,n){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),setTimeout((function(){return console.log()}),1e3),e.prev=2,r="login"===a?{email:o,password:b}:{token:n},e.next=6,t(r,a);case 6:if("duplicate"!==e.sent){e.next=9;break}throw new Error("Please finish another session before starting a new one.");case 9:N(!0),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),setTimeout((function(){j(!1),e.t0.toString().includes("Failed to fetch")?g("No response from the server"):g(e.t0.message)}),1e3);case 15:case"end":return e.stop()}}),e,null,[[2,12]])})))).apply(this,arguments)}return r.a.createElement(r.a.Fragment,null,S?r.a.createElement(f.a,{to:"/app"}):r.a.createElement(ze.a,{className:"Login"},r.a.createElement(ze.a.Header,null," Sign In "),r.a.createElement(ze.a.Body,null,r.a.createElement("form",{onSubmit:function(e){return A.apply(this,arguments)}},r.a.createElement(ae.a,{controlId:"email"},r.a.createElement(Je.a,null,"Email"),r.a.createElement(Ge.a,{autoFocus:!0,type:"email",value:o,onChange:function(e){return s(e.target.value)}})),r.a.createElement(ae.a,{controlId:"password"},r.a.createElement(Je.a,null,"Password"),r.a.createElement(Ge.a,{value:b,onChange:function(e){return y(e.target.value)},type:"password"})),h?r.a.createElement(ae.a,null,r.a.createElement("div",{className:"tc dark-red"},h)):r.a.createElement(r.a.Fragment,null),r.a.createElement(ae.a,{className:"tc"},r.a.createElement("a",{className:"tc",href:"/rocket-chat-front/#/register"},"Not signed up yet?"),r.a.createElement("div",{style:{marginTop:"15px"}})),r.a.createElement(p.a,{block:!0,variant:I()?"primary":"secondary",disabled:!I()||k,type:"submit"},k?r.a.createElement(Ve.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}):"Login")))))}var $e=a(131),Xe=a.n($e);function et(e){var t=e.loginOrRegister,a=Object(n.useState)(""),c=Object(u.a)(a,2),o=c[0],s=c[1],m=Object(n.useState)(""),d=Object(u.a)(m,2),h=d[0],g=d[1],v=Object(n.useState)(""),E=Object(u.a)(v,2),b=E[0],y=E[1],w=Object(n.useState)(!1),O=Object(u.a)(w,2),k=O[0],j=O[1],x=Object(n.useState)(""),C=Object(u.a)(x,2),S=C[0],I=C[1],A=Object(n.useState)(!1),L=Object(u.a)(A,2),U=L[0],M=L[1],T=Object(n.useState)(0),F=Object(u.a)(T,2),B=F[0],P=F[1];function R(){return o.length>0&&B>2&&h.length}function D(){return(D=Object(i.a)(l.a.mark((function e(a){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),j(!0),setTimeout((function(){return console.log()}),1e3),e.prev=3,e.next=6,t({username:h,email:o,password:b},"register");case 6:return j(!1),e.next=9,Xe()("Almost there","We saved all your data, confirm your email to start using our app!","success");case 9:M(!0),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),setTimeout((function(){j(!1),e.t0.toString().includes("Failed to fetch")?I("No response from the server"):I(e.t0.message)}),500);case 15:case"end":return e.stop()}}),e,null,[[3,12]])})))).apply(this,arguments)}return r.a.createElement(r.a.Fragment,null,U?r.a.createElement(f.a,{to:"/login"}):r.a.createElement(ze.a,{className:"Login"},r.a.createElement(ze.a.Header,null," Register "),r.a.createElement(ze.a.Body,null,r.a.createElement("form",{onSubmit:function(e){return D.apply(this,arguments)}},r.a.createElement(ae.a,{controlId:"name"},r.a.createElement(Je.a,null,"Name"),r.a.createElement(Ge.a,{autoFocus:!0,type:"text",value:h,onChange:function(e){return g(e.target.value)}})),r.a.createElement(ae.a,{controlId:"email"},r.a.createElement(Je.a,null,"Email"),r.a.createElement(Ge.a,{autoFocus:!0,type:"email",value:o,onChange:function(e){return s(e.target.value)}})),r.a.createElement(ae.a,{controlId:"password"},r.a.createElement(Je.a,null,"Password"),r.a.createElement(Ge.a,{style:{borderBottom:"3px solid ".concat(N[B].color)},value:b,onChange:function(e){var t=0,a=e.target.value;a.length>5&&t++,a.length>7&&t++,a.match(/\d+/g)&&t++,a.toLowerCase()!==a&&t++,P(t),y(a)},type:"password"})),S?r.a.createElement(ae.a,null,r.a.createElement("div",{className:"tc dark-red"},S)):r.a.createElement(r.a.Fragment,null),r.a.createElement(p.a,{block:!0,variant:R()?"primary":"secondary",disabled:!R()||k,type:"submit"},k?r.a.createElement(Ve.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}):"Register")))))}a(426);var tt=a(254),at=a.n(tt),nt=a(255);function rt(e){var t=e.isFAQ;return r.a.createElement("div",null,r.a.createElement(ce.a.Container,{id:"left-tabs-example",defaultActiveKey:t?A[0].question:L[0].version},r.a.createElement(nt.a,{className:"bg-black-90 align-content-start"},r.a.createElement(se.a,{md:4,lg:4,xl:4,sm:12,xs:12},r.a.createElement(Qe.a,{variant:"pills",className:"flex-column b--solid b--light-blue"},t?A.map((function(e){return r.a.createElement(Qe.a.Item,{key:e.question},r.a.createElement(Qe.a.Link,{eventKey:e.question},e.question))})):L.map((function(e){return r.a.createElement(Qe.a.Item,{key:e.version},r.a.createElement(Qe.a.Link,{eventKey:e.version},e.version))})))),r.a.createElement(se.a,{sm:12,xs:12,md:8,xl:8,lg:8},r.a.createElement(ce.a.Content,{className:"white ma3"},t?A.map((function(e){return r.a.createElement(ce.a.Pane,{eventKey:e.question,key:e.answer},e.answer)})):L.map((function(e){return r.a.createElement(ce.a.Pane,{key:e.changes[0],eventKey:e.version},r.a.createElement("ul",null,e.changes.map((function(e){return r.a.createElement("li",{key:e},e)}))))})))))))}function ct(e){var t=e.success,a=Object(n.useState)({done:!1,time:4}),c=Object(u.a)(a,2),o=c[0],s=c[1];return Object(n.useEffect)((function(){var e=setInterval((function(){var e=Object(d.a)({},o);o.time<2&&(e.done=!0),e.time-=1,s(e)}),1e3);return function(){clearInterval(e)}}),[o]),r.a.createElement(r.a.Fragment,null,o.done?r.a.createElement(f.a,{to:"/login"}):r.a.createElement(ze.a,{className:"Login"},r.a.createElement(ze.a.Header,null,"Email verification"),r.a.createElement(ze.a.Body,null,t?r.a.createElement("div",null,"Your email was verified ",r.a.createElement("span",{className:"green"},"successfully")," :)",r.a.createElement("br",null)," Redirecting you in ",o.time):r.a.createElement("div",null,"Email verification ",r.a.createElement("span",{className:"red"},"failed")," :( ",r.a.createElement("br",null)," Redirecting you in ",o.time," "))))}var ot=function(e){var t=e.loginOrRegister,a=e.path,c=Object(n.useContext)(mt).isLoading;return r.a.createElement(r.a.Fragment,null,r.a.createElement(at.a,{active:c,spinner:!0,text:"Loading your data"},r.a.createElement("div",{className:"welcome-page overflow-y-auto overflow-x-hidden"},r.a.createElement(Ke.a,{bg:"dark",variant:"dark",expand:"lg"},r.a.createElement(Ke.a.Brand,{href:"/rocket-chat-front/#/login"},"Rocket-Chat v0.3 BETA"),r.a.createElement(Ke.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(Ke.a.Collapse,{id:"basic-navbar-nav"},r.a.createElement(Qe.a,{className:"mr-auto "},r.a.createElement(Qe.a.Link,{href:"/rocket-chat-front/#/faq"},"FAQ"),r.a.createElement(Qe.a.Link,{href:"/rocket-chat-front/#/release"},"Release notes")),r.a.createElement(Qe.a,null,r.a.createElement(Qe.a.Link,{href:"/rocket-chat-front/#/login"},"Sign in"),r.a.createElement(Qe.a.Link,{href:"/rocket-chat-front/#/register"},"Register")))),r.a.createElement(le.a,{variant:"warning",className:"tc ma0"},r.a.createElement("strong",null,"99.9% sure your account won't be deleted again!!",r.a.createElement("br",null),"Make sure to check out our ",r.a.createElement("a",{href:"/rocket-chat-front/#/release"},"release notes"),"!")),{"/login":r.a.createElement(Ze,{loginOrRegister:t}),"/register":r.a.createElement(et,{loginOrRegister:t}),"/faq":r.a.createElement(rt,{isFAQ:!0}),"/release":r.a.createElement(rt,{isFAQ:!1}),"/vsuccess":r.a.createElement(ct,{success:!0}),"/vfailed":r.a.createElement(ct,{success:!1})}[a],"/login"===a||"/register"===a?r.a.createElement("img",{src:"https://dramarocket.com/wp-content/uploads/2018/01/icon-redrocket-2.png",alt:"logo",className:"center"}):r.a.createElement("div",null))))},st=a(256),lt=function(e){try{return M.a.verify(e,k)}catch(t){throw t}},it=a(440),ut=a(224),mt=r.a.createContext({user:{},chats:[],isLoading:!1});var dt=function(){var e=Object(n.useState)(null),t=Object(u.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)([]),s=Object(u.a)(o,2),m=s[0],d=s[1],h=Object(n.useState)(null),p=Object(u.a)(h,2),g=p[0],v=p[1],E=Object(it.a)(["userToken"]),b=Object(u.a)(E,3),y=b[0],O=b[1],k=b[2],C=Object(n.useState)(!1),S=Object(u.a)(C,2),N=S[0],A=S[1],L=Object(n.useState)(!1),U=Object(u.a)(L,2),M=U[0],F=U[1];function B(e){return P.apply(this,arguments)}function P(){return(P=Object(i.a)(l.a.mark((function e(t){var a,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,T(t);case 3:return a=e.sent,n=K(a,t),d(n),e.abrupt("return","ok");case 9:e.prev=9,e.t0=e.catch(0),alert("error loading chats");case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function D(e){return q.apply(this,arguments)}function q(){return(q=Object(i.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(a=lt(t)).notificationSettings=JSON.parse(a.notificationSettings),a.isOnline="true"===a.isOnline,a.userId=parseInt(a.userId),a.isOnline,c(a),A(!0),e.next=10,B(a.userId);case 10:return A(!1),e.abrupt("return",a);case 14:throw e.prev=14,e.t0=e.catch(0),e.t0;case 17:case"end":return e.stop()}}),e,null,[[0,14]])})))).apply(this,arguments)}function W(e,t){return H.apply(this,arguments)}function H(){return(H=Object(i.a)(l.a.mark((function e(t,a){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R(t,a);case 3:if(!(n=e.sent)){e.next=10;break}if(!n.text){e.next=7;break}return e.abrupt("return",n.text);case 7:return O("userToken",n.userToken,{maxAge:86400}),e.next=10,D(n.userToken);case 10:return e.abrupt("return","ok");case 13:throw e.prev=13,e.t0=e.catch(0),console.log(e.t0),e.t0;case 17:case"end":return e.stop()}}),e,null,[[0,13]])})))).apply(this,arguments)}Object(n.useEffect)((function(){D(y.userToken).then((function(e){c(e),F(!0)})).catch((function(){return console.log("No cookie :(")}))}),[]),window.addEventListener("beforeunload",(function(e){_(a.userId),Y()}));var Y=function(){g.invoke("UserWentOfflineOrOnline",!1,a.userId).then((function(){return g.stop()})).catch((function(e){return console.log(e)}))},Q=function(){try{var e=st.a.auth2.getAuthInstance();e.signOut().then(e.disconnect())}catch(t){console.log("Not a googler!")}};return r.a.createElement(We.ToastProvider,null,r.a.createElement(Ye.a,{className:"rocket"},r.a.createElement(f.d,null,r.a.createElement(f.b,{path:"/app"},r.a.createElement(mt.Provider,{value:{user:a,chats:m,isLoading:N}},r.a.createElement(He,{setHubConnection:v,setUser:c,setChats:d,SendMessage:function(e,t){var n=t,r=e;return function(e){var t=ut.AES.encrypt(e,ut.enc.Base64.parse(j),{iv:ut.enc.Base64.parse(x)}).toString();g.invoke("SendDirectMessage",a.userId,r,t).catch((function(e){return console.log(e)})),d((function(t){var a=Object.assign([],t),r=a[n];return r.msg.push(new w.Message({id:0,message:e})),a.splice(n,1),a.unshift(r),a}))}},logout:function(){c(null),Y(),v(null),Q(),k("userToken")},createNewChat:function(e,t,n){g.invoke("ChatWithUserWasCreated",a.userId,e,{chatId:e,chatName:a.userName,image:a.imageUrl}),d((function(a){var r=Object.assign([],a);return r.push({id:e,image:n,name:t,msg:[]}),r}))}}))),I.map((function(e){return r.a.createElement(f.b,{path:e,key:e},r.a.createElement(mt.Provider,{value:{user:a,chats:m,isLoading:N}},r.a.createElement(ot,{path:e})))})),r.a.createElement(f.b,{path:"/register"},r.a.createElement(mt.Provider,{value:{user:a,chats:m,isLoading:N}},r.a.createElement(ot,{path:"/register",loginOrRegister:W}))),r.a.createElement(f.b,null,r.a.createElement(mt.Provider,{value:{user:a,chats:m,isLoading:N}},r.a.createElement(ot,{path:"/login",loginOrRegister:W})))),M?r.a.createElement(f.a,{to:"/app"}):r.a.createElement("div",null)))},ft=(a(437),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function ht(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(Xe()("New update!","Rocket chat ".concat(L[0].version," was downloaded, close all tabs to update!"),"success"),console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o.a.render(r.a.createElement(dt,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/rocket-chat-front",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/rocket-chat-front","/service-worker.js");ft?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):ht(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):ht(t,e)}))}}()}},[[262,1,2]]]);
//# sourceMappingURL=main.65091dc0.chunk.js.map