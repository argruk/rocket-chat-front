{"version":3,"sources":["sounds/notification.mp3","sounds/lol.mp3","sounds/dr_stone_ending.mp3","Components/Games/TicTacToe/Util/tic-tac-toe_icon.jpg","Components/ChatWindow/Message/MessageIF.js","Constants/Const.js","Helpers/ApiFetcher.js","Helpers/ProcessData.js","Components/Settings/Modals/AudioSettingsModal.js","Components/Settings/Modals/AddContactModal.js","Components/Settings/Modals/Forms/ProfileChangeForm.js","Components/Settings/Modals/Forms/ToggleSwitch.js","Components/Settings/Modals/Forms/NotificationsForm.js","Components/Settings/Modals/MyAccountModal.js","Components/Settings/Settings.js","Components/Friends/Friends.js","Components/MainChatAppWindow/SubWindows/ScreenWithFriends.js","Components/Games/GamesList.js","Components/Games/GamePicker/GamePicker.js","Helpers/Scroller.js","Components/InputField/Input.js","Components/Games/TicTacToe/Util/Square.js","Components/Games/TicTacToe/Util/WinnerCalc.js","Components/Games/TicTacToe/TicTacToeGame.js","Components/ChatWindow/Panel/ChatPanel.js","Components/ChatWindow/ChatWindow.js","Components/MainChatAppWindow/SubWindows/ScreenWithChats.js","Components/Notifications/Notifications.js","Helpers/HubConnection.js","Components/MainChatAppWindow/MainChatAppWindow.js","Components/Welcome/Submodules/Login.js","Components/Welcome/Submodules/Register.js","Components/Welcome/Submodules/FAQorReleaseInfo.js","Components/Welcome/Submodules/EmailVerification.js","Components/Welcome/WelcomePage.js","Helpers/TokenValidation.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","MessageIF","dbId","id","message","dateTime","this","BackendLink","process","TokenSignature","AESKEY","AESIV","SettingsList","SongList","PasswordStrLevels","str","color","ROUTES","FAQDATA","question","answer","RELEASEDATA","version","changes","GetAllChatsByUserId","userId","a","token","jwt","sign","fetch","method","headers","body","JSON","stringify","chats","json","FetchLastMessagesByChatId","chatId","user","totalMessages","messagesToState","messages","forEach","msgDisplayId","push","messageText","createdDate","TryLoginOrRegister","loginData","endpoint","result","status","CheckForResponseCodeAndThrow","text","emailToAdd","console","log","res","sound","newchat","newmessage","connection","code","error","Error","ProcessChats","chatsToState","chat","chatToAdd","lastMessage","image","friendImageUrl","isOnline","lastMessagesAreFetched","name","friendUserName","msg","CheckForInvite","game","FindChatIndexByChatId","chatData","i","AddTenMessagesToState","currentChat","length","CheckIfChatIdMatchIsPresent","chatList","chatIdList","cache","output","found","preview","indx","indexOf","gameName","slice","AudioSettingsModal","show","handleClose","updateAudio","chooseSong","useState","value","setValue","song","setSong","changeRadioColor","isOn","Modal","onHide","centered","Body","Dropdown","Toggle","variant","Menu","map","item","Item","key","onClick","changeSong","ToggleButtonGroup","type","onChange","val","ToggleButton","Boolean","AddContactModal","createNewChat","email","setEmail","setError","useContext","UserChatsContext","Form","onSubmit","event","preventDefault","SendNewChatData","then","userName","catch","err","toString","includes","Group","controlId","Label","Control","placeholder","target","Text","className","FormGroup","Button","disabled","ProfileChangeForm","UpdateUserData","input","setInput","showAlert","setShowAlert","validateForm","updatedData","isImageUrl","Row","Col","e","Alert","onClose","dismissible","ToggleSwitch","activeSwitches","handleChange","title","setTitle","useEffect","nameSplit","match","finalTitle","word","CheckIfStartsWithLower","string","first","charAt","toLowerCase","toUpperCase","substring","style","marginRight","checked","onColor","onHandleColor","handleDiameter","uncheckedIcon","checkedIcon","boxShadow","activeBoxShadow","height","width","NotificationsForm","notificationSettings","setActiveSwitches","newState","newChatReceived","newMessageReceived","connectionChanged","UpdateNotificationSettings","alignContent","Object","keys","index","MyAccountModal","Tabs","defaultActiveKey","Tab","eventKey","imageUrl","Figure","Image","roundedCircle","alt","src","Caption","float","Settings","logout","seen","modal","setModal","size","xmlns","viewBox","d","fill","Friends","clickOnChat","setChatIndex","MainChatWindowContext","chatIndex","isMobile","unSelected","margin","backgroundColor","selected","marginBottom","marginTop","handleClick","imgUrl","letter","justify","ellipsis","marginLeft","active","FriendsSide","LoadTenMessages","updAudio","GAMES","icon","ticIC","GAMEACTIONS","GamePicker","sendMessage","GAMECODE","ScrollChatToBottom","chatWindow","document","getElementsByClassName","maxScrollTop","scrollHeight","clientHeight","scrollTop","CalculateScrollDistance","h","b","st","sh","fileDownload","require","useStyles","makeStyles","root","padding","display","alignItems","flex","wordWrap","iconButton","divider","Input","onSendClick","classes","inputFile","useRef","file","setFile","submitIsValid","trim","Paper","component","OverlayTrigger","trigger","placement","overlay","Popover","showPreview","set","onSelect","emoji","native","IconButton","aria-label","ref","stopPropagation","files","InputBase","onKeyPress","ev","setTimeout","rowsMax","multiline","inputProps","hi","Divider","orientation","Square","disable","row","col","clicked","setClicked","rowCrossed","board","columnCrossed","diagonalCrossed","isFull","TicTacToeBoard","setChats","inGameAction","handleSetValue","lastRow","lastCol","newChats","currentPlayer","winner","p1","p2","p3","winnerCalc","draw","myMark","getDescription","matrix","r","c","createBoard","ChatPanel","InGameAction","isIOS","useWindowSize","showConfetti","setShowConfetti","addToast","useToasts","finishGame","surrender","oldchats","indexToRemove","appearance","autoDismiss","splice","acceptGame","ChatWindow","onSend","loadTen","GoBack","scrollPercentage","setScrollPercentage","listenToScrollEvent","LoadMoreMessages","addEventListener","requestAnimationFrame","ChatSide","SendMessage","NewChat","url","notification","autoLoad","playStatus","Sound","PLAYING","NewMessage","GameInviteSent","failed","OnlineOrOffline","online","ReconnectFail","isLast","nextTime","timer","setTimer","interval","setInterval","clearInterval","CryptoJS","setUser","setHub","PopupNotification","setChatId","hubConnect","signalR","withUrl","build","loc_user","hackUser","start","invoke","connectionId","onclose","l_user","Reconnect","oldChats","on","decrypted","AES","decrypt","enc","Base64","parse","iv","Utf8","prevState","neededChatIndex","updatedChats","assign","neededChat","unshift","prev","dist","chatIds","checkMatch","userChatIds","updatedChat","chatName","data","time","userNotificationSettings","Promise","resolve","reject","React","createContext","MainChatAppWindow","detectMobile","useMobileDetect","removeToast","hubConnection","setHubConnection","redirect","setRedirect","setIsMobile","setIsIOS","partToShow","setPartToShow","useCookies","removeCookie","CreateMainHubConnection","PopUpNotification","hub","isIos","content","removeTimer","CreateNewChat","newUser","shouldSetChatId","currentChatsState","numberOfMessages","shouldScrollUp","alert","l_chatIndex","l_chatId","msgText","isInvite","ciphertext","encrypt","Date","enable","getElementsByTagName","play","pause","SendMessageAndSetIndex","SendMessageWithChatData","gameExists","stop","TryToDoGoogleLogout","auth2","gapi","getAuthInstance","signOut","disconnect","action","Provider","to","songname","witcher","drStone","setSongMP3","preload","loop","Login","loginOrRegister","password","setPassword","isConnecting","setIsConnecting","success","setSuccess","handleLogin","param","querySelector","signIn","detail","provider","split","Card","Header","FormLabel","FormControl","autoFocus","href","credentialmode","microsoftkey","googlekey","facebookkey","block","Spinner","as","animation","role","aria-hidden","Register","setName","passwordStrength","setPasswordStrength","username","swal","borderBottom","currentStr","FAQorReleaseInfo","isFAQ","Container","md","lg","xl","sm","xs","Nav","qa","Link","vc","Content","Pane","change","EmailedVerified","done","newVal","WelcomePage","path","isLoading","spinner","Navbar","bg","expand","Brand","aria-controls","Collapse","ValidateToken","verify","App","cookies","setCookie","setIsLoading","isLoggedIn","setLoggedIn","GetChats","ValidateAndSetUser","parseInt","userToken","maxAge","route","isLocalhost","window","location","hostname","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","onUpdate","onSuccess","ReactDOM","render","getElementById","URL","origin","response","contentType","get","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.30932640.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/notification.56a9110c.mp3\";","module.exports = __webpack_public_path__ + \"static/media/lol.f8b7a2e4.mp3\";","module.exports = __webpack_public_path__ + \"static/media/dr_stone_ending.470614e2.mp3\";","module.exports = \"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD//gAfQ29tcHJlc3NlZCBieSBqcGVnLXJlY29tcHJlc3P/2wCEAAQEBAQEBAQEBAQGBgUGBggHBwcHCAwJCQkJCQwTDA4MDA4MExEUEA8QFBEeFxUVFx4iHRsdIiolJSo0MjRERFwBBAQEBAQEBAQEBAYGBQYGCAcHBwcIDAkJCQkJDBMMDgwMDgwTERQQDxAUER4XFRUXHiIdGx0iKiUlKjQyNEREXP/CABEIADAAMAMBIgACEQEDEQH/xAAZAAADAQEBAAAAAAAAAAAAAAAEBgcFAwj/2gAIAQEAAAAA9ZrRYbGxpcsNzm2iNsoTABqjV5goZnClHyoLNtFJxlQIOymf/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAgBAhAAAAAAf//EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMQAAAAAH//xAAeEAACAwEBAQADAAAAAAAAAAAFBgMEBwIBFQASFP/aAAgBAQABEgB8fTYM2AS0tfhLtJeCe3xxU1piHDtGFt6xWHtqqu2D8cBbVmCaugBk5ZrkmxnBxGvYINeYhwvSB7cr1h7cqAJjfNc3qsKysozcdCWfhmYKshK9n7xFoAm0foBblIT7b7iG2NTBDpja60j9EHqDaNhnhqWC1dbFpmwM7JrANlcjagSH898QLBlayxmW9YBrjgEWadHyU5WWxSPsLIw6uEZXI4q3qP78cZi8omZCmbQBsY4aOHT3ROWiVBaHlQSc5RmBXFvqzWpnklOapoJ2ZUEFpoOfeIZNPyvMh2a6GQoZ6uVrdVZLTwT/ABslSs6zZjYsnD3R14aM4KlTAnJ3DJtUZ1fKhNClQEluRRb5KZUGZwoqmLKzA4FVamWsd5BcBQlmpYlzUQnNozir0QgKsyyvdwxHmMWNlm596j51F/QreZaLSpOwCexOrl4oYeJc0eM2zVeYdLGUx1QYKkJjDXucJWS6yuLmlDbw66HK9ihXnq7dE5s4qGuLYBvFqtIVPzk4cZGXZ2a7oYttbS3Fbm9PrNxDCQhDr6h0zYz+rynOSKj8kcsr1lhVcvC1KY0KY4HF+aKMKXMuW13FVllcjq1Tv+xmaqSQSteXz2Mrau6gVa7f54R8wzK0kJ1q3nSxPYmBj5ZpQaaoLEtidaVQ4mWfnzibt/RINCHjwZIxcqhubnE5GnTyfgGiv6GEYLPoc5SIVhVUtlLBDXQDKczVxrasA4gvs8GQsRIXpBBuaaxBuawEwPmwujOgC4ACSzeS9jx1Wn1J+f/EACcQAAICAQQBBAEFAAAAAAAAAAIDAQQABRESMRMUISMyEBUkQkNR/9oACAEBABM/ALT/AE9SpTr7Qb3nETPc7QI5Xsy+jqFUFGQsUe0EMcw4FGWbMopUKkrAja49pKY5HxGIxFmX0b9WFnINUe0FA8w4lGVvkVpU2lCYG4ftKpIuPLLcQE364dWQDsFlP13y8SCRbqOmJYhyXGHMMr2KyFKrhWZK6tVAGXZlj7NWwltdqA8lW0kzHK9ishSkLQcrq1UAZZGqVlJusXWCBVbjlykFl/DBuqtjpinf0LkJkoVy3keWX6SbJgM9wMsGdoxOmVwYpq6pkJgUB7EOL0ms6aUvrBMWbO4SRAR9lhaTWRNyUVin1NXYYMRE+iy7UrIr16sLACs2WysiKTPNMUnwW6rt5S9TVAEmGXbaq5GMdyEMKN8VqVc2MYdQ4EAGD3kpxWq1k+t8NYf21ncucBB9jh6pWfNKXVj3rVtikyAj6HLlqs+vZqEoDmtYVLBIZA801iYRVqo3hSEqUZyAZY05F0dLW3prfJBEKZLP0WoiLbEVDmbFOYDnAgfR4+jTQpaFoDy2rTzWXZFlWjTcDEmg/FbqPBY9EON0ioZmZoGZIpkPcpzT6KapMGOoKVCO8ZVmAjUUh1Xaf2Fcl7ltlv5V6VF1BKlay+xKgi3yzWl9K/UhYCanBvBRHIOQzGIrSijQqysxBSg3kpHmfIpwY2g5QqFyUR/k7fj/xAAUEQEAAAAAAAAAAAAAAAAAAAAw/9oACAECAQE/AB//xAAUEQEAAAAAAAAAAAAAAAAAAAAw/9oACAEDAQE/AB//2Q==\"","export class MessageIF {\n    constructor({dbId,id,message,dateTime}) {\n        this.dbId = dbId;\n        this.id = id;\n        this.message = message;\n        this.dateTime = dateTime;\n    }\n}","export const BackendLink = process.env.REACT_APP_APILINK;\nexport const TokenSignature = process.env.REACT_APP_TOKEN_SIGNATURE;\nexport const AESKEY = process.env.REACT_APP_AESKEY;\nexport const AESIV = process.env.REACT_APP_AESIV;\nexport const GAMECODE = '#GAME#';\n\nexport const SettingsList = ['Audio','Add Contact','My Account','Logout'];\nexport const SongList = ['witcher','drStone'];\nexport const PasswordStrLevels = [{str:'weak',color:'red'},{str:'weakish',color:'darkorange'},{str:'medium',color:'#E1CB0C'},{str:'okay',color:'springgreen'},{str:'strong',color:'green'}];\n\nexport const ROUTES = ['/faq','/release','/vsuccess','/vfailed'];\n\nexport const FAQDATA = [{question:'Q: What do I do here?',answer:'A: You send messages to other people, could you imagine!!!'},\n    {question:'Q: How to get started?',answer:'A: Please register, then add other people and talk to them as much as you want. Please mind the warning above when you submit any data.'},\n    {question:'Q: Who are the creators of this miracle?',answer:'A: Bohdan Boss and Artem Daddy :))'},\n    {question:'Q: What are future plans for this project?',answer:'A: Show WhatsApp and Telegram how to make good apps...'},\n    {question:'Q: Why can I not send emoji without text on PC?',answer:'A: This is a known issue and might be fixed later, hold tight!'},\n    {question:'Q: Are my messages 100% secure?',answer:'A: Let\\'s say sending credit card details is not a good idea, but gossips are totally fine.'},\n    {question:'Q: How can I suggest improvements?',answer:'A: Just start a chat with one of the Creators and show us your ideas.'},\n    {question:'Q: Lorem Ipsum?',answer:'A: Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.'}\n\n    ];\n\nexport const RELEASEDATA = [\n    {version: 'v0.4.0',changes: ['More login options','Minor fixes and improvements','Security updates']},\n    {version: 'v0.3.6',changes: ['Game platform fixes','Safari chat window UI fix','Google login security update']},\n    {version: 'v0.3.5',changes: ['Introduced new in-chat gaming platform and added tic-tac-toe']},\n    {version: 'v0.3.4',changes: ['Further improved chat window UI']},\n    {version: 'v0.3.3',changes: ['Improved user status detection']},\n    {version: 'v0.3.2',changes: ['Improved chat window UI and built-in emoji']},\n    {version: 'v0.3.1',changes: ['Fix login and cookie related bugs']},\n    {version: 'v0.3',changes: ['Security updates','Notification settings','More efficient live communication',\n            'Email verification','Login with Google','Bugfixes and other minor improvements','Semi-advanced security for messages', 'Added cookies support']},\n\n    {version: 'v0.2.1',changes: ['Bugfixes and UI improvements']},\n    {version: 'v0.2',changes: ['Chats are sorted based on last message','Automatic reconnection in case of disconnect',\n            'Online/Offline status of users with notifications','Account settings with live update','Emoji for desktop users','Bugfixes and other minor improvements']},\n    {version:'v0.1',changes:['Registration/Login','Live messages','Message history is saved and is reloaded on login','Can add others to contact list','Audio settings']},\n    ];\n","import {MessageIF} from \"../Components/ChatWindow/Message/MessageIF\";\nimport {BackendLink, TokenSignature} from \"../Constants/Const\";\nimport jwt from'jsonwebtoken';\n\nexport async function GetAllChatsByUserId(userId) {\n    try {\n        let token = jwt.sign({userId}, TokenSignature);\n        let chats = await fetch(`${BackendLink}/api/getallchats`, {\n            method: 'post',\n            headers: {'Content-type': 'application/json'},\n            body: JSON.stringify({token})\n        });\n        chats = await chats.json();\n        return chats;\n    } catch (e) {\n        throw e;\n    }\n}\n\n//Sends a request to the server and returns an array of messages received from there\nexport async function FetchLastMessagesByChatId(chatId,user,totalMessages) {\n    let messagesToState = [];\n    try {\n        let token = jwt.sign({chatId,totalMessages}, TokenSignature);\n        let messages = await fetch(`${BackendLink}/api/getlastmessages`, {\n            method: 'post',\n            headers: {'Content-type': 'application/json'},\n            body: JSON.stringify({token})\n        });\n        messages = await messages.json();\n        await messages.forEach(message =>{\n            let msgDisplayId = message.userId === user.userId ? 0 : 1;\n            messagesToState.push(new MessageIF({id:msgDisplayId,message:message.messageText,dateTime:message.createdDate}));\n        });\n        return messagesToState;\n    }\n    catch (error) {\n        throw error;\n    }\n}\n\nexport async function TryLoginOrRegister (loginData,endpoint) {\n    try {\n\n        let result = await fetch(`${BackendLink}/api/${endpoint}`, {\n            method: 'post',\n            headers: {'Content-type': 'application/json'},\n            body: JSON.stringify(loginData)\n        });\n        let status = result.status;\n        result = await result.json();\n        CheckForResponseCodeAndThrow(status,result.text);\n        return result;\n    } catch (e) {\n        throw e;\n    }\n}\n\nexport async function SendNewChatData (userId,emailToAdd) {\n    try {\n        console.log(BackendLink);\n        let token = jwt.sign({userId,emailToAdd}, TokenSignature);\n        let res = await fetch(`${BackendLink}/api/addchat`, {\n            method: 'post',\n            headers: {'Content-type': 'application/json'},\n            body: JSON.stringify({token})\n        });\n\n        let status = res.status;\n        res = await res.json();\n        CheckForResponseCodeAndThrow(status,res.text);\n        return res;\n\n    } catch (e) {\n        throw e;\n    }\n}\nexport async function UpdateNotificationSettings (userId,sound,newchat,newmessage,connection) {\n    try {\n        let token = jwt.sign({userId,sound,newchat,newmessage,connection}, TokenSignature);\n        let res = await fetch(`${BackendLink}/api/settingsapply`, {\n            method: 'post',\n            headers: {'Content-type': 'application/json'},\n            body: JSON.stringify({token})\n        });\n        let status = res.status;\n        CheckForResponseCodeAndThrow(status,res.text);\n        return 'ok';\n\n    } catch (e) {\n        throw e;\n    }\n}\n\nfunction CheckForResponseCodeAndThrow(code,error){\n    switch (code) {\n        case 400:\n            throw new Error(error);\n        case 500 :\n            throw new Error('Server error,try again later');\n        case 404 :\n            throw new Error('Server error,try again later');\n        default:\n            break;\n    }\n}","import {FetchLastMessagesByChatId} from \"./ApiFetcher\";\nimport {MessageIF} from \"../Components/ChatWindow/Message/MessageIF\";\nimport {GAMECODE} from \"../Constants/Const\";\n\nexport function ProcessChats (chats,userId) {\n    let chatsToState = [];\n\n    chats.forEach(chat=>{\n        let msgDisplayId,chatToAdd;\n        if(chat.lastMessage) {\n            msgDisplayId = chat.lastMessage.userId === userId ? 0 : 1;\n            const message = chat.lastMessage;\n            chatToAdd = {id:chat.chatId,image:chat.friendImageUrl,isOnline:chat.isOnline,lastMessagesAreFetched:false, name: chat.friendUserName,msg:[new MessageIF({id:msgDisplayId,message:CheckForInvite(message.messageText,true),dateTime:message.createdDate})]};\n        }\n        else{\n            // lastMessagesAreFetched value doesn't matter in this case,as the chat is empty and must be updated live time anyway\n            chatToAdd = {id:chat.chatId,image:chat.friendImageUrl,isOnline:chat.isOnline,lastMessagesAreFetched:false, name: chat.friendUserName,msg:[]};\n        }\n        chatToAdd.game = {};\n        chatsToState.push(chatToAdd);\n    });\n    return chatsToState;\n}\n\n//loop until u find chat with ID equal to given, return index\nexport const FindChatIndexByChatId = (chatId,chatData) =>{\n    let i = 0;\n    for(let chat of chatData){\n        if(chat.id === chatId) return i;\n        i++;\n    }\n    return -1;\n};\n\nexport const AddTenMessagesToState = async (id,user,currentChat)=>{\n    try {\n        let messages = await FetchLastMessagesByChatId(id, user, currentChat.msg.length);\n        currentChat.msg.forEach((msg) => {\n            messages.push(msg);\n        });\n        currentChat.lastMessagesAreFetched = true;\n        currentChat.msg = [];\n        currentChat.msg = [...messages];\n\n        return currentChat;\n    }\n    catch (e) {\n        throw e;\n    }\n};\n\n// O(n + m) function to find a match in 2 arrays\nexport const CheckIfChatIdMatchIsPresent = (chatList,chatIdList) =>{\n    let cache = {};\n    let output = {found:false};\n    chatList.forEach(chat=>{\n            const id = chat.id;\n            //value doesnt matter here\n            cache[id] = 1;\n        }\n    );\n    for(let chatId of chatIdList){\n        if(chatId in cache){\n            output.found = true;\n            output.id = chatId;\n            break;\n        }\n    }\n    return output;\n};\n\nexport const CheckForInvite = (message, preview = false) => {\n    const indx = message.indexOf(GAMECODE);\n    let text = message;\n    let gameName = '';\n    if( indx !== -1){\n        text = message.slice(0,indx-1);\n        gameName = message.slice(indx + GAMECODE.length);\n    }\n    //for chat game name has to be returned separately to highlight game name\n    return preview ?(text + gameName) :{text,gameName};\n};","import React,{useState} from 'react';\nimport Modal from \"react-bootstrap/Modal\";\nimport ToggleButtonGroup from \"react-bootstrap/ToggleButtonGroup\";\nimport ToggleButton from \"react-bootstrap/ToggleButton\";\nimport Dropdown from \"react-bootstrap/Dropdown\";\nimport {SongList} from \"../../../Constants/Const\";\n\n\n// TODO use gloabl state instead of local\nfunction AudioSettingsModal({show,handleClose,updateAudio,chooseSong}) {\n    const [value, setValue] = useState(0);\n    const [song, setSong] = useState('');\n\n    const handleChange = (val) => {\n        setValue(val);\n        if(val && song){\n            updateAudio(true);\n        }\n        else if(!val) {\n            updateAudio(false);\n        }\n    };\n\n    const changeRadioColor = (isOn) =>{\n        return isOn ? 'primary' : 'secondary';\n    };\n    const changeSong = (item) =>{\n        setValue(0);\n        chooseSong(item);\n        setSong(item);\n    };\n    return (\n        <>\n        <Modal show={show} onHide={handleClose} centered>\n            <Modal.Body>\n                <h3>Audio settings</h3>\n                <h5>Current song</h5>\n                <Dropdown >\n                    <Dropdown.Toggle variant=\"success\" id=\"dropdown-basic\">\n                        {song\n                            ? <>{song}</>\n                            :<>Choose song </>\n                        }\n                    </Dropdown.Toggle>\n                    <Dropdown.Menu>\n                        {SongList.map((item)=>(\n                                <Dropdown.Item key = {item} onClick = {()=>changeSong(item)}>{item}</Dropdown.Item>\n                        ))}\n                    </Dropdown.Menu>\n                </Dropdown>\n                <h4> Playback </h4>\n                    <ToggleButtonGroup type=\"radio\" name=\"options\" value={value} onChange={handleChange}>\n                        <ToggleButton variant ={changeRadioColor(Boolean(value))} value={1} >On</ToggleButton>\n                        <ToggleButton variant ={changeRadioColor(!Boolean(value))}  value={0}>Off</ToggleButton>\n                    </ToggleButtonGroup>\n            </Modal.Body>\n        </Modal>\n        </>\n    );\n}\nexport default AudioSettingsModal;","import React, {useContext, useState} from 'react';\nimport Modal from \"react-bootstrap/Modal\";\nimport Form from \"react-bootstrap/Form\";\nimport Button from \"react-bootstrap/Button\";\nimport {FormGroup} from \"react-bootstrap\";\nimport {UserChatsContext} from \"../../../App\";\nimport {SendNewChatData} from \"../../../Helpers/ApiFetcher\";\n\n\n\nfunction AddContactModal({show,handleClose,createNewChat}) {\n\n    const [email, setEmail] = useState(\"\");\n    const [error, setError] = useState(\"\");\n\n    const {user} = useContext(UserChatsContext);\n    const userId = user? user.userId : 0;\n\n    const handleSubmit = (event) => {\n        event.preventDefault();\n        SendNewChatData(userId,email)\n            .then(res=>{\n                if(res){\n                    const {chatId,userName,friendImageUrl} = res;\n                    createNewChat(chatId,userName,friendImageUrl);\n                    handleClose();\n                }\n            })\n            .catch(err=>{\n                if(err.toString().includes('Failed to fetch')){\n                    setError('No response from the server')\n                }else {\n                    setError(err.message);\n                }\n            });\n    };\n        //if no error add a new chat in main window\n    const validateForm = () => {\n        return email.length > 0;\n    };\n    return (\n        <>\n            <Modal show={show} onHide={handleClose} centered>\n                <Modal.Body>\n                    <h3>Add contact </h3>\n                    <Form onSubmit={handleSubmit}>\n                        <Form.Group controlId=\"formBasicEmail\">\n                            <Form.Label>Email address</Form.Label>\n                            <Form.Control type=\"email\" placeholder=\"Enter email\" onChange={(event)=>setEmail(event.target.value)} />\n                            <Form.Text className=\"text-muted\">\n                                Ask creators about their current emails.\n                            </Form.Text>\n                        </Form.Group>\n                        {error\n                            ? <FormGroup>\n                                <div className='dark-red'>{error}</div>\n                            </FormGroup>\n                            : <></>\n                        }\n                        <Button variant=\"primary\" type=\"submit\" disabled={!validateForm()}>\n                            Add friend\n                        </Button>\n                    </Form>\n                </Modal.Body>\n            </Modal>\n        </>\n    );\n}\nexport default AddContactModal;","import React, { useState} from 'react';\nimport Button from \"react-bootstrap/Button\";\nimport Form from \"react-bootstrap/Form\";\nimport Col from \"react-bootstrap/Col\";\nimport Alert from \"react-bootstrap/Alert\";\nimport isImageUrl from 'is-image-url';\n\nfunction ProfileChangeForm({type,UpdateUserData}) {\n\n    const[input,setInput] = useState('');\n    const[showAlert,setShowAlert] = useState({show:false,type:''});\n\n\n    function handleSubmit(event) {\n        event.preventDefault();\n        let updatedData = {type,value:input};\n\n        //if link to image is broken show error else update data\n        if(type === 'image' && !isImageUrl(input)) {\n            setShowAlert({show:true,type:'danger'})\n        }\n        else{\n            UpdateUserData(updatedData.type,updatedData.value);\n            setShowAlert({show:true,type:'success'});\n        }\n        setInput('');\n    }\n\n    function validateForm() {\n        return input.length > 2;\n    }\n\n    return (\n        <>\n            <form onSubmit = {handleSubmit}>\n                <Form.Row>\n                    <Col>\n                        <Form.Control placeholder={'new ' + type} value={input} onChange={e => setInput(e.target.value)}/>\n                    </Col>\n                    <Col>\n                        <Button type=\"submit\" variant={!validateForm() ? 'secondary' : \"primary\"}\n                                disabled={!validateForm()}> Update!</Button>\n                    </Col>\n                    {showAlert.show\n                        ?\n                        <Alert variant={showAlert.type} onClose={() => setShowAlert({show:false,type:''})} dismissible className='ma2'>\n                            {showAlert.type === 'danger'\n                                ? `Your ${type} change failed with many errors!`\n                                : 'Your ' + type + ' was changed successfully!'\n                            }\n                        </Alert>\n                        :\n                        <div/>\n                    }\n\n                </Form.Row>\n            </form>\n        </>\n    );\n}\nexport default ProfileChangeForm;","import React, {useEffect, useState} from 'react';\nimport Switch from \"react-switch\";\n\n\nfunction ToggleSwitch({name,activeSwitches,handleChange}) {\n\n    const[title,setTitle] = useState('');\n\n    useEffect(()=>{\n        let nameSplit = name.match(/([A-Z]?[^A-Z]*)/g).slice(0,-1);\n        let finalTitle = '';\n        if(nameSplit){\n            for(let word of nameSplit){\n                word = CheckIfStartsWithLower(word);\n                finalTitle += (' ' + word);\n            }\n        }else{\n            name = CheckIfStartsWithLower(name);\n            finalTitle = name;\n        }\n        setTitle(finalTitle);\n    },);\n\n    const CheckIfStartsWithLower = (string)=>{\n        let first = string.charAt(0);\n        if (first === first.toLowerCase() && first !== first.toUpperCase())\n        {\n             return first.toUpperCase() + string.substring(1);\n        }\n        return string;\n    };\n    return (\n        <>\n            <div className='col-8' style={{marginRight:'5px'}}>\n                {title}\n            </div>\n            <div className='col-2'>\n                <label>\n                    <Switch  onChange={()=>handleChange(name)} checked={Boolean(activeSwitches[name])}\n                             onColor=\"#86d3ff\"\n                             onHandleColor=\"#2693e6\"\n                             handleDiameter={30}\n                             uncheckedIcon={false}\n                             checkedIcon={false}\n                             boxShadow=\"0px 1px 5px rgba(0, 0, 0, 0.6)\"\n                             activeBoxShadow=\"0px 0px 1px 10px rgba(0, 0, 0, 0.2)\"\n                             height={20}\n                             width={48}\n                    />\n                </label>\n            </div>\n        </>\n    );\n}\nexport default ToggleSwitch;","import React, {useContext, useState} from 'react';\nimport ToggleSwitch from \"./ToggleSwitch\";\nimport Button from \"react-bootstrap/Button\";\nimport {UserChatsContext} from \"../../../../App\";\nimport Alert from \"react-bootstrap/Alert\";\nimport {UpdateNotificationSettings} from \"../../../../Helpers/ApiFetcher\";\n\n\nfunction NotificationsForm({UpdateUserData,handleClose}) {\n\n    const {user} = useContext(UserChatsContext);\n\n    const[activeSwitches,setActiveSwitches] = useState(user.notificationSettings);\n    const[showAlert,setShowAlert] = useState({show:false,type:''});\n\n\n    function handleSubmit(event) {\n        event.preventDefault();\n        UpdateUserData('notifications',activeSwitches);\n        const {sound,newChatReceived,newMessageReceived,connectionChanged} = activeSwitches;\n        UpdateNotificationSettings(user.userId,sound,newChatReceived,newMessageReceived,connectionChanged)\n            .then(()=>setShowAlert({show:true,type:'success'}))\n            .catch(err=>{\n                setShowAlert({show:true,type:'danger'});\n                console.log(err);\n            })\n\n    }\n\n    function handleChange(val){\n        let newState = {...activeSwitches};\n        newState[val] = !newState[val];\n        setActiveSwitches(newState);\n    }\n    return (\n        <>\n            <form onSubmit = {handleSubmit}>\n                <label>\n                    <div className='container'>\n                        <div className='row h-auto' style={{alignContent:'start'}}>\n                            {\n                                Object.keys(activeSwitches).map((key, index) => (\n                                    index === 0\n                                        ? <div key={key}/>\n                                        : <ToggleSwitch handleChange={handleChange} activeSwitches={activeSwitches}\n                                                        name={key} key={key}/>\n                                ))\n                            }\n                        </div>\n                    </div>\n                </label>\n                <br/>\n                {showAlert.show\n                    ?\n                    <Alert variant={showAlert.type} onClose={() => setShowAlert({show:false,type:''})} dismissible className='ma2'>\n                        {showAlert.type === 'danger'\n                            ? `Failed to save notification settings!`\n                            : 'Notification settings changed successfully!'\n                        }\n                    </Alert>\n                    :<div/>\n                }\n                <br/> <Button type={'submit'}> Save </Button>\n            </form>\n        </>\n    );\n}\nexport default NotificationsForm;","import React, {useContext} from 'react';\nimport Modal from \"react-bootstrap/Modal\";\nimport {UserChatsContext} from \"../../../App\";\nimport Figure from \"react-bootstrap/Figure\";\nimport Button from \"react-bootstrap/Button\";\nimport Tab from \"react-bootstrap/Tab\";\nimport Tabs from \"react-bootstrap/Tabs\";\nimport ProfileChangeForm from \"./Forms/ProfileChangeForm\";\nimport NotificationsForm from \"./Forms/NotificationsForm\";\n\nfunction MyAccountModal({show,handleClose,UpdateUserData}) {\n\n    const {user} = useContext(UserChatsContext);\n    return (\n        <>\n            <Modal show={show} onHide={handleClose} centered >\n                <Modal.Body>\n                    <h3>My Account</h3>\n                    <Tabs defaultActiveKey=\"Picture\" id=\"uncontrolled-tab-example\">\n                        <Tab eventKey=\"Picture\" title=\"Picture\">\n                            {\n                                user.imageUrl\n                                    ? <Figure >\n                                        <Figure.Image\n                                            roundedCircle = {true}\n                                            width={100}\n                                            height={120}\n                                            alt=\"profile picc\"\n                                            src={user.imageUrl}\n                                        />\n                                        <Figure.Caption>\n                                            Your profile picture.\n                                        </Figure.Caption>\n                                        <div><ProfileChangeForm UpdateUserData={UpdateUserData} type={'image'}/></div>\n                                    </Figure>\n                                    : <span className='ma2'> You have no pic<div><ProfileChangeForm UpdateUserData={UpdateUserData} type={'image'}/></div></span>\n                            }\n                        </Tab>\n                        <Tab eventKey=\"Name\" title=\"Name\">\n                            <div className='ma2 '>\n                                <h6>Your current name is <strong>{user.userName}</strong></h6>\n                                <ProfileChangeForm UpdateUserData={UpdateUserData} type={'name'}/>\n                            </div>\n                        </Tab>\n                        <Tab eventKey=\"Notifications\" title=\"Notifications\">\n                            <div className='ma2 '>\n                                <NotificationsForm UpdateUserData={UpdateUserData}/>\n                            </div>\n                        </Tab>\n                    </Tabs>\n                    <Button style = {{float:'right'}} onClick = {()=>handleClose()}>Close</Button>\n                </Modal.Body>\n            </Modal>\n        </>\n    );\n}\nexport default MyAccountModal;","import React,{useState} from 'react';\nimport Dropdown from \"react-bootstrap/Dropdown\";\nimport AudioSettingsModal from \"./Modals/AudioSettingsModal\";\nimport AddContactModal from \"./Modals/AddContactModal\";\nimport {RELEASEDATA, SettingsList} from \"../../Constants/Const\";\nimport MyAccountModal from \"./Modals/MyAccountModal\";\nimport './Settings.css';\n\n\n\nfunction Settings({updateAudio,logout,chooseSong,createNewChat,UpdateUserData}) {\n    const [modal, setModal] = useState({type:'',seen:false});\n\n    const handleClose = () => setModal({type:'',seen:false});\n    const handleShow = (type) => setModal({type:type,seen:true});\n\n    return (\n        <>\n        <Dropdown className={'settings-ext'}>\n            <Dropdown.Toggle variant=\"secondary\" size={'sm'} id=\"dropdown-basic\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path d=\"M0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z\"/>\n                </svg>\n            </Dropdown.Toggle>\n            <span className={'app-name'} > Rocket chat {RELEASEDATA[0].version}</span>\n\n            <Dropdown.Menu>\n                {SettingsList.map((item,index)=>(\n                    (item ==='Logout')\n                        ?\n                        <Dropdown.Item key = {item} onClick = {logout}>{SettingsList[index]}</Dropdown.Item>\n                        :\n                        <Dropdown.Item key = {item} onClick = {()=>handleShow(SettingsList[index])} >{SettingsList[index]} </Dropdown.Item>\n                ))}\n            </Dropdown.Menu>\n        </Dropdown>\n            {\n                {\n                    'Add Contact': <AddContactModal show={modal.seen} handleClose={handleClose} createNewChat={createNewChat}/>,\n                    'Audio': <AudioSettingsModal show = {modal.seen} handleClose = {handleClose} updateAudio={updateAudio} chooseSong={chooseSong} />,\n                    'My Account' : <MyAccountModal show={modal.seen} handleClose={handleClose} UpdateUserData={UpdateUserData}/>,\n                    'Logout': <></>\n                }[modal.type]\n            }\n           </>\n\n    );\n}\nexport default Settings;","import React, {useContext} from 'react';\nimport './Friends.css';\nimport {ThemeProvider,Avatar,Row,ChatList,ChatListItem,Column,Title,Subtitle}\n    from '@livechat/ui-kit';\nimport 'status-indicator/styles.css'\n\nimport {UserChatsContext} from \"../../App\";\nimport {MainChatWindowContext} from \"../MainChatAppWindow/MainChatAppWindow\";\nimport {CheckForInvite} from \"../../Helpers/ProcessData\";\n\nfunction Friends({clickOnChat,setChatIndex}) {\n\n    const {chats} = useContext(UserChatsContext);\n    const {chatIndex,isMobile} = useContext(MainChatWindowContext);\n\n\n    const unSelected = {\n        margin: '2px',\n        backgroundColor: '#383838',\n        color: 'white'\n};\n    const selected = {\n        margin: '0px ',\n        marginBottom: '5px ',\n        marginTop: '5px ',\n        backgroundColor: 'black',\n        color: 'white'\n    };\n\n    const handleClick = (id,index) => {\n        clickOnChat(id,index,true);\n        setChatIndex(index);\n    };\n    return (\n        <ThemeProvider>\n            <ChatList className = {'scrollable'}>\n            {chats.map((chat,index) =>(\n                <div onClick={()=>handleClick(chat.id,index)} key = {chat.id} >\n                    <ChatListItem style = {(index === chatIndex && !isMobile) ? selected :unSelected } >\n                        {\n                            chat.image\n                                ?<Avatar imgUrl={chat.image}/>\n                                :<Avatar letter= {chat.name.charAt(0)} style={{color: 'black !important'}}/>\n                        }\n                        <Column>\n                            <Row justify>\n                                <Title ellipsis>{chat.name}</Title>\n                                <Subtitle style={{marginLeft:'5px'}} >{chat.isOnline\n                                    ? <status-indicator active ></status-indicator>\n                                    :<div/>}\n                                </Subtitle>\n                            </Row>\n                            <Subtitle ellipsis>{\n                                chat.msg.length > 0\n                                    ? CheckForInvite(chat.msg[chat.msg.length-1].message,true)\n                                    : 'Say something'\n                                }\n                            </Subtitle>\n                        </Column>\n                    </ChatListItem>\n                </div>\n            ) )}\n            </ChatList>\n        </ThemeProvider>\n    );\n}\nexport default Friends;","import React, {useContext} from 'react';\nimport {MainChatWindowContext} from \"../MainChatAppWindow\";\nimport Settings from \"../../Settings/Settings\";\nimport Friends from \"../../Friends/Friends\";\n\nexport default function FriendsSide({createNewChat,LoadTenMessages,updAudio,setSong,logout,setChatIndex,UpdateUserData}) {\n\n\n    const {isMobile} = useContext(MainChatWindowContext);\n\n    return (\n        <div className={ isMobile ? 'left-side col-12' : 'left-side col-4 col-sm-4 col-md-4 col-lg-2 col-xl-2'}>\n            <Settings createNewChat={createNewChat} updateAudio={updAudio} chooseSong={setSong} logout={()=>logout()} UpdateUserData={UpdateUserData}/>\n            <Friends clickOnChat={LoadTenMessages} setChatIndex = {setChatIndex}/>\n        </div>\n    );\n}\n","import ticIC from './TicTacToe/Util/tic-tac-toe_icon.jpg'\n\nexport const GAMES = [{name:'Tic-Tac-Toe',icon:ticIC}];\nexport const GAMEACTIONS = ['StartNewGame','EndGame','NewTurn'];","import React from \"react\";\nimport Figure from \"react-bootstrap/Figure\";\nimport './GamePicker.css';\nimport {GAMES} from '../GamesList';\nimport {GAMECODE} from \"../../../Constants/Const\";\n\nexport  default function GamePicker({sendMessage}) {\n\n    const onGameClick = (name) =>{\n        // true marks that this message is a game invite and it is not saved to database or shown in senders chats\n        // GAMECODE is being removed on render time\n        sendMessage(`Let's fight to death in a game of ${GAMECODE +' '+ name}`, true)\n    };\n    return (\n        <div>\n            <div className={'pick-header'}>\n                <h3 className='border-bottom border-dark pa3 shadow-5 header-text '>\n                    Pick a game\n                </h3>\n            </div>\n            <div> {/*TODO add flexbox*/}\n                {\n                    GAMES.map(game=>(\n                        <Figure className = 'pa2' key = {game.name}>\n                            <Figure.Image alt=\"Tic tac toe icon\" className='ic' src={game.icon} onClick={()=>onGameClick(game.name)}/>\n                            <Figure.Caption>\n                                {game.name}\n                            </Figure.Caption>\n                        </Figure>\n                    ))\n                }\n            </div>\n\n        </div>\n    );\n}","export const ScrollChatToBottom = () =>{\n    const chatWindow = document.getElementsByClassName(\"chat-panel\")[0];\n    const scrollHeight = chatWindow.scrollHeight;\n    const height = chatWindow.clientHeight;\n    const maxScrollTop = scrollHeight - height;\n    chatWindow.scrollTop = maxScrollTop > 0 ? maxScrollTop : 0;\n};\n\nexport const CalculateScrollDistance  =  ()  =>  {\n    const win = document.getElementsByClassName(\"chat-panel\")[0];\n    let h = win,\n        b = document.body,\n        st = 'scrollTop',\n        sh = 'scrollHeight';\n\n    return ((h[st]||b[st]) / ((h[sh]||b[sh]) - h.clientHeight) * 100);\n};\n","import React, {useContext, useState,useRef} from 'react';\nimport OverlayTrigger from \"react-bootstrap/OverlayTrigger\";\nimport Popover from \"react-bootstrap/Popover\";\nimport { makeStyles } from '@material-ui/core/styles';\nimport Paper from '@material-ui/core/Paper';\nimport InputBase from '@material-ui/core/InputBase';\nimport Divider from '@material-ui/core/Divider';\nimport IconButton from '@material-ui/core/IconButton';\nimport SendIcon from '@material-ui/icons/Send';\nimport SportsEsportsIcon from '@material-ui/icons/SportsEsports';import SentimentVeryDissatisfiedSharpIcon from '@material-ui/icons/SentimentVeryDissatisfiedSharp';\nimport CloudUploadIcon from '@material-ui/icons/CloudUpload';\nimport GamePicker from \"../Games/GamePicker/GamePicker\";\nimport 'emoji-mart/css/emoji-mart.css'\nimport '../ChatWindow/Chat.css'\n\nimport {Picker} from \"emoji-mart\";\nimport {ScrollChatToBottom} from \"../../Helpers/Scroller\";\nimport {MainChatWindowContext} from \"../MainChatAppWindow/MainChatAppWindow\";\nconst fileDownload = require('js-file-download');\n\nconst useStyles = makeStyles(() => ({\n    root: {\n        padding: '2px 4px',\n        display: 'flex',\n        alignItems: 'center',\n    },\n    input: {\n        flex: 1,\n        wordWrap:'break-word'\n    },\n    iconButton: {\n        padding: 10,\n        height:'100%'\n    },\n    divider: {\n        margin: 4,\n        height:'100%'\n    },\n}));\n\nexport default function Input({onSendClick}) {\n    const classes = useStyles();\n    const[input,setInput] = useState('');\n    const inputFile = useRef(null);\n    const[file,setFile] = useState();\n\n\n    const onEmojiClick = (emoji) => {\n        const text = `${input}${emoji.native}`;\n        setInput(text);\n    };\n    const SendMessageToDatabaseAndScreen = (event) => {\n        event.preventDefault();\n        onSendClick(input);\n        setInput('');\n    };\n    const onTyping = (event)=>{\n        setInput(event.target.value);\n        ScrollChatToBottom();\n    };\n    const onKeyPress=(ev) => {\n        if (ev.key === 'Enter') {\n            ev.preventDefault();\n            onSendClick(input);\n            setInput('');\n            setTimeout(()=>{\n                ScrollChatToBottom();\n            },20);\n        }\n    };\n    const handleFileClick = () =>{\n        inputFile.current.click();\n    };\n    const onFileChange = (event) =>{\n        event.stopPropagation();\n        event.preventDefault();\n        setFile(event.target.files[0]);\n    };\n    const downloadFile =() => {\n        fileDownload(file, file.name);\n    };\n    const submitIsValid = () => {\n        return input.trim().length > 0;\n    };\n    return (\n        <Paper component=\"form\" className={classes.root} onSubmit={SendMessageToDatabaseAndScreen}>\n            <div onClick={downloadFile}>\n                { file ? file.name : ''}\n            </div>\n            <OverlayTrigger trigger=\"click\" placement=\"top\"  overlay={\n                <Popover id=\"popover-basic\">\n                    <Picker title={'Emoji v2'} showPreview={false} set='emojione' onSelect={onEmojiClick} />\n                </Popover>\n            }>\n                <IconButton className={classes.iconButton} aria-label=\"emoji\">\n                    <SentimentVeryDissatisfiedSharpIcon className={'ic'} />\n                </IconButton>\n            </OverlayTrigger>\n            <input type='file' id='file' ref={inputFile} style={{display: 'none'}} onChange={onFileChange}/>\n            <InputBase\n                onKeyPress={onKeyPress}\n                onChange={onTyping}\n                value={input}\n                rowsMax={8}\n                multiline={true}\n                className={classes.input}\n                placeholder=\"write smth\"\n                onClick={()=>setTimeout(()=>ScrollChatToBottom(),100)}\n                inputProps={{ 'aria-label': 'search google maps' }}\n            />\n                <OverlayTrigger trigger=\"click\" hi placement=\"top\" overlay={\n                    <Popover id=\"popover-basic\">\n                        <GamePicker sendMessage={onSendClick}/>\n                    </Popover>\n                }>\n                    <IconButton className={classes.iconButton} aria-label=\"games\">\n                        <SportsEsportsIcon className={'ic'} />\n                    </IconButton>\n                </OverlayTrigger>\n\n            {\n                /*\n                <IconButton className={classes.iconButton} aria-label=\"upload\" onClick={handleFileClick}>\n                    <CloudUploadIcon className='ic'/>\n                </IconButton>\n                 */\n            }\n            <Divider className={classes.divider} orientation=\"vertical\" />\n            <IconButton type='submit' color={submitIsValid() ? 'primary' : 'secondary'} disabled={!submitIsValid()} className={classes.iconButton} aria-label=\"send\">\n                <SendIcon className='ic' />\n            </IconButton>\n        </Paper>\n    );\n}\n","import React, {useEffect, useState} from 'react';\n\n/**\n * @description\n * Square is a cell in the main 2d array, and can receive any value and optional color.\n * @example\n * import React from 'react';\n * import Square from '@bit/joshk.tic-tac-toe-game.square';\n *\n * export default (\n *   <Square value=\"O\"/>\n * )\n */\nexport default function Square({disable,row,col,setValue,value}) {\n\n    const[clicked,setClicked] = useState(false);\n\n    useEffect(()=>{\n        if(disable) setClicked(true);\n        else setClicked(false);\n    }, [disable]);\n\n    const handleClick = (event) => {\n        if (!clicked) {\n            setClicked(true);\n            setValue(row,col);\n        }\n    };\n        return (\n            <div className={`square ${value} `} onClick={handleClick}><span>{value}</span></div>\n        )\n}\n","export const winnerCalc = (board) =>{\n    const p1 = rowCrossed(board), p2 = columnCrossed(board), p3 = diagonalCrossed(board);\n    if(p1) return p1;\n    if(p2) return p2;\n    if(p3) return p3;\n    return isFull(board) ? '-1':'';\n};\n\n// A function that returns true if any of the row\n// is crossed with the same player's move\nconst  rowCrossed = (board) =>\n{\n    for (let i=0; i<3; i++)\n    {\n        const sign = board[i][0];\n        if (board[i][0] === board[i][1] &&\n            board[i][1] === board[i][2] &&\n            board[i][0] !== '')\n            return sign;\n    }\n    return '';\n};\n\n// A function that returns true if any of the column\n// is crossed with the same player's move\nconst columnCrossed = (board) =>\n{\n    for (let i=0; i<3; i++)\n    {\n        const sign = board[0][i];\n        if (board[0][i] === board[1][i] &&\n            board[1][i] === board[2][i] &&\n            board[0][i] !== '')\n            return sign;\n    }\n    return '';\n};\n\n// A function that returns true if any of the diagonal\n// is crossed with the same player's move\nconst diagonalCrossed = (board) =>\n{\n    let sign = board[0][0];\n\n    if (board[0][0] === board[1][1] &&\n        board[1][1] === board[2][2] &&\n        board[0][0] !== '')\n        return sign;\n\n    sign = board[0][2];\n\n    if (board[0][2] === board[1][1] &&\n        board[1][1] === board[2][0] &&\n        board[0][2] !== '')\n        return sign;\n\n    return false;\n};\nconst isFull = (board) =>\n{\n    for(let row of board){\n        for (let cell of row){\n            if(cell === '') return false;\n        }\n    }\n    return true;\n};\n","import React, {useContext} from 'react';\nimport Square from \"./Util/Square\";\nimport {winnerCalc} from \"./Util/WinnerCalc\";\nimport {MainChatWindowContext} from \"../../MainChatAppWindow/MainChatAppWindow\";\nimport {UserChatsContext} from \"../../../App\";\nimport {GAMEACTIONS} from \"../GamesList\";\nimport './Util/Style.scss'\n\nexport default function TicTacToeBoard({setChats,inGameAction}){\n\n    const {chatIndex} = useContext(MainChatWindowContext);\n    const {chats,user} = useContext(UserChatsContext);\n\n\n    const handleSetValue = (lastRow, lastCol) => {\n        setChats(chats=>{\n            let newChats = [...chats];\n            let game = newChats[chatIndex].game;\n            game.board[lastRow][lastCol] = game.currentPlayer;\n            game.winner = winnerCalc(game.board);\n            game.currentPlayer = game.currentPlayer === 'X'?'O':'X';\n            return newChats;\n        });\n        const game  = chats[chatIndex].game;\n        inGameAction(GAMEACTIONS[2],game);\n        if(game.winner) inGameAction(GAMEACTIONS[1],{draw: game.winner === '-1'});\n    };\n\n    const createBoard = () => {\n        let matrix = [...chats[chatIndex].game.board];\n        let board = [];\n        const game =chats[chatIndex].game;\n        for (let r = 0; r < 3; r++) {\n            let row = [];\n            for (let c = 0; c < 3; c++) {\n                row.push(<Square row={r} col={c} key={r + c} setValue={handleSetValue} value={matrix[r][c]}\n                                 disable={game.currentPlayer === game.myMark\n                                 || Boolean(game.winner)\n                                 || Boolean(matrix[r][c])}/>);\n            }\n            board.push(<div className=\"board-row\" key={\"row\" + r}>{row}</div>);\n        }\n        return <div className=\"rows-holder\" style={{ width: 3 * 56 }} >{board}</div>\n    };\n    const getDescription = () => {\n        const game = chats[chatIndex].game;\n        let text = '';\n        if(game.winner){\n            if(game.winner !== '-1'){\n                text += 'The winner: ';\n                text += game.currentPlayer === game.myMark ? user.userName : chats[chatIndex].name;\n            }\n            else{\n                text = 'DRAW'\n            }\n        }else{\n            text += 'Current player: ';\n            text += game.currentPlayer !== game.myMark ? user.userName : chats[chatIndex].name;\n        }\n        return <div className={'status tc'}>{text}</div>\n    };\n    return(\n        <div className=\"board\">\n            {getDescription()}\n            {createBoard()}\n        </div>\n    )\n}\n","import React, {useContext, useEffect, useState} from 'react';\nimport {ScrollChatToBottom} from \"../../../Helpers/Scroller\";\nimport {CheckForInvite} from \"../../../Helpers/ProcessData\";\nimport {MainChatWindowContext} from \"../../MainChatAppWindow/MainChatAppWindow\";\nimport {Paper} from \"@material-ui/core\";\nimport TicTacToeGame from \"../../Games/TicTacToe/TicTacToeGame\";\nimport Button from \"react-bootstrap/Button\";\nimport {GAMEACTIONS,GAMES} from \"../../Games/GamesList\";\nimport useWindowSize from 'react-use/lib/useWindowSize';\nimport Confetti from 'react-confetti';\nimport {useToasts} from \"react-toast-notifications\";\n\n\n\nfunction ChatPanel({InGameAction,chatData,setChats}) {\n\n    const {chatIndex,isIOS} = useContext(MainChatWindowContext);\n    const { width, height } = useWindowSize();\n    const[showConfetti,setShowConfetti] = useState(false);\n    const {addToast } = useToasts();\n\n\n    const acceptGame = (message,indexToRemove)=> {\n        const gameName = CheckForInvite(message.message).gameName.trim();\n        //delete invitation message\n        if(!chatData.game.name){\n            setChats(oldchats => {\n                let newChats = [...oldchats];\n                newChats[chatIndex].msg.splice(indexToRemove, 1);\n                let game = newChats[chatIndex].game;\n                game.name = gameName;\n                switch(gameName){\n                    case GAMES[0].name:\n                        game.board =  [  ['', '', ''], ['', '', ''], ['', '', '']];\n                        game.currentPlayer = 'X';\n                        game.myMark = 'O';\n                        break;\n                    default:\n                        break;\n                }\n                game.winner = '';\n                InGameAction(GAMEACTIONS[0],game);\n                return newChats;\n            });\n        }\n        else addToast('Close your current game!', {appearance: 'warning', autoDismiss: true});\n    };\n    const finishGame = (surrender)=>{\n        if(surrender) InGameAction(GAMEACTIONS[1],{surrender});\n        setChats(oldchats => {\n            let newChats = [...oldchats];\n            newChats[chatIndex].game = {};\n            return newChats;\n        })\n    };\n    useEffect(()=>{\n        ScrollChatToBottom();\n        },[]);\n    \n    useEffect(()=>{\n        // different condition will be applied based on chatData.game\n        if(chatData.game.winner && chatData.game.winner !== '-1'){\n            if(chatData.game.currentPlayer === chatData.game.myMark) {\n                setShowConfetti(true);\n                setTimeout(() => setShowConfetti(false), 5000);\n            }\n        }\n    },[chatData.game,chatData.game.winner]);\n    \n    return (\n        <div className='overflow-hidden flex flex-column'>\n            {chatData.game.name ?\n                <Paper className={'game-window pa2 shadow-5 animated  fadeIn slow '} >\n                    <h3>{chatData.game.name}</h3>\n                    {showConfetti ?<Confetti width={width} height={height}/> :<div/>}\n                    <div >\n                        {\n                            {\n                                'Tic-Tac-Toe': <TicTacToeGame setChats={setChats} inGameAction={InGameAction}/>,\n                            }[chatData.game.name.trim()]\n                        }\n                    </div>\n                    {\n                        chatData.game.winner\n                            ?<Button className={'tc'} variant={'primary'} onClick={()=>finishGame(false)}>Close</Button>\n                            :<Button className={'tc'} variant={'danger'} onClick={()=>finishGame(true)}>SURRENDER</Button>\n                    }\n                </Paper>\n                :<div/>\n            }\n            <ul className={'chat-panel'}>\n                {\n                    chatData.msg.map((message,i)=>(\n                    <li key ={i} className= {message.id === 0 ? 'me' : 'him' }>\n                        <div className={'messsage-text'}>\n                            {CheckForInvite(message.message).text}\n                            <span className='underline pointer blue' onClick={()=>acceptGame(message,i)}>{CheckForInvite(message.message).gameName}</span>\n                         </div>\n                    </li>\n                ))\n            }\n            </ul>\n        </div>\n    );\n\n\n}\nexport default ChatPanel;","import React, {useContext, useEffect, useState} from 'react';\nimport Input from \"../InputField/Input\";\nimport './Chat.css';\nimport {MainChatWindowContext} from \"../MainChatAppWindow/MainChatAppWindow\";\nimport {Button as BootstrapButton} from \"react-bootstrap\";\nimport ChatPanel from \"./Panel/ChatPanel\";\nimport {CalculateScrollDistance, ScrollChatToBottom} from \"../../Helpers/Scroller\";\n\n\n\nfunction ChatWindow({InGameAction,setChats,chatData,onSend,loadTen,GoBack}) {\n\n    const {chatId,chatIndex,isMobile} = useContext(MainChatWindowContext);\n    const[scrollPercentage,setScrollPercentage] = useState(100);\n\n    useEffect(()=>{\n        listenToScrollEvent();\n    },[]);\n\n\n    const LoadMoreMessages = (event) => {\n        loadTen(chatId,chatIndex,false);\n        setScrollPercentage(CalculateScrollDistance());\n    };\n\n    const listenToScrollEvent = () => {\n        document.getElementsByClassName(\"chat-panel\")[0].addEventListener(\"scroll\", () => {\n            requestAnimationFrame(() => {\n                setScrollPercentage(CalculateScrollDistance());\n            });\n        });\n    };\n    return (\n            <div id = {'chat-side'}>\n                {\n                    isMobile\n                        ? <div className=\"container\">\n                            <div className=\"row header\">\n                                <BootstrapButton type=\"button\" variant='secondary' className=\"col-2 arrow-back \"\n                                                 onClick={() => GoBack('left')}>\n                                        <span className=\"btn-label\">\n                                            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\"\n                                                 viewBox=\"0 0 24 24\">\n                                            <path fill=\"none\" d=\"M0 0h24v24H0V0z\"/>\n                                            <path d=\"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z\"/>\n                                            </svg>\n                                        </span>\n                                    Back\n                                </BootstrapButton>\n                                <div className='white tc col-10' style={{backgroundColor: '#6c757d'}}>\n                                    <strong className='black'>{chatData.name}</strong> is<span\n                                    className={chatData.isOnline ? 'dark-blue' : 'white'}> {chatData.isOnline ? ' online' : ' offline'}</span>\n\n                                    <h5 className='hover-bg-white-40 pointer' onClick={LoadMoreMessages}>\n                                        Load more messages\n                                    </h5>\n                                </div>\n                            </div>\n                        </div>\n                        :\n                        <h4 className='white tc hover-bg-white-40 pointer col-10 flex-none align-self-center' onClick={LoadMoreMessages}>\n                            Load more\n                        </h4>\n                }\n                {\n                    <ChatPanel\n                        InGameAction = {InGameAction}\n                        setChats={setChats}\n                        chatData={chatData}>\n                    </ChatPanel>\n                }\n                {(scrollPercentage <= 55)\n                    ?<div>\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24\" viewBox=\"0 0 24 24\" width=\"24\" className='down-btn' onClick={()=> ScrollChatToBottom()}>\n                            <path d=\"M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z\"/>\n                            <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n                        </svg>\n                    </div>\n                    :<div/>\n                }\n                <footer className={'footer-d'}>\n                    <Input onSendClick={onSend}/>\n                </footer>\n            </div>\n    );\n}\nexport default ChatWindow;\n","import React, {useContext} from 'react';\nimport ChatWindow from \"../../ChatWindow/ChatWindow\";\nimport {MainChatWindowContext} from \"../MainChatAppWindow\";\nimport {UserChatsContext} from \"../../../App\";\n\nexport default function ChatSide({InGameAction,setChats,LoadTenMessages,SendMessage,GoBack}) {\n\n    const {chats} = useContext(UserChatsContext);\n    const {chatIndex,isMobile} = useContext(MainChatWindowContext);\n\n    return (\n        <div className={ isMobile ? 'right-side col-12' :'right-side col-8 col-sm-8 col-md-8 col-lg-10 col-xl-10 '}>\n            <div className='overflow-hidden'>\n                <div className=\"container\">\n                    <div className=\"row\">\n                        {chatIndex === -1\n                            ?\n                                chats.length !== 0\n                                    ?\n                                    <div className='tc center col align-self-center'\n                                       id={'idle-msg'}>{'Click on a chat to start messaging!'}\n                                    </div>\n                                    :\n                                    <div className='tc center col align-self-center'\n                                         id={'idle-msg'}>{'Click on a button in top left corner and add someone!'}\n                                    </div>\n                            : <div className='col'>\n                                <ChatWindow InGameAction={InGameAction} setChats={setChats} loadTen={LoadTenMessages} chatData={chats[chatIndex]} onSend={SendMessage} GoBack = {GoBack}/>\n                            </div>\n                        }\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n}\n","import React, {useEffect, useState} from \"react\";\nimport notification from '../../sounds/notification.mp3';\nimport Sound from 'react-sound';\n\n\nexport  function NewChat({name,sound}) {\n    return (\n        <div>\n            <strong>New chat!</strong>\n            <div>\n                <strong>{name}</strong> created a chat with you!\n            </div>\n            {sound\n                ?<Sound url= {notification} autoLoad={true} playStatus={Sound.status.PLAYING}/>\n                :<div/>\n            }\n        </div>\n    );\n}\nexport  function NewMessage({name,body,sound}) {\n    return (\n        <div>\n            <strong>{name}</strong>\n            <div>\n                {body}\n            </div>\n            {sound\n                ?<Sound url= {notification} autoLoad={true} playStatus={Sound.status.PLAYING}/>\n                :<div/>\n            }\n        </div>\n    );\n}\nexport  function GameInviteSent({failed,sound}) {\n    return (\n        <div>\n            <strong>Game BOT</strong>\n            <div>\n                {failed\n                    ?<div> Your invitation was <strong>NOT</strong> sent!<br/>\n                        <strong>Please finish current game first!!1!</strong></div>\n                    :<div>\n                        Your invitation was sent!<br/>\n                        <strong>If your friend is offline he won't get it!</strong>\n                    </div>\n                }\n\n            </div>\n            {sound\n                ?<Sound url= {notification} autoLoad={true} playStatus={Sound.status.PLAYING}/>\n                :<div/>\n            }\n        </div>\n    );\n}\n\n\nexport  function OnlineOrOffline({online,sound}) {\n\n    return (\n        <div>\n            <strong>Connection status changed!</strong>\n            <div>\n                { online ? 'You are online now':'You went offline, your messages will not be sent!' }\n            </div>\n            {\n                !online?\n                    <div>\n                        We will try to reconnect you!\n                    </div>\n                    :\n                    <div/>\n            }\n            {sound\n                ?<Sound url= {notification} autoLoad={true} playStatus={Sound.status.PLAYING}/>\n                :<div/>\n            }\n        </div>\n    );\n}\nexport  function ReconnectFail({isLast,nextTime,sound}) {\n\n    const[timer,setTimer] = useState(nextTime);\n\n\n    useEffect(()=>{\n        const interval = setInterval(() => setTimer(timer-1), 1000);\n        return function cleanup() {\n            clearInterval(interval);\n        }},[timer]\n    );\n    return (\n        <div>\n            <strong>Reconnection failed!</strong>\n            <div>\n                { isLast ? 'Failed to reconnect, please reload the page or try again later.':`We will try again in ${timer} seconds.` }\n            </div>\n            {sound\n                ? <Sound url= {notification} autoLoad={true} playStatus={Sound.status.PLAYING}/>\n                :<div/>\n            }\n\n        </div>\n    );\n}\n\n","import {CheckForInvite, CheckIfChatIdMatchIsPresent, FindChatIndexByChatId} from \"./ProcessData\";\nimport {AESIV, AESKEY, BackendLink} from \"../Constants/Const\";\nimport {NewChat, NewMessage, OnlineOrOffline, ReconnectFail} from \"../Components/Notifications/Notifications\";\nimport React from \"react\";\nimport {MessageIF} from \"../Components/ChatWindow/Message/MessageIF\";\nimport * as signalR from \"@microsoft/signalr\";\nimport {CalculateScrollDistance, ScrollChatToBottom} from \"./Scroller\";\nimport {GAMEACTIONS} from \"../Components/Games/GamesList\";\n\nconst CryptoJS = require(\"crypto-js\");\n\n\n//very very hacky\nexport async function CreateMainHubConnection (setUser, setChats, setHub, PopupNotification, setChatIndex, setChatId) {\n\n    const hubConnect = new signalR.HubConnectionBuilder()\n        .withUrl(`${BackendLink}/chat`)\n        .build();\n\n    // my fav hack\n    let loc_user = hackUser(setUser);\n\n    if(!loc_user) return;\n\n    try {\n        await hubConnect.start();\n\n        //show others u went online\n        await hubConnect.invoke('UserWentOfflineOrOnline',true,loc_user.userId,hubConnect.connectionId);\n\n        const {sound,connectionChanged} = loc_user.notificationSettings;\n\n        if(connectionChanged) PopupNotification(<OnlineOrOffline online = {true} sound={sound}/>,'success',3000);\n\n        //after socket dies, it sends a request to put user offline in the db\n        hubConnect.onclose(() => {\n            // need to use this hack again :((\n            let l_user = hackUser(setUser);\n            // if user still exists -> show notification that he is offline else he logged out and try to reconnect\n                if (l_user) {\n                    const {sound,connectionChanged} = l_user.notificationSettings;\n                    if(connectionChanged) PopupNotification(<OnlineOrOffline sound={sound} online={false}/>, 'warning', 3000);\n                    Reconnect(0,hubConnect,setHub,PopupNotification,l_user.notificationSettings)\n                        .then(()=>{\n                                //TODO load messages that were missed and add to state instead of discarding all && Check online statuses of friends\n                                //discard all chats, load them on next click\n                                setChatIndex(-1);\n                                setChats(oldChats=>{\n                                    let newChats = [...oldChats];\n                                    newChats.forEach(chat=>{\n                                        chat.msg = [];\n                                        chat.lastMessagesAreFetched = false;\n                                    });\n                                    return newChats;\n                                })\n                            })\n                        .catch(err=>console.log(err));\n                   }}\n                );\n        hubConnect.on('sendDirectMessage', (userId,chatId,messageText)=>{\n            //can't move the insides of to a different method -> it crashes\n\n            let decrypted =  CryptoJS.AES.decrypt(messageText,\n                CryptoJS.enc.Base64.parse(AESKEY),\n                {iv:CryptoJS.enc.Base64.parse(AESIV) });\n\n            messageText = CryptoJS.enc.Utf8.stringify(decrypted);\n\n            // need to use this hack again :((\n            let l_user = hackUser(setUser);\n            const {sound,newMessageReceived} = l_user.notificationSettings;\n            setChats(prevState => {\n                // index where the chat is located for current client\n                const neededChatIndex = FindChatIndexByChatId(chatId,prevState);\n                // update state if the user has chat with this id\n                if(neededChatIndex !== -1 && l_user.userId !== userId){\n                    let updatedChats = Object.assign([],prevState);\n                    updatedChats[neededChatIndex].msg.push(new MessageIF({id:1,message:messageText}));\n                    updatedChats[neededChatIndex].isOnline = true;\n\n                    if (newMessageReceived) PopupNotification(<NewMessage sound={sound} name={ updatedChats[neededChatIndex].name} body={CheckForInvite(messageText,true)}/>,'info',5000);\n\n                    const neededChat = updatedChats[neededChatIndex];\n                    updatedChats.splice(neededChatIndex, 1);\n                    updatedChats.unshift(neededChat);\n                    let id;\n                    setChatId(prev=>{\n                        id = prev;\n                        return prev;\n                    });\n                    if(id === chatId){\n                        const dist = CalculateScrollDistance();\n                        if(neededChat.msg.length < 15 || dist > 55) ScrollChatToBottom();\n                    }\n                    setChatIndex(FindChatIndexByChatId(id, updatedChats));\n                    return updatedChats;\n                }\n                else{\n                    return prevState;\n                }\n            })\n        });\n\n        //check if user who came online is not you -> update state\n        hubConnect.on('UserWentOfflineOrOnline',(online,userId,chatIds)=> {\n            setChats(chats=>{\n                let updatedChats = Object.assign([],chats);\n                if(userId !== loc_user.userId){\n                    const checkMatch = CheckIfChatIdMatchIsPresent(chats,chatIds);\n                    if(checkMatch.found){\n                        let index = FindChatIndexByChatId(checkMatch.id,chats);\n                        //put user online/offline depending on that invoke parameter\n                        updatedChats[index].isOnline = online;\n                        if(!online && updatedChats[index].game.name && !updatedChats[index].game.winner){\n                            PopupNotification(`${updatedChats[index].name} went offline! \\n YOU WON your game! `,'success',5000);\n                            updatedChats[index].game = {};\n                        }\n                    }\n                }\n                return updatedChats;\n            })\n        });\n\n        hubConnect.on('UserDataChanged',(userId,userChatIds,type,value)=>{\n           if(loc_user.userId !== userId){\n               setChats(chats=> {\n                   let updatedChats = [...chats];\n                   const checkMatch = CheckIfChatIdMatchIsPresent(chats, userChatIds);\n                   if (checkMatch.found) {\n                       let index = FindChatIndexByChatId(checkMatch.id, chats);\n                       const neededChat = updatedChats[index];\n                       neededChat[type] = value;\n                   }\n               return updatedChats;\n               });\n           }\n        });\n        //when getCHat is received add an empty chat\n        hubConnect.on('getChat', (userId,chat)=>{\n            let l_user = hackUser(setUser);\n            if(loc_user.userId === userId){\n                setChats(prev=>{\n                    let updatedChat = Object.assign([],prev);\n                    updatedChat.push({id:chat.chatId,image:chat.image,isOnline:true,name:chat.chatName,msg:[],game:{}});\n                    return Object.assign([],updatedChat);\n                });\n            const {sound,newChatReceived} = l_user.notificationSettings;\n            if(newChatReceived) PopupNotification(<NewChat name={chat.chatName} sound={sound}/>,'info',5000);\n        }});\n\n        hubConnect.on(GAMEACTIONS[0],(userId,chatId,data)=>{\n            let l_user = hackUser(setUser);\n            setChats(prevState => {\n                // index where the chat is located for current client\n                const neededChatIndex = FindChatIndexByChatId(chatId,prevState);\n                // update state if the user has chat with this id\n                if(neededChatIndex !== -1 && l_user.userId !== userId) {\n                    let updatedChats = Object.assign([],prevState);\n                    // here switch action based on game name\n                    data.myMark = 'X';\n                    updatedChats[neededChatIndex].game = data;\n                    return updatedChats;\n                }\n                return prevState;\n            });\n            ScrollChatToBottom();\n        });\n        hubConnect.on(GAMEACTIONS[1],(userId,chatId,data)=>{\n            let l_user = hackUser(setUser);\n            setChats(prevState => {\n                // index where the chat is located for current client\n                const neededChatIndex = FindChatIndexByChatId(chatId,prevState);\n                // update state if the user has chat with this id\n                if(neededChatIndex !== -1 && l_user.userId !== userId) {\n                    let updatedChats = Object.assign([],prevState);\n                    if(data.surrender){\n                        PopupNotification(`YOU WON your game against ${updatedChats[neededChatIndex].name}! `,'success',5000);\n                        updatedChats[neededChatIndex].game = {};\n                    }\n                    else if (data.draw)PopupNotification(`DRAW against ${updatedChats[neededChatIndex].name}! `,'info',5000);\n                    else PopupNotification(`YOU LOST your game against ${updatedChats[neededChatIndex].name}! `,'error',5000);\n                    return updatedChats;\n                }\n                return prevState;\n            });\n        });\n        hubConnect.on(GAMEACTIONS[2],(userId,chatId,data)=>{\n            let l_user = hackUser(setUser);\n            setChats(prevState => {\n                // index where the chat is located for current client\n                const neededChatIndex = FindChatIndexByChatId(chatId,prevState);\n                // update state if the user has chat with this id\n                if(neededChatIndex !== -1 && l_user.userId !== userId) {\n                    let updatedChats = Object.assign([],prevState);\n                    let game = updatedChats[neededChatIndex].game;\n                    // here switch action based on game name\n                    game.board = data.board;\n                    game.winner = data.winner;\n                    game.currentPlayer = data.currentPlayer;\n                    return updatedChats;\n                }\n                return prevState;\n            });\n        })\n    }\n    // if user logged in but didnt connect to webSocket after\n    catch (err) {\n        console.log(err);\n        PopupNotification(<OnlineOrOffline online={false}/>, 'warning', 3000);\n        Reconnect(0,hubConnect,setHub,PopupNotification,loc_user.notificationSettings);\n    }\n    return hubConnect;\n}\n// function that tries to connect to socket every x,2x,3x,4x seconds after which it stops\nasync function Reconnect (time,hubConnect,setHub,PopupNotification,userNotificationSettings) {\n    let timeout = 3000;\n    const {sound,connectionChanged} = userNotificationSettings;\n    setTimeout(()=>{\n        hubConnect.start()\n            .then(()=>{\n                setHub(hubConnect);\n                if(connectionChanged) PopupNotification(<OnlineOrOffline online = {true} sound={sound}/>,'success',4000);\n                return new Promise((resolve,reject) => resolve(true));\n            })\n            .catch(()=>{\n                if(time < 4) {\n                    if(connectionChanged) PopupNotification(<ReconnectFail sound={sound} nextTime={timeout * (time+1) / 1000} isLast={false}/>,'warning',timeout * (time+1));\n                    Reconnect(time+1,hubConnect,setHub,PopupNotification,userNotificationSettings);\n                }\n                else {\n                    PopupNotification(<ReconnectFail isLast={true}/>,'error',70000);\n                    return false;\n                }\n            });\n    },timeout * time);\n}\n\nfunction hackUser(setUser){\n    let l_user;\n    setUser(prev=>{\n        l_user = prev;\n        return prev;\n    });\n    return l_user;\n}\n\n\n","import React,{useState,useEffect,useContext} from 'react';\nimport {Redirect } from \"react-router-dom\";\nimport {UserChatsContext} from \"../../App\";\nimport SwitchToMobileModal from \"./Modals/SwitchToMobileModal\";\nimport '../../App.css';\nimport witcher from '../../sounds/lol.mp3';\nimport drStone from '../../sounds/dr_stone_ending.mp3';\nimport {AddTenMessagesToState} from \"../../Helpers/ProcessData\";\nimport useMobileDetect from 'use-mobile-detect-hook';\nimport FriendsSide from \"./SubWindows/ScreenWithFriends\";\nimport ChatSide from \"./SubWindows/ScreenWithChats\";\nimport {CreateMainHubConnection} from \"../../Helpers/HubConnection\";\nimport {useToasts} from \"react-toast-notifications\";\nimport {useCookies} from 'react-cookie';\nimport {ScrollChatToBottom} from \"../../Helpers/Scroller\";\nimport {GameInviteSent} from \"../Notifications/Notifications\";\nimport {gapi} from \"gapi-script\";\nimport {AESIV, AESKEY} from \"../../Constants/Const\";\nimport {MessageIF} from \"../ChatWindow/Message/MessageIF\";\nimport {GAMEACTIONS} from \"../Games/GamesList\";\n\nconst CryptoJS = require(\"crypto-js\");\n\nexport const MainChatWindowContext = React.createContext({chatId:null,chatIndex:null,isMobile:false,isIOS:false});\n\nconst MainChatAppWindow =({setChats,setUser})=> {\n\n    const {user,chats} = useContext(UserChatsContext);\n    const detectMobile = useMobileDetect();\n    const {addToast,removeToast} = useToasts();\n\n    const[hubConnection,setHubConnection] = useState(null);\n    const[chatId,setChatId] = useState(-1);\n    const[chatIndex,setChatIndex] = useState(-1);\n    const[song,setSong] = useState(null);\n    const[redirect,setRedirect] = useState(false);\n    const[isMobile,setIsMobile] = useState(false);\n    const[isIOS,setIsIOS] = useState(false);\n    const[partToShow,setPartToShow] = useState('left');\n    const [cookies,setCookie,removeCookie] = useCookies(['userToken']);\n\n\n    useEffect( ()=>{\n        setIsMobile(detectMobile.isMobile());\n        CreateMainHubConnection(setUser,setChats,setHubConnection,PopUpNotification,setChatIndex,setChatId)\n                .then(hub=> setHubConnection(hub));\n        setIsIOS(detectMobile.isIos());\n    },[]);\n\n\n    useEffect(()=>{\n        if(!user) setRedirect(true);\n    }, [detectMobile, user]);\n\n    //Add toast with desired style and content, remove it after the timeout\n    const PopUpNotification = (content,appearance,removeTimer) =>{\n        addToast(content, {appearance: appearance, autoDismiss: false,}, (id)=> {\n                // if timer is more then a minute just keep it there forever, else destroy after timeout\n                if (removeTimer < 60000) setTimeout(() => removeToast(id), removeTimer);\n            }\n        );\n    };\n    const setSongMP3 = (songname) =>{\n        switch (songname) {\n            case 'witcher':\n                return witcher;\n            case 'drStone':\n                return drStone;\n            default:\n                return;\n        }\n    };\n\n\n    const CreateNewChat = (chatId,chatName,friendImageUrl) => {\n        hubConnection.invoke('ChatWithUserWasCreated',user.userId,chatId,{chatId,chatName:user.userName,image:user.imageUrl});\n        setChats(prevState => {\n            let updatedChat = Object.assign([],prevState);\n            updatedChat.push({id:chatId,image:friendImageUrl,name:chatName,msg:[],game:{}});\n            return updatedChat;\n        })\n    };\n\n    const UpdateUserData = (type,value) =>{\n      setUser(user=>{\n          let newUser = {...user};\n          switch (type) {\n              case 'image':\n                  newUser.imageUrl = value;\n                  break;\n              case 'name':\n                  newUser.userName = value;\n                  break;\n              case 'notifications':\n                  newUser.notificationSettings = value;\n                  break;\n              default:\n                  break;\n          }\n          return newUser;\n      });\n      if(type !== 'notifications'){\n          hubConnection.invoke('UserDataChanged',user.userId,type,value);\n      }\n      removeCookie('userToken');\n    };\n\n    //Fetches the messages and updates the state of chats\n    const LoadTenMessages = (id,index,shouldSetChatId) =>{\n\n        // if should set chat id => method was called when clicking on a chat on the left, else from a chat itself\n        if(shouldSetChatId) setChatId(id);\n\n        let currentChatsState = [...chats];\n        // works as a pointer (e.g changing this object will change it in the array as well)\n        let currentChat = currentChatsState[index];\n\n        //if there are more than 10 messages in the chat already, don't load new on first click\n        if(!currentChat.lastMessagesAreFetched && currentChat.msg.length > 10) currentChat.lastMessagesAreFetched = true;\n\n        //fetch only if it is first click on chat or when more messages are requested from chat + chat has more than 10 messages already\n        if(!currentChat.lastMessagesAreFetched || (!shouldSetChatId && currentChat.msg.length > 10)) {\n            const numberOfMessages = currentChat.msg.length;\n            const shouldScrollUp = currentChat.lastMessagesAreFetched;\n            const chatWindow = document.getElementsByClassName(\"chat-panel\")[0];\n            AddTenMessagesToState(id,user,currentChat)\n                .then(newState => {\n                    // if anything has changed, update and scroll\n                    if(numberOfMessages !== newState.msg.length){\n                        setChats(currentChatsState);\n                        if(shouldScrollUp) chatWindow.scrollTop = 0;\n                        else ScrollChatToBottom();\n                    }\n                })\n                .catch(err => {\n                    console.log(err);\n                    alert('error loading messages');\n                });\n        }\n    };\n\n    //Function that uses a closure(google it)\n    //after determining chat data, renders a new message + sends it to the server on the next invoke\n    const SendMessage = (chatId,chatIndex) => {\n        let l_chatIndex = chatIndex;\n        let l_chatId = chatId;\n        //invoke 'sendMessage' with chatId most likely\n        return function (msgText,isInvite = false) {\n            let ciphertext = CryptoJS.AES.encrypt(msgText,\n                CryptoJS.enc.Base64.parse(AESKEY),\n                {iv:CryptoJS.enc.Base64.parse(AESIV) }).toString();\n\n            hubConnection.invoke('SendDirectMessage',user.userId,l_chatId,ciphertext,isInvite).catch(err=>console.log(err));\n\n            if(!isInvite) {\n                setChats(prevState => {\n                    let updatedChats = Object.assign([], prevState);\n                    const neededChat = updatedChats[l_chatIndex];\n                    neededChat.msg.push(new MessageIF({id: 0, message: msgText, dateTime: new Date()}));\n\n                    updatedChats.splice(l_chatIndex, 1);\n                    updatedChats.unshift(neededChat);\n                    return updatedChats;\n                });\n                setTimeout(()=>{\n                    ScrollChatToBottom();\n                },20);\n            }\n\n        };\n    };\n    const updAudio = (enable) => {\n        const a = document.getElementsByTagName(\"audio\")[0];\n        enable ? a.play() : a.pause();\n    };\n\n    const setChatOnMobile = (index) =>{\n        setChatIndex(index);\n        setPartToShow('right');\n    };\n\n    const SendMessageAndSetIndex = (text,isInvite = false) =>{\n        //triggering closure\n      const SendMessageWithChatData = SendMessage(chatId,chatIndex);\n      const gameExists = Boolean(chats[chatIndex].game.name);\n      // if it is legal to send a message do it\n      if(!isInvite || (isInvite && !gameExists))SendMessageWithChatData(text,isInvite);\n      // if it is a game invite\n      if(isInvite) {\n          if(gameExists) PopUpNotification(<GameInviteSent failed ={true} sound={user.notificationSettings.sound}/>,'info',5000);\n          else PopUpNotification(<GameInviteSent failed ={false} sound={user.notificationSettings.sound}/>,'info',5000);\n      }else{\n          setChatIndex(0);\n      }\n    };\n\n    const logout = () => {\n        setUser(null);\n        hubConnection.stop();\n        setHubConnection(null);\n        TryToDoGoogleLogout();\n        removeCookie('userToken');\n    };\n\n    const TryToDoGoogleLogout= () => {\n        try{\n            const auth2 = gapi.auth2.getAuthInstance();\n            auth2.signOut().then(auth2.disconnect());\n        }\n        catch (e) {console.log('Not a googler!')}\n    };\n\n    const InGameAction = (action,data) => {\n        switch (action) {\n            //surrender\n            case GAMEACTIONS[1]:\n                if(data.surrender)PopUpNotification(`YOU LOST your game against  ${chats[chatIndex].name}! `,'error',5000);\n                else if(data.draw)PopUpNotification(`DRAW against  ${chats[chatIndex].name}! `,'info',5000);\n                else PopUpNotification(`YOU WON your game against ${chats[chatIndex].name}!`,'success',5000);\n                break;\n            //start\n            case GAMEACTIONS[0]:\n                ScrollChatToBottom();\n                break;\n            default:\n                break;\n        }\n        hubConnection.invoke(action,user.userId,chatId,data)\n    };\n\n    return (\n        <>\n            <MainChatWindowContext.Provider value = {{chatId,chatIndex,isMobile,isIOS}} >\n                {redirect\n                    ? <Redirect to ={'/'}/>\n                    : <div className=\"row\">\n                        <audio src={setSongMP3(song)} preload={'true'} loop/>\n                        {isMobile\n                            ?\n                            partToShow === 'left'\n                                ?<FriendsSide LoadTenMessages={LoadTenMessages} createNewChat={CreateNewChat} logout={logout} setChatIndex={setChatOnMobile} setSong={setSong} updAudio={updAudio} UpdateUserData={UpdateUserData}/>\n                                :<ChatSide InGameAction={InGameAction} setChats={setChats} LoadTenMessages={LoadTenMessages} SendMessage={SendMessageAndSetIndex} GoBack = {setPartToShow} />\n                            : <>\n                                <FriendsSide LoadTenMessages={LoadTenMessages} createNewChat={CreateNewChat} logout={logout} setChatIndex={setChatIndex} setSong={setSong} updAudio={updAudio} UpdateUserData={UpdateUserData}/>\n                                <ChatSide InGameAction={InGameAction} setChats={setChats} LoadTenMessages={LoadTenMessages} SendMessage={SendMessageAndSetIndex} />\n                            </>\n                        }\n                    </div>\n                }\n            </MainChatWindowContext.Provider>\n        </>\n    );\n};\nexport default MainChatAppWindow;\n","import React, {useEffect, useState} from \"react\";\nimport { Button, FormGroup, FormControl } from \"react-bootstrap\";\nimport '../Login.css';\nimport FormLabel from \"react-bootstrap/FormLabel\";\nimport Card from \"react-bootstrap/Card\";\nimport Spinner from \"react-bootstrap/Spinner\";\n\n\nimport {\nRedirect\n} from \"react-router-dom\";\nimport jwt from \"jsonwebtoken\";\nimport {TokenSignature} from \"../../../Constants/Const\";\n\nexport default function Login({loginOrRegister}) {\n\n    const [email, setEmail] = useState(\"\");\n    const [error, setError] = useState(\"\");\n    const [password, setPassword] = useState(\"\");\n    const [isConnecting, setIsConnecting] = useState(false);\n    const [success,setSuccess] = useState(false);\n\n\n    function validateForm() {\n        return email.length > 0 && password.length > 0;\n    }\n\n    async function handleSubmit(event) {\n        event.preventDefault();\n        await handleLogin('login');\n    }\n\n    async function handleLogin (endpoint,token){\n        setIsConnecting(true);\n        setTimeout(()=>console.log(),1000);\n        try {\n            const param = endpoint === 'login' ? {email, password} : {token};\n            let loginStatus = await loginOrRegister(param,endpoint);\n            if(loginStatus === 'duplicate'){\n                throw new Error('Please finish another session before starting a new one.');\n            }\n            setSuccess(true);\n        }\n        catch(error) {\n            setTimeout(() => {\n                setIsConnecting(false);\n                if(error.toString().includes('Failed to fetch')){\n                    setError('No response from the server')\n                }else {\n                    setError(error.message);\n                }\n            }, 1000);\n        }\n    }\n    useEffect(()=>{\n        const pwaAuth = document.querySelector(\"pwa-auth\");\n        pwaAuth.addEventListener(\"signin-completed\", ev => {\n            const signIn = ev.detail;\n            if (signIn.error) {\n                setError(`Failed to login with ${signIn.provider}`);\n            } else {\n                console.log(signIn);\n                let token = jwt.sign({email:signIn.email,name:signIn.name.split(' ')[0],imageUrl:signIn.imageUrl}, TokenSignature);\n                handleLogin('google',token);\n            }\n        });\n    },[]);\n    return (\n        <>\n        {success\n            ? <Redirect to={'/app'}/>\n            : <Card className=\"Login\">\n                <Card.Header> Sign In </Card.Header>\n                <Card.Body>\n                    <form onSubmit={handleSubmit}>\n                        <FormGroup controlId=\"email\">\n                            <FormLabel>Email</FormLabel>\n                            <FormControl\n                                autoFocus\n                                type=\"email\"\n                                value={email}\n                                onChange={e => setEmail(e.target.value)}\n                            />\n                        </FormGroup>\n                        <FormGroup controlId=\"password\">\n                            <FormLabel>Password</FormLabel>\n                            <FormControl\n                                value={password}\n                                onChange={e => setPassword(e.target.value)}\n                                type=\"password\"\n                            />\n                        </FormGroup>\n                        {error\n                            ? <FormGroup>\n                                <div className='tc dark-red'>{error}</div>\n                            </FormGroup>\n                            : <></>\n                        }\n\n                        <FormGroup className='tc'>\n                            <a className='tc' href={'/rocket-chat-front/#/register'}>Not signed up yet?</a>\n                            <div style={{marginTop:'15px'}}>\n                                <pwa-auth appearance=\"list\"\n                                          credentialmode=\"prompt\"\n                                          microsoftkey= {process.env.REACT_APP_MICROSOFT_ID}\n                                          googlekey={process.env.REACT_APP_GOOGLE_ID}\n                                          facebookkey={process.env.REACT_APP_FB_ID}\n                                >\n                                </pwa-auth>\n\n                            </div>\n                        </FormGroup>\n                        <Button block variant={!validateForm() ? 'secondary' : \"primary\"}\n                                disabled={!validateForm() || isConnecting} type=\"submit\">\n                            {!isConnecting\n                                ? 'Login'\n                                : <Spinner\n                                    as=\"span\"\n                                    animation=\"border\"\n                                    size=\"sm\"\n                                    role=\"status\"\n                                    aria-hidden=\"true\"\n                                />\n                            }\n                        </Button>\n                    </form>\n                </Card.Body>\n            </Card>\n        }\n</>\n    );\n}","import React, { useState } from \"react\";\nimport { Button, FormGroup, FormControl } from \"react-bootstrap\";\nimport '../Login.css';\nimport FormLabel from \"react-bootstrap/FormLabel\";\nimport Card from \"react-bootstrap/Card\";\nimport Spinner from \"react-bootstrap/Spinner\";\nimport {Redirect} from \"react-router-dom\";\nimport {PasswordStrLevels} from \"../../../Constants/Const\";\nimport swal from \"sweetalert\";\n\nexport default function Register({loginOrRegister}) {\n\n    const [email, setEmail] = useState(\"\");\n    const [name, setName] = useState(\"\");\n    const [password, setPassword] = useState(\"\");\n    const [isConnecting, setIsConnecting] = useState(false);\n    const [error, setError] = useState(\"\");\n    const [success,setSuccess] = useState(false);\n    const [passwordStrength,setPasswordStrength] = useState(0);\n\n\n    function validateForm() {\n        return email.length > 0 && passwordStrength > 2 && name.length;\n    }\n\n    async function handleSubmit(event) {\n        event.preventDefault();\n\n        setIsConnecting(true);\n        setTimeout(()=>console.log(),1000);\n        try {\n            await loginOrRegister({username:name,email, password}, 'register');\n            setIsConnecting(false);\n            await swal(\"Almost there\", `We saved all your data, confirm your email to start using our app!`, \"success\");\n             (setSuccess(true));\n        }\n        catch(error) {\n            setTimeout(() => {\n                setIsConnecting(false);\n                if(error.toString().includes('Failed to fetch')){\n                    setError('No response from the server')\n                }else {\n                    setError(error.message);\n                }\n            }, 500);\n        }\n    }\n    const checkPassWordStrength = (event) =>{\n        let currentStr = 0;\n        let input = event.target.value;\n\n        if(input.length > 5) currentStr++;\n        if(input.length > 7) currentStr++;\n        //if has a number\n        if(input.match(/\\d+/g)) currentStr++;\n        //if has an uppercase\n        const low = input.toLowerCase();\n        if(low !== input) currentStr ++;\n\n        setPasswordStrength(currentStr);\n        setPassword(input);\n\n    };\n    return (\n        <>\n            {success\n                ? <Redirect to={'/login'}/>\n                : <Card className=\"Login\">\n                    <Card.Header> Register </Card.Header>\n                    <Card.Body>\n                        <form onSubmit={handleSubmit}>\n                            <FormGroup controlId='name'>\n                                <FormLabel>Name</FormLabel>\n                                <FormControl\n                                    autoFocus\n                                    type=\"text\"\n                                    value={name}\n                                    onChange={e => setName(e.target.value)}\n                                />\n                            </FormGroup>\n                            <FormGroup controlId=\"email\">\n                                <FormLabel>Email</FormLabel>\n                                <FormControl\n                                    autoFocus\n                                    type=\"email\"\n                                    value={email}\n                                    onChange={e => setEmail(e.target.value)}\n                                />\n                            </FormGroup>\n                            <FormGroup controlId=\"password\" >\n                                <FormLabel>Password</FormLabel>\n                                <FormControl\n                                    style = {{borderBottom: `3px solid ${PasswordStrLevels[passwordStrength].color}`}}\n                                    value={password}\n                                    onChange={checkPassWordStrength}\n                                    type=\"password\"\n                                />\n                            </FormGroup>\n                            {error\n                                ? <FormGroup>\n                                    <div className='tc dark-red'>{error}</div>\n                                </FormGroup>\n                                : <></>\n                            }\n                                <Button block variant={!validateForm() ? 'secondary' : \"primary\"}\n                                        disabled={!validateForm() || isConnecting} type=\"submit\">\n                                    {!isConnecting\n                                        ? 'Register'\n                                        : <Spinner\n                                            as=\"span\"\n                                            animation=\"border\"\n                                            size=\"sm\"\n                                            role=\"status\"\n                                            aria-hidden=\"true\"\n                                        />\n                                    }\n                                </Button>\n                        </form>\n                    </Card.Body>\n                </Card>\n            }\n            </>\n    );\n}","import React from 'react';\nimport Tab from \"react-bootstrap/Tab\";\nimport Row from \"react-bootstrap/Row\";\nimport Col from \"react-bootstrap/Col\";\nimport Nav from \"react-bootstrap/Nav\";\nimport {FAQDATA,RELEASEDATA} from \"../../../Constants/Const\";\n\nexport default function FAQorReleaseInfo({isFAQ}) {\n\n    return (\n        <div>\n            <Tab.Container id=\"left-tabs-example\" defaultActiveKey={isFAQ ? FAQDATA[0].question : RELEASEDATA[0].version }>\n                <Row className = 'bg-black-90 align-content-start'>\n                    <Col md={4} lg={4} xl={4} sm={12} xs={12} >\n                        <Nav variant='pills' className=\"flex-column b--solid b--light-blue\">\n                            { isFAQ\n                                ? FAQDATA.map((qa) =>(\n                                    <Nav.Item key = {qa.question}>\n                                        <Nav.Link  eventKey={qa.question}>{qa.question}</Nav.Link>\n                                    </Nav.Item>\n                                ))\n                                : RELEASEDATA.map((vc) =>(\n                                    <Nav.Item key = {vc.version}>\n                                        <Nav.Link  eventKey={vc.version}>{vc.version}</Nav.Link>\n                                    </Nav.Item>\n                                ))\n                            }\n                        </Nav>\n                    </Col>\n                    <Col sm={12} xs={12} md={8} xl={8} lg={8} >\n                        <Tab.Content className = 'white ma3'>\n                            {isFAQ\n                                ? FAQDATA.map((qa) =>(\n                                    <Tab.Pane eventKey={qa.question} key = {qa.answer}>\n                                        {qa.answer}\n                                    </Tab.Pane>\n                                ))\n                                :\n                                    RELEASEDATA.map((vc) => (\n                                        <Tab.Pane key = {vc.changes[0]} eventKey={vc.version}>\n                                            <ul>\n                                                {vc.changes.map(change=>(\n                                                    <li key = {change}>{change}</li>\n                                                ))}\n                                            </ul>\n                                        </Tab.Pane>\n                                    ))\n                                }\n                        </Tab.Content>\n                    </Col>\n                </Row>\n            </Tab.Container>\n        </div>\n    );\n}\n","import React, {useEffect, useState} from \"react\";\nimport '../Login.css';\nimport Card from \"react-bootstrap/Card\";\nimport {Redirect} from \"react-router-dom\";\n\nexport  function EmailedVerified({success}) {\n\n    const [redirect,setRedirect] = useState({done:false,time:4});\n\n    useEffect(()=>{\n        const interval = setInterval(() => {\n            let newVal = {...redirect};\n            if(redirect.time < 2){\n                newVal.done = true\n            }\n            newVal.time -=1;\n            setRedirect(newVal)\n        }, 1000);\n        return function cleanup() {\n            clearInterval(interval);\n        }},[redirect]\n    );\n\n    return (\n        <>\n            {redirect.done\n                ? <Redirect to={'/login'}/>\n                : <Card className=\"Login\">\n                    <Card.Header>Email verification</Card.Header>\n                    <Card.Body>\n                        {\n                            success\n                                ? <div>Your email was verified <span\n                                    className={'green'}>successfully</span> :)<br/> Redirecting you in {redirect.time}</div>\n                                : <div>Email verification <span className={'red'}>failed</span> :( <br/> Redirecting you\n                                    in {redirect.time} </div>\n                        }\n                    </Card.Body>\n                </Card>\n            }\n        </>\n    );\n};\n","import React, {useContext} from 'react';\nimport Navbar from \"react-bootstrap/Navbar\";\nimport Nav from \"react-bootstrap/Nav\";\nimport Login from \"./Submodules/Login\";\nimport Register from \"./Submodules/Register\";\nimport './welcome.css';\nimport LoadingOverlay from 'react-loading-overlay';\nimport FAQorReleaseInfo from \"./Submodules/FAQorReleaseInfo\";\nimport {EmailedVerified} from \"./Submodules/EmailVerification\";\nimport {UserChatsContext} from \"../../App\";\nimport swal from \"sweetalert\";\nimport useMobileDetect from \"use-mobile-detect-hook\";\nimport {RELEASEDATA} from \"../../Constants/Const\";\n\nfunction WelcomePage({loginOrRegister,path}) {\n\n    const {isLoading} = useContext(UserChatsContext);\n    const detectMobile = useMobileDetect();\n\n    const handleAddToHomescreenClick = () =>{\n        swal(`\n    1. Open Share menu on iOS or browser settings on Android\n    2. Tap on \"Add to Home Screen\" button`);\n    };\n\n    return (\n        <>\n            <LoadingOverlay\n                active={isLoading}\n                spinner\n                text='Loading your data'\n            >\n                <div className='welcome-page overflow-y-auto overflow-x-hidden' >\n                    <Navbar bg=\"dark\" variant={'dark'} expand=\"lg\">\n                        <Navbar.Brand href = {'/rocket-chat-front/#/login'} >Rocket-Chat {RELEASEDATA[0].version}</Navbar.Brand>\n                        <Navbar.Toggle aria-controls=\"basic-navbar-nav\" />\n                        <Navbar.Collapse id=\"basic-navbar-nav\">\n                            <Nav className=\"mr-auto \">\n                                <Nav.Link href = {'/rocket-chat-front/#/faq'}>FAQ</Nav.Link>\n                                <Nav.Link href = {'/rocket-chat-front/#/release'}>Release notes</Nav.Link>\n                            </Nav>\n                            <Nav>\n                                <Nav.Link href = {'/rocket-chat-front/#/login'}>Sign in</Nav.Link>\n                                <Nav.Link href = {'/rocket-chat-front/#/register'}>Register</Nav.Link>\n                            </Nav>\n                        </Navbar.Collapse>\n                    </Navbar>\n                    {\n                        detectMobile.isMobile()\n                            ?<div onClick={handleAddToHomescreenClick} style={{marginBottom:'10px'}} className='bg-light-silver tc shadow-5 text-dark'><span className='underline'>Add to home screen</span> for best experience!</div>\n                            :<div/>\n                    }\n                    {\n                        {\n                            '/login': <Login loginOrRegister={loginOrRegister}/>,\n                            '/register': <Register loginOrRegister={loginOrRegister}/>,\n                            '/faq':<FAQorReleaseInfo isFAQ={true}/>,\n                            '/release':<FAQorReleaseInfo isFAQ={false}/>,\n                            '/vsuccess':<EmailedVerified success={true}/>,\n                            '/vfailed':<EmailedVerified success={false}/>\n                        }[path]\n                    }\n                    {path === '/login' || path === '/register'\n                        ? <img src={'https://dramarocket.com/wp-content/uploads/2018/01/icon-redrocket-2.png'} alt={'logo'}\n                               className={'center'}/>\n                        : <div/>\n                    }\n                </div>\n            </LoadingOverlay>\n        </>\n    );\n}\nexport default WelcomePage;","import jwt from'jsonwebtoken';\nimport {TokenSignature} from \"../Constants/Const\";\n\n\nexport const ValidateToken = (token) => {\n\n    try {\n        let decoded = jwt.verify(token, TokenSignature);\n        return decoded;\n    } catch(err) {\n        throw err;\n    }\n};\n","import React, {useEffect, useState} from 'react';\nimport MainChatAppWindow from \"./Components/MainChatAppWindow/MainChatAppWindow\";\nimport { HashRouter as Router, Switch, Route, Redirect} from \"react-router-dom\";\nimport './App.css';\nimport WelcomePage from \"./Components/Welcome/WelcomePage\";\nimport {GetAllChatsByUserId, TryLoginOrRegister} from \"./Helpers/ApiFetcher\";\nimport {ProcessChats} from \"./Helpers/ProcessData\";\nimport {ToastProvider} from \"react-toast-notifications\";\nimport {ROUTES} from \"./Constants/Const\";\nimport {ValidateToken} from \"./Helpers/TokenValidation\";\nimport {useCookies} from \"react-cookie\"\n\nexport const UserChatsContext = React.createContext({user:{},chats:[],isLoading:false});\n\nfunction App() {\n\n    const[user,setUser] = useState(null);\n    const [chats,setChats] = useState([]);\n    const [cookies, setCookie, removeCookie] = useCookies(['userToken']);\n    const[isLoading,setIsLoading] = useState(false);\n    const[isLoggedIn,setLoggedIn] = useState(false);\n\n    // A function to load chats with last message, to be used on login\n    //Determines what is going to be displayed on the left side of main chat window\n    // Check every chat data received from the backed and renders accordingly\n    async function GetChats(userId)  {\n        try {\n            let chats = await GetAllChatsByUserId(userId);\n            const chatsToState = ProcessChats(chats,userId);\n            setChats(chatsToState);\n            return 'ok';\n        }\n        catch(err){ alert('error loading chats') }\n    }\n\n    useEffect(()=>{\n        const token = cookies.userToken;\n        ValidateAndSetUser(token)\n            .then((user)=> {\n                setUser(user);\n                setLoggedIn(true)\n            })\n            .catch(()=>console.log('No cookie :('));\n    },[]);\n\n    async function ValidateAndSetUser(token){\n        try {\n            let user = ValidateToken(token);\n            user.notificationSettings = JSON.parse(user.notificationSettings);\n            user.isOnline = user.isOnline === 'true';\n            user.userId = parseInt(user.userId);\n            if(user.isOnline){\n                //TODO make proper two device logic\n                //return 'duplicate';\n            }\n            setUser(user);\n            setIsLoading(true);\n            await GetChats(user.userId);\n            setIsLoading(false);\n\n            return user;\n        }\n        catch (e) {throw e;}\n    }\n    //Function that tries to log in or register based on parameter\n    //if successful, starts socket communication and invokes GetChats method defined above\n    async function loginOrRegister (loginData,endpoint){\n        try {\n            let result = await TryLoginOrRegister(loginData,endpoint);\n            if (result) {\n                // in case of registration\n                if(result.text) return result.text;\n                //expires in one day\n                setCookie('userToken',result.userToken,{maxAge:86400});\n                await ValidateAndSetUser(result.userToken);\n            }\n            return 'ok';\n        }\n        catch(err) {\n            console.log(err);\n            throw err;\n        }\n    }\n\n    return (\n        <ToastProvider>\n            <Router className = {'rocket'}>\n                <Switch>\n                        <Route path=\"/app\">\n                            <UserChatsContext.Provider value={{user,chats,isLoading}}>\n                                <MainChatAppWindow setUser={setUser} setChats={setChats}/>\n                             </UserChatsContext.Provider>\n                        </Route>\n                        {\n                            ROUTES.map(route => (\n                                <Route path={route} key={route}>\n                                    <UserChatsContext.Provider value={{user,chats,isLoading}}>\n                                         <WelcomePage path={route}/>\n                                    </UserChatsContext.Provider>\n                                </Route>\n                            ))\n                        }\n                        <Route path={'/register'}>\n                            <UserChatsContext.Provider value={{user,chats,isLoading}}>\n                                 <WelcomePage path={'/register'}  loginOrRegister={loginOrRegister}/>\n                            </UserChatsContext.Provider>\n                        </Route>\n                        <Route>\n                            <UserChatsContext.Provider value={{user,chats,isLoading}}>\n                                <WelcomePage path={'/login'}  loginOrRegister={loginOrRegister}/>\n                            </UserChatsContext.Provider>\n                        </Route>\n                </Switch>\n                {isLoggedIn\n                    ?<Redirect to={'/app'}/>\n                    :<div/>\n                }\n            </Router>\n        </ToastProvider>\n        );\n}\nexport default App;","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nimport {RELEASEDATA} from \"./Constants/Const\";\nimport swal from \"sweetalert\";\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              swal(\"New update!\", `Rocket chat ${RELEASEDATA[0].version} was downloaded, close all tabs to update!`, \"success\");\n\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport App from \"./App\";\nimport 'tachyons';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n        <App />\n    , document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register();\n"],"sourceRoot":""}