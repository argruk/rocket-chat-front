(this["webpackJsonprocket-chat-front"]=this["webpackJsonprocket-chat-front"]||[]).push([[0],{104:function(e,t,a){},116:function(e,t,a){},119:function(e,t,a){e.exports=a.p+"static/media/lol.f8b7a2e4.mp3"},120:function(e,t,a){e.exports=a.p+"static/media/dr_stone_ending.470614e2.mp3"},146:function(e,t,a){e.exports=a(194)},151:function(e,t,a){},178:function(e,t,a){},181:function(e,t,a){},192:function(e,t,a){},194:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(17),o=a.n(c),l=(a(151),a(152),a(9)),s=a.n(l),i=a(13),u=a(8),m=a(57),d=a(143),h=a(45),f=a(26),g=a(20);function p(e){var t=e.setIsMobile,a=Object(n.useState)(!0),c=Object(u.a)(a,2),o=c[0],l=c[1],s=function(e){t(e),l(!1)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,{show:o,onHide:function(){return l(!1)},centered:!0},r.a.createElement(f.a.Body,{closebutton:"true",className:"tc"},r.a.createElement("h3",null,"Swtich to mobile version"),r.a.createElement("div",null,r.a.createElement(g.a,{variant:"primary",onClick:function(){return s(!0)}},"Yes"),r.a.createElement(g.a,{style:{marginLeft:"10%"},variant:"secondary",onClick:function(){return s(!1)}},"No")))))}a(104);var v=a(119),E=a.n(v),b=a(120),w=a.n(b),y=a(34),O=Object({NODE_ENV:"production",PUBLIC_URL:"/rocket-chat-front"}).REACT_APP_APILINK,k=["Audio","Add Contact","My Account","Logout"],j=["witcher","drStone"],x=[{str:"weak",color:"red"},{str:"medium",color:"darkorange"},{str:"okay",color:"springgreen"},{str:"strong",color:"green"}],C=[{question:"Q: What do I do here?",answer:"A: You send messages to other people, could you imagine!!!"},{question:"Q: How to get started?",answer:"A: Please register, then add other people and talk to them as much as you want. Please mind the warning above when you submit any data."},{question:"Q: Who are the creators of this miracle?",answer:"A: Bohdan Boss and Artem Daddy :))"},{question:"Q: What are future plans for this project?",answer:"A: Show WhatsApp and Telegram how to make good apps..."},{question:"Q: Why can I not send emoji without text on PC?",answer:"A: This is a known issue and might be fixed later, hold tight!"},{question:"Q: Lorem Ipsum?",answer:"A: Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."}],N=[{version:"v0.2.1",changes:["Bugfixes and UI improvements"]},{version:"v0.2",changes:["Chats are sorted based on last message","Automatic reconnection in case of disconnect","Online/Offline status of users with notifications","Account settings with live update","Emoji for desktop users","Bugfixes and other minor improvements"]},{version:"v0.1",changes:["Registration/Login","Live messages","Message history is saved and is reloaded on login","Can add others to contact list","Audio settings"]}];function S(e){return I.apply(this,arguments)}function I(){return(I=Object(i.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(O,"/api/getallchats?userId=").concat(t));case 3:return a=e.sent,e.next=6,a.json();case 6:return a=e.sent,e.abrupt("return",a);case 10:throw e.prev=10,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function A(e,t,a){return U.apply(this,arguments)}function U(){return(U=Object(i.a)(s.a.mark((function e(t,a,n){var r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],e.prev=1,e.next=4,fetch("".concat(O,"/api/getlastmessages?chatId=").concat(t,"&totalMessagesLoaded=").concat(n));case 4:return c=e.sent,e.next=7,c.json();case 7:return c=e.sent,e.next=10,c.forEach((function(e){var t=e.userId===a.userId?0:1;r.push(new y.Message({id:t,message:e.messageText}))}));case 10:return e.abrupt("return",r);case 13:throw e.prev=13,e.t0=e.catch(1),e.t0;case 16:case"end":return e.stop()}}),e,null,[[1,13]])})))).apply(this,arguments)}function M(e,t){return T.apply(this,arguments)}function T(){return(T=Object(i.a)(s.a.mark((function e(t,a){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(O,"/api/").concat(a),{method:"post",headers:{"Content-type":"application/json"},body:JSON.stringify(t)});case 3:return n=e.sent,r=n.status,e.next=7,n.json();case 7:return n=e.sent,B(r,n.text),e.abrupt("return",n);case 12:throw e.prev=12,e.t0=e.catch(0),e.t0;case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}function L(){return(L=Object(i.a)(s.a.mark((function e(t,a){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(O,"/api/addchat?curUserId=").concat(t,"&emailToAdd=").concat(a));case 3:return n=e.sent,r=n.status,e.next=7,n.json();case 7:return n=e.sent,B(r,n.text),e.abrupt("return",n);case 12:throw e.prev=12,e.t0=e.catch(0),e.t0;case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}function F(e){fetch("".concat(O,"/api/disconnect?userId=").concat(e)).then((function(e){404===e.status&&console.log("Couldnt find a user")}))}function B(e,t){switch(e){case 400:throw new Error(t);case 500:case 404:throw new Error("Server error,try again later")}}function q(e,t){var a=[];return e.forEach((function(e){var n,r;e.lastMessage?(n=e.lastMessage.userId===t?0:1,r={id:e.chatId,image:e.friendImageUrl,isOnline:e.isOnline,lastMessagesAreFetched:!1,name:e.friendUserName,msg:[new y.Message({id:n,message:e.lastMessage.messageText})]}):r={id:e.chatId,image:e.friendImageUrl,isOnline:e.isOnline,lastMessagesAreFetched:!1,name:e.friendUserName,msg:[]},a.push(r)})),a}var D=function(e,t){var a=0,n=!0,r=!1,c=void 0;try{for(var o,l=t[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){if(o.value.id===e)return a;a++}}catch(s){r=!0,c=s}finally{try{n||null==l.return||l.return()}finally{if(r)throw c}}return-1},P=function(){var e=Object(i.a)(s.a.mark((function e(t,a,n){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,A(t,a,n.msg.length);case 3:return r=e.sent,n.msg.forEach((function(e){r.push(e)})),n.lastMessagesAreFetched=!0,n.msg=[],n.msg=Object(m.a)(r),e.abrupt("return",n);case 11:throw e.prev=11,e.t0=e.catch(0),e.t0;case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,a,n){return e.apply(this,arguments)}}(),R=function(e,t){var a={},n={found:!1};e.forEach((function(e){var t=e.id;a[t]=1}));var r=!0,c=!1,o=void 0;try{for(var l,s=t[Symbol.iterator]();!(r=(l=s.next()).done);r=!0){var i=l.value;if(i in a){n.found=!0,n.id=i;break}}}catch(u){c=!0,o=u}finally{try{r||null==s.return||s.return()}finally{if(c)throw o}}return n},W=a(121),H=a.n(W),Q=a(32),z=a(144),K=a(66);var Y=function(e){var t=e.show,a=e.handleClose,c=e.updateAudio,o=e.chooseSong,l=Object(n.useState)(0),s=Object(u.a)(l,2),i=s[0],m=s[1],d=Object(n.useState)(""),h=Object(u.a)(d,2),g=h[0],p=h[1],v=function(e){return e?"primary":"secondary"};return r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,{show:t,onHide:a,centered:!0},r.a.createElement(f.a.Body,null,r.a.createElement("h3",null,"Audio settings"),r.a.createElement("h5",null,"Current song"),r.a.createElement(Q.a,null,r.a.createElement(Q.a.Toggle,{variant:"success",id:"dropdown-basic"},g?r.a.createElement(r.a.Fragment,null,g):r.a.createElement(r.a.Fragment,null,"Choose song ")),r.a.createElement(Q.a.Menu,null,j.map((function(e){return r.a.createElement(Q.a.Item,{key:e,onClick:function(){return function(e){m(0),o(e),p(e)}(e)}},e)})))),r.a.createElement("h4",null," Playback "),r.a.createElement(z.a,{type:"radio",name:"options",value:i,onChange:function(e){m(e),e&&g?c(!0):e||c(!1)}},r.a.createElement(K.a,{variant:v(Boolean(i)),value:1},"On"),r.a.createElement(K.a,{variant:v(!Boolean(i)),value:0},"Off")))))},_=a(41),G=a(122);var J=function(e){var t=e.show,a=e.handleClose,c=e.createNewChat,o=Object(n.useState)(""),l=Object(u.a)(o,2),s=l[0],i=l[1],m=Object(n.useState)(""),d=Object(u.a)(m,2),h=d[0],p=d[1],v=Object(n.useContext)(Pe).user,E=v?v.userId:0;return r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,{show:t,onHide:a,centered:!0},r.a.createElement(f.a.Body,null,r.a.createElement("h3",null,"Add contact "),r.a.createElement(_.a,{onSubmit:function(e){e.preventDefault(),function(e,t){return L.apply(this,arguments)}(E,s).then((function(e){if(e){var t=e.chatId,n=e.userName,r=e.friendImageUrl;c(t,n,r),a()}})).catch((function(e){e.toString().includes("Failed to fetch")?p("No response from the server"):p(e.message)}))}},r.a.createElement(_.a.Group,{controlId:"formBasicEmail"},r.a.createElement(_.a.Label,null,"Email address"),r.a.createElement(_.a.Control,{type:"email",placeholder:"Enter email",onChange:function(e){return i(e.target.value)}}),r.a.createElement(_.a.Text,{className:"text-muted"},"Add bohdan@rocket.chat / artem@rocket.chat to provide feedback or just to chat.")),h?r.a.createElement(G.a,null,r.a.createElement("div",{className:"dark-red"},h)):r.a.createElement(r.a.Fragment,null),r.a.createElement(g.a,{variant:"primary",type:"submit",disabled:!(s.length>0)},"Add friend")))))},V=a(93),$=a(46),X=a(125),Z=a(44),ee=a(82),te=a(124),ae=a.n(te);var ne=function(e){var t=e.type,a=e.UpdateUserData,c=Object(n.useState)(""),o=Object(u.a)(c,2),l=o[0],s=o[1],i=Object(n.useState)({show:!1,type:""}),m=Object(u.a)(i,2),d=m[0],h=m[1];function f(){return l.length>2}return r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:function(e){e.preventDefault();var n={type:t,value:l};"image"!==t||ae()(l)?(a(n.type,n.value),h({show:!0,type:"success"})):h({show:!0,type:"danger"}),s("")}},r.a.createElement(_.a.Row,null,r.a.createElement(Z.a,null,r.a.createElement(_.a.Control,{placeholder:"new "+t,value:l,onChange:function(e){return s(e.target.value)}})),r.a.createElement(Z.a,null,r.a.createElement(g.a,{type:"submit",variant:f()?"primary":"secondary",disabled:!f()}," Update!")),d.show?r.a.createElement(ee.a,{variant:d.type,onClose:function(){return h({show:!1,type:""})},dismissible:!0,className:"ma2"},"danger"===d.type?"Your ".concat(t," change failed with many errors!"):"Your "+t+" was changed successfully!"):r.a.createElement("div",null))))};var re=function(e){var t=e.show,a=e.handleClose,c=e.UpdateUserData,o=Object(n.useContext)(Pe).user;return r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,{show:t,onHide:a,centered:!0},r.a.createElement(f.a.Body,null,r.a.createElement("h3",null,"My Account"),r.a.createElement(X.a,{defaultActiveKey:"Picture",id:"uncontrolled-tab-example"},r.a.createElement($.a,{eventKey:"Picture",title:"Picture"},o.imageUrl?r.a.createElement(V.a,null,r.a.createElement(V.a.Image,{roundedCircle:!0,width:100,height:120,alt:"profile picc",src:o.imageUrl}),r.a.createElement(V.a.Caption,null,"Your profile picture."),r.a.createElement("div",null,r.a.createElement(ne,{UpdateUserData:c,type:"image"}))):r.a.createElement("span",{className:"ma2"}," You have no pic",r.a.createElement("div",null,r.a.createElement(ne,{UpdateUserData:c,type:"image"})))),r.a.createElement($.a,{eventKey:"Name",title:"Name"},r.a.createElement("div",{className:"ma2 "},r.a.createElement("h6",null,"Your current name is ",r.a.createElement("strong",null,o.userName)),r.a.createElement(ne,{UpdateUserData:c,type:"name"})))),r.a.createElement(g.a,{onClick:function(){return a()}},"Close"))))};var ce=function(e){var t=e.updateAudio,a=e.logout,c=e.chooseSong,o=e.createNewChat,l=e.UpdateUserData,s=Object(n.useState)({type:"",seen:!1}),i=Object(u.a)(s,2),m=i[0],d=i[1],h=function(){return d({type:"",seen:!1})};return r.a.createElement(r.a.Fragment,null,r.a.createElement(Q.a,null,r.a.createElement(Q.a.Toggle,{variant:"secondary",size:"sm",id:"dropdown-basic"},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},r.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),r.a.createElement("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}))),r.a.createElement(Q.a.Menu,null,k.map((function(e,t){return"Logout"===e?r.a.createElement(Q.a.Item,{key:e,onClick:a},k[t]):r.a.createElement(Q.a.Item,{key:e,onClick:function(){return e=k[t],d({type:e,seen:!0});var e}},k[t]," ")})))),{"Add Contact":r.a.createElement(J,{show:m.seen,handleClose:h,createNewChat:o}),Audio:r.a.createElement(Y,{show:m.seen,handleClose:h,updateAudio:t,chooseSong:c}),"My Account":r.a.createElement(re,{show:m.seen,handleClose:h,UpdateUserData:l}),Logout:r.a.createElement(r.a.Fragment,null)}[m.type])},oe=(a(178),a(15));a(180);var le=function(e){var t=e.clickOnChat,a=e.setChatIndex,c=Object(n.useContext)(Pe).chats,o=Object(n.useContext)(je),l=o.chatIndex,s=o.isMobile,i={margin:"2px",backgroundColor:"#383838",color:"white"},u={margin:"0px ",marginBottom:"5px ",marginTop:"5px ",backgroundColor:"black",color:"white"};return r.a.createElement(oe.m,null,r.a.createElement(oe.c,{className:"scrollable"},c.map((function(e,n){return r.a.createElement("div",{onClick:function(){return function(e,n){t(e,n,!0),a(n)}(e.id,n)},key:e.id},r.a.createElement(oe.d,{style:n!==l||s?i:u},e.image?r.a.createElement(oe.b,{imgUrl:e.image}):r.a.createElement(oe.b,{letter:e.name.charAt(0),style:{color:"black !important"}}),r.a.createElement(oe.e,null,r.a.createElement(oe.h,{justify:!0},r.a.createElement(oe.n,{ellipsis:!0},e.name),r.a.createElement(oe.j,null,e.isOnline?r.a.createElement("status-indicator",{active:!0}):r.a.createElement("div",null))),r.a.createElement(oe.j,{ellipsis:!0},e.msg.length>0?e.msg[e.msg.length-1].message:"Say something"))))}))))};function se(e){var t=e.createNewChat,a=e.LoadTenMessages,c=e.updAudio,o=e.setSong,l=e.logout,s=e.setChatIndex,i=e.UpdateUserData,u=Object(n.useContext)(je).isMobile;return r.a.createElement("div",{className:u?"left-side col-12":"left-side col-4 col-sm-4 col-md-4 col-lg-2 col-xl-2"},r.a.createElement(ce,{createNewChat:t,updateAudio:c,chooseSong:o,logout:function(){return l()},UpdateUserData:i}),r.a.createElement(le,{clickOnChat:a,setChatIndex:s}))}var ie=a(142),ue=a(141),me=a(133),de=a.n(me);var he=function(e){var t=e.onSendClick,a=Object(n.useContext)(je).isMobile,c=r.a.createElement(ue.a,{id:"popover-basic"},r.a.createElement(de.a,{onEmojiClick:function(e,t){document.querySelector(".lc-1pj3shq").value+=t.emoji}}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(oe.m,null,r.a.createElement(oe.k,{onSend:function(){var e;e=document.querySelector(".lc-1pj3shq").value,t(e)},onChange:function(e){"change"===e.type&&(document.querySelector(".lc-1pj3shq").value+=e.type.value)}},r.a.createElement(oe.h,{align:"center"},r.a.createElement(oe.g,{fit:!0},r.a.createElement(oe.a,null)),r.a.createElement(oe.l,{fill:"true"}),r.a.createElement(oe.i,{fit:!0})),a?r.a.createElement("div",{style:{height:"45px"}}):r.a.createElement(oe.h,{verticalAlign:"center",justify:"left"},r.a.createElement(ie.a,{trigger:"click",placement:"top",overlay:c},r.a.createElement(oe.g,{fit:!0},r.a.createElement(oe.f,{onClick:function(){}})))))))};a(181);var fe=function(e){var t=e.chatData,a=e.onSend,c=e.loadTen,o=e.GoBack,l=Object(n.useContext)(je),s=l.chatId,i=l.chatIndex,u=l.isMobile,m=function(e){c(s,i,!1)};return r.a.createElement("div",{id:"chat-side"},u?r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row header"},r.a.createElement(g.a,{type:"button",variant:"secondary",className:"col-2 arrow-back ",onClick:function(){return o("left")}},r.a.createElement("span",{className:"btn-label"},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},r.a.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"}),r.a.createElement("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"}))),"Back"),r.a.createElement("div",{className:"white tc col-10",style:{backgroundColor:"#6c757d"}},r.a.createElement("strong",{className:"black"},t.name)," is",r.a.createElement("span",{className:t.isOnline?"dark-blue":"white"}," ",t.isOnline?" online":" offline"),r.a.createElement("h5",{className:"hover-bg-white-40 pointer",onClick:m},"Load more messages")))):r.a.createElement("h4",{className:"white tc hover-bg-white-40 pointer col-10",onClick:m},"Load more"),r.a.createElement(y.ChatFeed,{ClassName:"feed",showSenderName:!0,messages:t.msg}),r.a.createElement("footer",{className:"footer"},r.a.createElement(he,{onSendClick:a})))};function ge(e){var t=e.LoadTenMessages,a=e.SendMessage,c=e.GoBack,o=Object(n.useContext)(Pe).chats,l=Object(n.useContext)(je),s=l.chatIndex,i=l.isMobile;return r.a.createElement("div",{className:i?"right-side col-12":"right-side col-8 col-sm-8 col-md-8 col-lg-10 col-xl-10 "},r.a.createElement("div",{className:"overflow-hidden"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},-1===s?r.a.createElement("div",{className:"tc center col align-self-center",id:"idle-msg"},"Click on a chat to start messaging!"):r.a.createElement("div",{className:"col"},r.a.createElement(fe,{loadTen:t,chatData:o[s],onSend:a,GoBack:c}))))))}var pe=a(140);function ve(e){var t=e.name;return r.a.createElement("div",null,r.a.createElement("strong",null,"New chat!"),r.a.createElement("div",null,r.a.createElement("strong",null,t)," created a chat with you!"))}function Ee(e){var t=e.online;return r.a.createElement("div",null,r.a.createElement("strong",null,"Connection status changed!"),r.a.createElement("div",null,t?"You are online now":"You went offline, your messages will not be sent!"),t?r.a.createElement("div",null):r.a.createElement("div",null,"We will try to reconnect you!"))}function be(e){var t=e.isLast,a=e.nextTime,c=Object(n.useState)(a),o=Object(u.a)(c,2),l=o[0],s=o[1];return Object(n.useEffect)((function(){var e=setInterval((function(){return s(l-1)}),1e3);return function(){clearInterval(e)}}),[l]),r.a.createElement("div",null,r.a.createElement("strong",null,"Reconnection failed!"),r.a.createElement("div",null,t?"Failed to reconnect, please reload the page or try again later.":"We will try again in ".concat(l," seconds.")))}function we(){return(we=Object(i.a)(s.a.mark((function e(t,a,n,c,o,l){var i,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=(new pe.a).withUrl("".concat(O,"/chat")).build(),t((function(e){return u=e,e})),u){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,e.next=7,i.start();case 7:return console.log("Connection successful!"),e.next=10,i.invoke("UserWentOfflineOrOnline",!0,u.userId);case 10:c(r.a.createElement(Ee,{online:!0}),"success",3e3),i.onclose((function(){var e;F(u.userId),t((function(t){return e=t,t})),e&&(c(r.a.createElement(Ee,{online:!1}),"warning",3e3),ye(0,i,n,c).then((function(){o(-1),a((function(e){var t=Object(m.a)(e);return t.forEach((function(e){e.msg=[],e.lastMessagesAreFetched=!1})),t}))})).catch((function(e){return console.log(e)})))})),i.on("sendToAll",(function(e,t,n){a((function(a){var r=D(t,a);if(-1!==r&&u.userId!==e){var c=Object.assign([],a);c[r].msg.push(new y.Message({id:1,message:n})),c[r].isOnline=!0;var s,i=c[r];return c.splice(r,1),c.unshift(i),l((function(e){return s=e,e})),o((function(){return D(s,c)})),c}return a}))})),i.on("UserWentOfflineOrOnline",(function(e,t,n){a((function(a){var r=Object.assign([],a);if(t!==u.userId){var c=R(a,n);if(c.found)r[D(c.id,a)].isOnline=e}return r}))})),i.on("UserDataChanged",(function(e,t,n,r){console.log(e,t,n,r),u.userId!==e&&a((function(e){var a=Object(m.a)(e),c=R(e,t);c.found&&(a[D(c.id,e)][n]=r);return a}))})),i.on("getChat",(function(e,t){u.userId===e&&(a((function(e){var a=Object.assign([],e);return a.push({id:t.chatId,image:t.image,isOnline:!0,name:t.chatName,msg:[]}),Object.assign([],a)})),c(r.a.createElement(ve,{name:t.chatName}),"info",5e3))})),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(4),c(r.a.createElement(Ee,{online:!1}),"warning",3e3),ye(0,i,n,c);case 22:return e.abrupt("return",i);case 23:case"end":return e.stop()}}),e,null,[[4,18]])})))).apply(this,arguments)}function ye(e,t,a,n){return Oe.apply(this,arguments)}function Oe(){return(Oe=Object(i.a)(s.a.mark((function e(t,a,n,c){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:3e3,setTimeout((function(){a.start().then((function(){return n(a),c(r.a.createElement(Ee,{online:!0}),"success",4e3),new Promise((function(e,t){return e(!0)}))})).catch((function(){if(!(t<4))return c(r.a.createElement(be,{isLast:!0}),"error",7e4),!1;c(r.a.createElement(be,{nextTime:3e3*(t+1)/1e3,isLast:!1}),"warning",3e3*(t+1)),ye(t+1,a,n,c)}))}),3e3*t);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ke=a(88),je=r.a.createContext({chatId:null,chatIndex:null,isMobile:!1}),xe=function(e){var t=e.setChats,a=e.SendMessage,c=e.logout,o=e.createNewChat,l=e.setUser,s=e.setHubConnection,i=Object(n.useContext)(Pe),f=i.user,g=i.chats,v=H()(),b=Object(ke.useToasts)(),y=b.addToast,O=b.removeToast,k=Object(n.useState)(-1),j=Object(u.a)(k,2),x=j[0],C=j[1],N=Object(n.useState)(-1),S=Object(u.a)(N,2),I=S[0],A=S[1],U=Object(n.useState)(null),M=Object(u.a)(U,2),T=M[0],L=M[1],F=Object(n.useState)(!1),B=Object(u.a)(F,2),q=B[0],D=B[1],R=Object(n.useState)(!1),W=Object(u.a)(R,2),Q=W[0],z=W[1],K=Object(n.useState)("left"),Y=Object(u.a)(K,2),_=Y[0],G=Y[1];Object(n.useEffect)((function(){(function(e,t,a,n,r,c){return we.apply(this,arguments)})(l,t,s,J,A,C).then((function(e){return s(e)}))}),[]);var J=function(e,t,a){y(e,{appearance:t,autoDismiss:!1},(function(e){a<6e4&&setTimeout((function(){return O(e)}),a)}))},V=function(e,t){var a;s((function(e){return a=e,e})),l((function(a){var n=Object(d.a)({},a);switch(e){case"image":n.imageUrl=t;break;case"name":n.userName=t}return n})),a.invoke("UserDataChanged",f.userId,e,t)},$=function(e,a,n){n&&C(e);var r=Object(m.a)(g),c=r[a];if(!c.lastMessagesAreFetched&&c.msg.length>10&&(c.lastMessagesAreFetched=!0),!c.lastMessagesAreFetched||!n&&c.msg.length>10){var o=c.msg.length;P(e,f,c).then((function(e){o!==e.msg.length&&(t(r),document.getElementsByClassName("chat-history")[0].scrollTop=0)})).catch((function(e){console.log(e),alert("error loading messages")}))}},X=function(e){var t=document.getElementsByTagName("audio")[0];e?t.play():t.pause()},Z=function(e){a(x,I)(e),A(0)};return Object(n.useEffect)((function(){f||D(!0)}),[v,f]),r.a.createElement(r.a.Fragment,null,r.a.createElement(je.Provider,{value:{chatId:x,chatIndex:I,isMobile:Q}},v.isMobile()?r.a.createElement(p,{setIsMobile:z}):r.a.createElement("div",null),q?r.a.createElement(h.a,{to:"/"}):r.a.createElement("div",{className:"row"},r.a.createElement("audio",{src:function(e){switch(e){case"witcher":return E.a;case"drStone":return w.a;default:return}}(T),preload:"true",loop:!0}),Q?"left"===_?r.a.createElement(se,{LoadTenMessages:$,createNewChat:o,logout:c,setChatIndex:function(e){A(e),G("right")},setSong:L,updAudio:X,UpdateUserData:V}):r.a.createElement(ge,{LoadTenMessages:$,SendMessage:Z,GoBack:G}):r.a.createElement(r.a.Fragment,null,r.a.createElement(se,{LoadTenMessages:$,createNewChat:o,logout:c,setChatIndex:A,setSong:L,updAudio:X,UpdateUserData:V}),r.a.createElement(ge,{LoadTenMessages:$,SendMessage:Z})))))},Ce=a(61),Ne=a(69),Se=a(22),Ie=a(123),Ae=(a(116),a(40)),Ue=a(48),Me=a(89);a(191);function Te(e){var t=e.loginOrRegister,a=Object(n.useState)(""),c=Object(u.a)(a,2),o=c[0],l=c[1],m=Object(n.useState)(""),d=Object(u.a)(m,2),f=d[0],p=d[1],v=Object(n.useState)(""),E=Object(u.a)(v,2),b=E[0],w=E[1],y=Object(n.useState)(!1),O=Object(u.a)(y,2),k=O[0],j=O[1],x=Object(n.useState)(!1),C=Object(u.a)(x,2),N=C[0],S=C[1];function I(){return o.length>0&&b.length>0}function A(){return(A=Object(i.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,U("login");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e,t){return M.apply(this,arguments)}function M(){return(M=Object(i.a)(s.a.mark((function e(a,n){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),setTimeout((function(){return console.log()}),1e3),e.prev=2,r="login"===a?{email:o,password:b}:{googleToken:n},e.next=6,t(r,a);case 6:if("duplicate"!==e.sent){e.next=9;break}throw new Error("Please finish another session before starting a new one.");case 9:S(!0),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),setTimeout((function(){j(!1),e.t0.toString().includes("Failed to fetch")?p("No response from the server"):p(e.t0.message)}),1e3);case 15:case"end":return e.stop()}}),e,null,[[2,12]])})))).apply(this,arguments)}return r.a.createElement(r.a.Fragment,null,N?r.a.createElement(h.a,{to:"/app"}):r.a.createElement(Ue.a,{className:"Login"},r.a.createElement(Ue.a.Header,null," Sign In "),r.a.createElement(Ue.a.Body,null,r.a.createElement("form",{onSubmit:function(e){return A.apply(this,arguments)}},r.a.createElement(G.a,{controlId:"email"},r.a.createElement(Ae.a,null,"Email"),r.a.createElement(Ie.a,{autoFocus:!0,type:"email",value:o,onChange:function(e){return l(e.target.value)}})),r.a.createElement(G.a,{controlId:"password"},r.a.createElement(Ae.a,null,"Password"),r.a.createElement(Ie.a,{value:b,onChange:function(e){return w(e.target.value)},type:"password"})),f?r.a.createElement(G.a,null,r.a.createElement("div",{className:"tc dark-red"},f)):r.a.createElement(r.a.Fragment,null),r.a.createElement(G.a,{className:"tc"},r.a.createElement("a",{className:"tc",href:"/rocket-chat-front/#/register"},"Not signed up yet?"),r.a.createElement("div",{style:{marginTop:"15px"}})),r.a.createElement(g.a,{block:!0,variant:I()?"primary":"secondary",disabled:!I()||k,type:"submit"},k?r.a.createElement(Me.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}):"Login")))))}function Le(e){var t=e.loginOrRegister,a=Object(n.useState)(""),c=Object(u.a)(a,2),o=c[0],l=c[1],m=Object(n.useState)(""),d=Object(u.a)(m,2),f=d[0],p=d[1],v=Object(n.useState)(""),E=Object(u.a)(v,2),b=E[0],w=E[1],y=Object(n.useState)(!1),O=Object(u.a)(y,2),k=O[0],j=O[1],C=Object(n.useState)(""),N=Object(u.a)(C,2),S=N[0],I=N[1],A=Object(n.useState)(!1),U=Object(u.a)(A,2),M=U[0],T=U[1],L=Object(n.useState)(0),F=Object(u.a)(L,2),B=F[0],q=F[1];function D(){return o.length>0&&B>1&&f.length}function P(){return(P=Object(i.a)(s.a.mark((function e(a){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),j(!0),setTimeout((function(){return console.log()}),1e3),e.prev=3,e.next=6,t({username:f,email:o,password:b},"register");case 6:return e.next=8,T(!0);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),setTimeout((function(){j(!1),e.t0.toString().includes("Failed to fetch")?I("No response from the server"):I(e.t0.message)}),500);case 13:case"end":return e.stop()}}),e,null,[[3,10]])})))).apply(this,arguments)}return r.a.createElement(r.a.Fragment,null,M?r.a.createElement(h.a,{to:"/app"}):r.a.createElement(Ue.a,{className:"Login"},r.a.createElement(Ue.a.Header,null," Register "),r.a.createElement(Ue.a.Body,null,r.a.createElement("form",{onSubmit:function(e){return P.apply(this,arguments)}},r.a.createElement(G.a,{controlId:"name"},r.a.createElement(Ae.a,null,"Name"),r.a.createElement(Ie.a,{autoFocus:!0,type:"text",value:f,onChange:function(e){return p(e.target.value)}})),r.a.createElement(G.a,{controlId:"email"},r.a.createElement(Ae.a,null,"Email"),r.a.createElement(Ie.a,{autoFocus:!0,type:"email",value:o,onChange:function(e){return l(e.target.value)}})),r.a.createElement(G.a,{controlId:"password"},r.a.createElement(Ae.a,null,"Password"),r.a.createElement(Ie.a,{style:{borderBottom:"3px solid ".concat(x[B].color)},value:b,onChange:function(e){var t=0,a=e.target.value;a.length>3&&t++,a.length>5&&t++,a.match(/\d+/g)&&t++,q(t),w(a)},type:"password"})),S?r.a.createElement(G.a,null,r.a.createElement("div",{className:"tc dark-red"},S)):r.a.createElement(r.a.Fragment,null),r.a.createElement(g.a,{block:!0,variant:D()?"primary":"secondary",disabled:!D()||k,type:"submit"},k?r.a.createElement(Me.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}):"Register")))))}a(192);var Fe=a(138);function Be(e){var t=e.isFAQ;return r.a.createElement("div",null,r.a.createElement($.a.Container,{id:"left-tabs-example",defaultActiveKey:t?C[0].question:N[0].version},r.a.createElement(Fe.a,{className:"bg-black-90 align-content-start"},r.a.createElement(Z.a,{md:4,lg:4,xl:4,sm:12,xs:12},r.a.createElement(Se.a,{variant:"pills",className:"flex-column b--solid b--light-blue"},t?C.map((function(e){return r.a.createElement(Se.a.Item,{key:e.question},r.a.createElement(Se.a.Link,{eventKey:e.question},e.question))})):N.map((function(e){return r.a.createElement(Se.a.Item,{key:e.version},r.a.createElement(Se.a.Link,{eventKey:e.version},e.version))})))),r.a.createElement(Z.a,{sm:12,xs:12,md:8,xl:8,lg:8},r.a.createElement($.a.Content,{className:"white ma3"},t?C.map((function(e){return r.a.createElement($.a.Pane,{eventKey:e.question,key:e.answer},e.answer)})):N.map((function(e){return r.a.createElement($.a.Pane,{key:e.changes[0],eventKey:e.version},r.a.createElement("ul",null,e.changes.map((function(e){return r.a.createElement("li",{key:e},e)}))))})))))))}var qe=function(e){var t=e.loginOrRegister,a=e.path;return r.a.createElement("div",{className:"welcome-page overflow-y-auto overflow-x-hidden"},r.a.createElement(Ne.a,{bg:"dark",variant:"dark",expand:"lg"},r.a.createElement(Ne.a.Brand,{href:"/rocket-chat-front/#/login"},"Rocket-Chat v0.2.1 BETA"),r.a.createElement(Ne.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(Ne.a.Collapse,{id:"basic-navbar-nav"},r.a.createElement(Se.a,{className:"mr-auto "},r.a.createElement(Se.a.Link,{href:"/rocket-chat-front/#/faq"},"FAQ"),r.a.createElement(Se.a.Link,{href:"/rocket-chat-front/#/release"},"Release notes")),r.a.createElement(Se.a,null,r.a.createElement(Se.a.Link,{href:"/rocket-chat-front/#/login"},"Sign in"),r.a.createElement(Se.a.Link,{href:"/rocket-chat-front/#/register"},"Register")))),r.a.createElement(ee.a,{variant:"warning",className:"tc ma0"},"During the beta, please don't use your real email and don't send important messages over the chat!",r.a.createElement("br",null),r.a.createElement("strong",null,"If you had an account before, please create a new one,thanks!",r.a.createElement("br",null),"Make sure to check out our ",r.a.createElement("a",{href:"/rocket-chat-front/#/release"},"release notes"),"!")),{"/login":r.a.createElement(Te,{loginOrRegister:t}),"/register":r.a.createElement(Le,{loginOrRegister:t}),"/faq":r.a.createElement(Be,{isFAQ:!0}),"/release":r.a.createElement(Be,{isFAQ:!1})}[a],"/login"===a||"/register"===a?r.a.createElement("img",{src:"https://dramarocket.com/wp-content/uploads/2018/01/icon-redrocket-2.png",alt:"logo",className:"center"}):r.a.createElement("div",null))},De=a(139),Pe=r.a.createContext({user:{},chats:[]});var Re=function(){var e=Object(n.useState)(null),t=Object(u.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)([]),l=Object(u.a)(o,2),m=l[0],d=l[1],f=Object(n.useState)(null),g=Object(u.a)(f,2),p=g[0],v=g[1];function E(e){return b.apply(this,arguments)}function b(){return(b=Object(i.a)(s.a.mark((function e(t){var a,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S(t);case 3:return a=e.sent,n=q(a,t),d(n),e.abrupt("return","ok");case 9:e.prev=9,e.t0=e.catch(0),alert("error loading chats");case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function w(e,t){return O.apply(this,arguments)}function O(){return(O=Object(i.a)(s.a.mark((function e(t,a){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M(t,a);case 3:if(!(n=e.sent)){e.next=10;break}return(r=n).isOnline,c(r),e.next=10,E(r.userId);case 10:return e.abrupt("return","ok");case 13:throw e.prev=13,e.t0=e.catch(0),console.log(e.t0),e.t0;case 17:case"end":return e.stop()}}),e,null,[[0,13]])})))).apply(this,arguments)}window.addEventListener("beforeunload",(function(e){F(a.userId),k()}));var k=function(){p.invoke("UserWentOfflineOrOnline",!1,a.userId).then((function(){return p.stop()})).catch((function(e){return console.log(e)}))},j=function(){try{var e=De.a.auth2.getAuthInstance();e.signOut().then(e.disconnect())}catch(t){console.log("Not a googler!")}};return r.a.createElement(ke.ToastProvider,null,r.a.createElement(Ce.a,{className:"rocket"},r.a.createElement(h.d,null,r.a.createElement(h.b,{path:"/app"},r.a.createElement(Pe.Provider,{value:{user:a,chats:m}},r.a.createElement(xe,{setHubConnection:v,setUser:c,setChats:d,SendMessage:function(e,t){var n=t,r=e;return function(e){p.invoke("SendDirectMessage",a.userId,r,e).catch((function(e){return console.log(e)})),d((function(t){var a=Object.assign([],t),r=a[n];return r.msg.push(new y.Message({id:0,message:e})),a.splice(n,1),a.unshift(r),a}))}},logout:function(){c(null),k(),v(null),j()},createNewChat:function(e,t,n){console.log(n),p.invoke("ChatWithUserWasCreated",a.userId,e,{chatId:e,chatName:a.userName,image:a.imageUrl}),d((function(a){var r=Object.assign([],a);return r.push({id:e,image:n,name:t,msg:[]}),r}))}}))),r.a.createElement(h.b,{path:"/register"},r.a.createElement(qe,{path:"/register",loginOrRegister:w})),r.a.createElement(h.b,{path:"/faq"},r.a.createElement(qe,{path:"/faq"})),r.a.createElement(h.b,{path:"/release"},r.a.createElement(qe,{path:"/release"})),r.a.createElement(h.b,null,r.a.createElement(qe,{path:"/login",loginOrRegister:w})))))},We=(a(193),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function He(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o.a.render(r.a.createElement(Re,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/rocket-chat-front",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/rocket-chat-front","/service-worker.js");We?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):He(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):He(t,e)}))}}()}},[[146,1,2]]]);
//# sourceMappingURL=main.1d1d4f0b.chunk.js.map