(this["webpackJsonprocket-chat-front"]=this["webpackJsonprocket-chat-front"]||[]).push([[0],{103:function(e,t,a){},114:function(e,t,a){},117:function(e,t,a){e.exports=a.p+"static/media/lol.f8b7a2e4.mp3"},118:function(e,t,a){e.exports=a.p+"static/media/dr_stone_ending.470614e2.mp3"},144:function(e,t,a){e.exports=a(192)},149:function(e,t,a){},176:function(e,t,a){},179:function(e,t,a){},190:function(e,t,a){},192:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(16),o=a.n(c),l=(a(149),a(150),a(8)),s=a.n(l),i=a(9),u=a(56),m=a(141),d=a(44),h=a(25),g=a(19);function f(e){var t=e.setIsMobile,a=Object(n.useState)(!0),c=Object(i.a)(a,2),o=c[0],l=c[1],s=function(e){t(e),l(!1)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{show:o,onHide:function(){return l(!1)},centered:!0},r.a.createElement(h.a.Body,{closebutton:"true",className:"tc"},r.a.createElement("h3",null,"Swtich to mobile version"),r.a.createElement("div",null,r.a.createElement(g.a,{variant:"primary",onClick:function(){return s(!0)}},"Yes"),r.a.createElement(g.a,{style:{marginLeft:"10%"},variant:"secondary",onClick:function(){return s(!1)}},"No")))))}a(103);var p=a(117),v=a.n(p),E=a(118),b=a.n(E),w=a(33),y="https://rocket-chat-api.azurewebsites.net",O=["Audio","Add Contact","My Account","Logout"],k=["witcher","drStone"],j=[{str:"weak",color:"red"},{str:"medium",color:"darkorange"},{str:"okay",color:"springgreen"},{str:"strong",color:"green"}],x=[{question:"Q: What do I do here?",answer:"A: You send messages to other people, could you imagine!!!"},{question:"Q: How to get started?",answer:"A: Please register, then add other people and talk to them as much as you want. Please mind the warning above when you submit any data."},{question:"Q: Who are the creators of this miracle?",answer:"A: Bohdan Boss and Artem Daddy :))"},{question:"Q: What are future plans for this project?",answer:"A: Show WhatsApp and Telegram how to make good apps..."},{question:"Q: Why can I not send emoji without text on PC?",answer:"A: This is a known issue and might be fixed later, hold tight!"},{question:"Q: Lorem Ipsum?",answer:"A: Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."}],C=[{version:"v0.2",changes:["Chats are sorted based on last message","Automatic reconnection in case of disconnect","Online/Offline status of users with notifications","Account settings with live update","Emoji for desktop users","Bugfixes and other minor improvements"]},{version:"v0.1",changes:["Registration/Login","Live messages","Message history is saved and is reloaded on login","Can add others to contact list","Audio settings"]}];function S(e){var t;return s.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,s.a.awrap(fetch("".concat(y,"/api/getallchats?userId=").concat(e)));case 3:return t=a.sent,a.next=6,s.a.awrap(t.json());case 6:return t=a.sent,a.abrupt("return",t);case 10:throw a.prev=10,a.t0=a.catch(0),a.t0;case 13:case"end":return a.stop()}}),null,null,[[0,10]])}function N(e,t,a){var n,r;return s.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return n=[],c.prev=1,c.next=4,s.a.awrap(fetch("".concat(y,"/api/getlastmessages?chatId=").concat(e,"&totalMessagesLoaded=").concat(a)));case 4:return r=c.sent,c.next=7,s.a.awrap(r.json());case 7:return r=c.sent,c.next=10,s.a.awrap(r.forEach((function(e){var a=e.userId===t.userId?0:1;n.push(new w.Message({id:a,message:e.messageText}))})));case 10:return c.abrupt("return",n);case 13:throw c.prev=13,c.t0=c.catch(1),c.t0;case 16:case"end":return c.stop()}}),null,null,[[1,13]])}function I(e,t){var a,n;return s.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,s.a.awrap(fetch("".concat(y,"/api/").concat(t),{method:"post",headers:{"Content-type":"application/json"},body:JSON.stringify(e)}));case 3:return a=r.sent,n=a.status,r.next=7,s.a.awrap(a.json());case 7:return a=r.sent,M(n,a.text),r.abrupt("return",a);case 12:throw r.prev=12,r.t0=r.catch(0),r.t0;case 15:case"end":return r.stop()}}),null,null,[[0,12]])}function A(e){fetch("".concat(y,"/api/disconnect?userId=").concat(e)).then((function(e){404===e.status&&console.log("Couldnt find a user")}))}function M(e,t){switch(e){case 400:throw new Error(t);case 500:case 404:throw new Error("Server error,try again later")}}function U(e,t){var a=[];return e.forEach((function(e){var n,r;e.lastMessage?(n=e.lastMessage.userId===t?0:1,r={id:e.chatId,image:e.friendImageUrl,isOnline:e.isOnline,lastMessagesAreFetched:!1,name:e.friendUserName,msg:[new w.Message({id:n,message:e.lastMessage.messageText})]}):r={id:e.chatId,image:e.friendImageUrl,isOnline:e.isOnline,lastMessagesAreFetched:!1,name:e.friendUserName,msg:[]},a.push(r)})),a}var T=function(e,t){var a=0,n=!0,r=!1,c=void 0;try{for(var o,l=t[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){if(o.value.id===e)return a;a++}}catch(s){r=!0,c=s}finally{try{n||null==l.return||l.return()}finally{if(r)throw c}}return-1},F=function(e,t){var a={},n={found:!1};e.forEach((function(e){var t=e.id;a[t]=1}));var r=!0,c=!1,o=void 0;try{for(var l,s=t[Symbol.iterator]();!(r=(l=s.next()).done);r=!0){var i=l.value;if(i in a){n.found=!0,n.id=i;break}}}catch(u){c=!0,o=u}finally{try{r||null==s.return||s.return()}finally{if(c)throw o}}return n},L=a(119),q=a.n(L),B=a(31),D=a(142),W=a(64);var P=function(e){var t=e.show,a=e.handleClose,c=e.updateAudio,o=e.chooseSong,l=Object(n.useState)(0),s=Object(i.a)(l,2),u=s[0],m=s[1],d=Object(n.useState)(""),g=Object(i.a)(d,2),f=g[0],p=g[1],v=function(e){return e?"primary":"secondary"};return r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{show:t,onHide:a,centered:!0},r.a.createElement(h.a.Body,null,r.a.createElement("h3",null,"Audio settings"),r.a.createElement("h5",null,"Current song"),r.a.createElement(B.a,null,r.a.createElement(B.a.Toggle,{variant:"success",id:"dropdown-basic"},f?r.a.createElement(r.a.Fragment,null,f):r.a.createElement(r.a.Fragment,null,"Choose song ")),r.a.createElement(B.a.Menu,null,k.map((function(e){return r.a.createElement(B.a.Item,{key:e,onClick:function(){return function(e){m(0),o(e),p(e)}(e)}},e)})))),r.a.createElement("h4",null," Playback "),r.a.createElement(D.a,{type:"radio",name:"options",value:u,onChange:function(e){m(e),e&&f?c(!0):e||c(!1)}},r.a.createElement(W.a,{variant:v(Boolean(u)),value:1},"On"),r.a.createElement(W.a,{variant:v(!Boolean(u)),value:0},"Off")))))},R=a(40),H=a(120);var z=function(e){var t=e.show,a=e.handleClose,c=e.createNewChat,o=Object(n.useState)(""),l=Object(i.a)(o,2),u=l[0],m=l[1],d=Object(n.useState)(""),f=Object(i.a)(d,2),p=f[0],v=f[1],E=Object(n.useContext)(Me).user,b=E?E.userId:0;return r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{show:t,onHide:a,centered:!0},r.a.createElement(h.a.Body,null,r.a.createElement("h3",null,"Add contact "),r.a.createElement(R.a,{onSubmit:function(e){e.preventDefault(),function(e,t){var a,n;return s.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,s.a.awrap(fetch("".concat(y,"/api/addchat?curUserId=").concat(e,"&emailToAdd=").concat(t)));case 3:return a=r.sent,n=a.status,r.next=7,s.a.awrap(a.json());case 7:return a=r.sent,M(n,a.text),r.abrupt("return",a);case 12:throw r.prev=12,r.t0=r.catch(0),r.t0;case 15:case"end":return r.stop()}}),null,null,[[0,12]])}(b,u).then((function(e){if(e){var t=e.chatId,n=e.userName,r=e.friendImageUrl;c(t,n,r),a()}})).catch((function(e){e.toString().includes("Failed to fetch")?v("No response from the server"):v(e.message)}))}},r.a.createElement(R.a.Group,{controlId:"formBasicEmail"},r.a.createElement(R.a.Label,null,"Email address"),r.a.createElement(R.a.Control,{type:"email",placeholder:"Enter email",onChange:function(e){return m(e.target.value)}}),r.a.createElement(R.a.Text,{className:"text-muted"},"Add bohdan@rocket.chat / artem@rocket.chat to provide feedback or just to chat.")),p?r.a.createElement(H.a,null,r.a.createElement("div",{className:"dark-red"},p)):r.a.createElement(r.a.Fragment,null),r.a.createElement(g.a,{variant:"primary",type:"submit",disabled:!(u.length>0)},"Add friend")))))},Q=a(91),Y=a(45),K=a(123),G=a(43),J=a(80),V=a(122),_=a.n(V);var $=function(e){var t=e.type,a=e.UpdateUserData,c=Object(n.useState)(""),o=Object(i.a)(c,2),l=o[0],s=o[1],u=Object(n.useState)({show:!1,type:""}),m=Object(i.a)(u,2),d=m[0],h=m[1];function f(){return l.length>2}return r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:function(e){e.preventDefault();var n={type:t,value:l};"image"!==t||_()(l)?(a(n.type,n.value),h({show:!0,type:"success"})):h({show:!0,type:"danger"}),s("")}},r.a.createElement(R.a.Row,null,r.a.createElement(G.a,null,r.a.createElement(R.a.Control,{placeholder:"new "+t,value:l,onChange:function(e){return s(e.target.value)}})),r.a.createElement(G.a,null,r.a.createElement(g.a,{type:"submit",variant:f()?"primary":"secondary",disabled:!f()}," Update!")),d.show?r.a.createElement(J.a,{variant:d.type,onClose:function(){return h({show:!1,type:""})},dismissible:!0,className:"ma2"},"danger"===d.type?"Your ".concat(t," change failed with many errors!"):"Your "+t+" was changed successfully!"):r.a.createElement("div",null))))};var X=function(e){var t=e.show,a=e.handleClose,c=e.UpdateUserData,o=Object(n.useContext)(Me).user;return r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a,{show:t,onHide:a,centered:!0},r.a.createElement(h.a.Body,null,r.a.createElement("h3",null,"My Account"),r.a.createElement(K.a,{defaultActiveKey:"Picture",id:"uncontrolled-tab-example"},r.a.createElement(Y.a,{eventKey:"Picture",title:"Picture"},o.imageUrl?r.a.createElement(Q.a,null,r.a.createElement(Q.a.Image,{roundedCircle:!0,width:100,height:120,alt:"profile picc",src:o.imageUrl}),r.a.createElement(Q.a.Caption,null,"Your profile picture."),r.a.createElement("div",null,r.a.createElement($,{UpdateUserData:c,type:"image"}))):r.a.createElement("span",{className:"ma2"}," You have no pic",r.a.createElement("div",null,r.a.createElement($,{UpdateUserData:c,type:"image"})))),r.a.createElement(Y.a,{eventKey:"Name",title:"Name"},r.a.createElement("div",{className:"ma2 "},r.a.createElement("h6",null,"Your current name is ",r.a.createElement("strong",null,o.userName)),r.a.createElement($,{UpdateUserData:c,type:"name"})))),r.a.createElement(g.a,{onClick:function(){return a()}},"Close"))))};var Z=function(e){var t=e.updateAudio,a=e.logout,c=e.chooseSong,o=e.createNewChat,l=e.UpdateUserData,s=Object(n.useState)({type:"",seen:!1}),u=Object(i.a)(s,2),m=u[0],d=u[1],h=function(){return d({type:"",seen:!1})};return r.a.createElement(r.a.Fragment,null,r.a.createElement(B.a,null,r.a.createElement(B.a.Toggle,{variant:"secondary",size:"sm",id:"dropdown-basic"},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},r.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}),r.a.createElement("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}))),r.a.createElement(B.a.Menu,null,O.map((function(e,t){return"Logout"===e?r.a.createElement(B.a.Item,{key:e,onClick:a},O[t]):r.a.createElement(B.a.Item,{key:e,onClick:function(){return e=O[t],d({type:e,seen:!0});var e}},O[t]," ")})))),{"Add Contact":r.a.createElement(z,{show:m.seen,handleClose:h,createNewChat:o}),Audio:r.a.createElement(P,{show:m.seen,handleClose:h,updateAudio:t,chooseSong:c}),"My Account":r.a.createElement(X,{show:m.seen,handleClose:h,UpdateUserData:l}),Logout:r.a.createElement(r.a.Fragment,null)}[m.type])},ee=(a(176),a(14));a(178);var te=function(e){var t=e.clickOnChat,a=e.setChatIndex,c=Object(n.useContext)(Me).chats,o=Object(n.useContext)(pe),l=o.chatIndex,s=o.isMobile,i={margin:"2px",backgroundColor:"#383838",color:"white"},u={margin:"0px ",marginBottom:"5px ",marginTop:"5px ",backgroundColor:"black",color:"white"};return r.a.createElement(ee.m,null,r.a.createElement(ee.c,{className:"scrollable"},c.map((function(e,n){return r.a.createElement("div",{onClick:function(){return function(e,n){t(e,n,!0),a(n)}(e.id,n)},key:e.id},r.a.createElement(ee.d,{style:n!==l||s?i:u},e.image?r.a.createElement(ee.b,{imgUrl:e.image}):r.a.createElement(ee.b,{letter:e.name.charAt(0),style:{color:"black !important"}}),r.a.createElement(ee.e,null,r.a.createElement(ee.h,{justify:!0},r.a.createElement(ee.n,{ellipsis:!0},e.name),r.a.createElement(ee.j,null,e.isOnline?r.a.createElement("status-indicator",{active:!0}):r.a.createElement("div",null))),r.a.createElement(ee.j,{ellipsis:!0},e.msg.length>0?e.msg[e.msg.length-1].message:"Say something"))))}))))};function ae(e){var t=e.createNewChat,a=e.LoadTenMessages,c=e.updAudio,o=e.setSong,l=e.logout,s=e.setChatIndex,i=e.UpdateUserData,u=Object(n.useContext)(pe).isMobile;return r.a.createElement("div",{className:u?"left-side col-12":"left-side col-4 col-sm-4 col-md-4 col-lg-2 col-xl-2"},r.a.createElement(Z,{createNewChat:t,updateAudio:c,chooseSong:o,logout:function(){return l()},UpdateUserData:i}),r.a.createElement(te,{clickOnChat:a,setChatIndex:s}))}var ne=a(140),re=a(139),ce=a(131),oe=a.n(ce);var le=function(e){var t=e.onSendClick,a=Object(n.useContext)(pe).isMobile,c=r.a.createElement(re.a,{id:"popover-basic"},r.a.createElement(oe.a,{onEmojiClick:function(e,t){document.querySelector(".lc-1pj3shq").value+=t.emoji}}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(ee.m,null,r.a.createElement(ee.k,{onSend:function(){var e;console.log(document.querySelector(".lc-1pj3shq").value),e=document.querySelector(".lc-1pj3shq").value,t(e)},onChange:function(e){"change"===e.type&&(document.querySelector(".lc-1pj3shq").value+=e.type.value)}},r.a.createElement(ee.h,{align:"center"},r.a.createElement(ee.g,{fit:!0},r.a.createElement(ee.a,null)),r.a.createElement(ee.l,{fill:"true"}),r.a.createElement(ee.i,{fit:!0})),a?r.a.createElement("div",{style:{height:"45px"}}):r.a.createElement(ee.h,{verticalAlign:"center",justify:"left"},r.a.createElement(ne.a,{trigger:"click",placement:"top",overlay:c},r.a.createElement(ee.g,{fit:!0},r.a.createElement(ee.f,{onClick:function(){}})))))))};a(179);var se=function(e){var t=e.chatData,a=e.onSend,c=e.loadTen,o=e.GoBack,l=Object(n.useContext)(pe),s=l.chatId,i=l.chatIndex,u=l.isMobile,m=function(e){c(s,i,!1)};return r.a.createElement("div",{id:"chat-side"},u?r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row",style:{maxHeight:"5vh"}},r.a.createElement(g.a,{type:"button",variant:"secondary",className:"col-2 arrow-back ",onClick:function(){return o("left")}},r.a.createElement("span",{className:"btn-label"},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},r.a.createElement("path",{fill:"none",d:"M0 0h24v24H0V0z"}),r.a.createElement("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"}))),"Back"),r.a.createElement("div",{className:"white tc col-10",style:{backgroundColor:"#6c757d"}},r.a.createElement("strong",{className:"black"},t.name)," is",r.a.createElement("span",{className:t.isOnline?"dark-blue":"white"}," ",t.isOnline?" online":" offline"),r.a.createElement("h5",{className:"hover-bg-white-40 pointer",onClick:m},"Load more messages")))):r.a.createElement("h4",{className:"white tc hover-bg-white-40 pointer col-10",onClick:m},"Load more"),r.a.createElement(w.ChatFeed,{ClassName:"feed",showSenderName:!0,messages:t.msg}),r.a.createElement("footer",{className:"footer"},r.a.createElement(le,{onSendClick:a})))};function ie(e){var t=e.LoadTenMessages,a=e.SendMessage,c=e.GoBack,o=Object(n.useContext)(Me).chats,l=Object(n.useContext)(pe),s=l.chatIndex,i=l.isMobile;return r.a.createElement("div",{className:i?"right-side col-12":"right-side col-8 col-sm-8 col-md-8 col-lg-10 col-xl-10 "},r.a.createElement("div",null,r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},-1===s?r.a.createElement("div",{className:"tc center col align-self-center",id:"idle-msg"},"Click on a chat to start messaging!"):r.a.createElement("div",{className:"col"},r.a.createElement(se,{loadTen:t,chatData:o[s],onSend:a,GoBack:c}))))))}var ue=a(138);function me(e){var t=e.name;return r.a.createElement("div",null,r.a.createElement("strong",null,"New chat!"),r.a.createElement("div",null,r.a.createElement("strong",null,t)," created a chat with you!"))}function de(e){var t=e.online;return r.a.createElement("div",null,r.a.createElement("strong",null,"Connection status changed!"),r.a.createElement("div",null,t?"You are online now":"You went offline, your messages will not be sent!"),t?r.a.createElement("div",null):r.a.createElement("div",null,"We will try to reconnect you!"))}function he(e){var t=e.isLast,a=e.nextTime,c=Object(n.useState)(a),o=Object(i.a)(c,2),l=o[0],s=o[1];return Object(n.useEffect)((function(){var e=setInterval((function(){return s(l-1)}),1e3);return function(){clearInterval(e)}}),[l]),r.a.createElement("div",null,r.a.createElement("strong",null,"Reconnection failed!"),r.a.createElement("div",null,t?"Failed to reconnect, please reload the page or try again later.":"We will try again in ".concat(l," seconds.")))}function ge(e,t,a,n){return s.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:3e3,setTimeout((function(){t.start().then((function(){return a(t),n(r.a.createElement(de,{online:!0}),"success",4e3),new Promise((function(e,t){return e(!0)}))})).catch((function(){if(!(e<4))return n(r.a.createElement(he,{isLast:!0}),"error",7e4),!1;n(r.a.createElement(he,{nextTime:3e3*(e+1)/1e3,isLast:!1}),"warning",3e3*(e+1)),ge(e+1,t,a,n)}))}),3e3*e);case 2:case"end":return c.stop()}}))}var fe=a(86),pe=r.a.createContext({chatId:null,chatIndex:null,isMobile:!1}),ve=function(e){var t=e.setChats,a=e.SendMessage,c=e.logout,o=e.createNewChat,l=e.setUser,h=e.setHubConnection,g=Object(n.useContext)(Me),p=g.user,E=g.chats,O=q()(),k=Object(fe.useToasts)(),j=k.addToast,x=k.removeToast,C=Object(n.useState)(-1),S=Object(i.a)(C,2),I=S[0],M=S[1],U=Object(n.useState)(-1),L=Object(i.a)(U,2),B=L[0],D=L[1],W=Object(n.useState)(null),P=Object(i.a)(W,2),R=P[0],H=P[1],z=Object(n.useState)(!1),Q=Object(i.a)(z,2),Y=Q[0],K=Q[1],G=Object(n.useState)(!1),J=Object(i.a)(G,2),V=J[0],_=J[1],$=Object(n.useState)("left"),X=Object(i.a)($,2),Z=X[0],ee=X[1];Object(n.useEffect)((function(){(function(e,t,a,n,c,o){var l,i;return s.a.async((function(m){for(;;)switch(m.prev=m.next){case 0:if(l=(new ue.a).withUrl("".concat(y,"/chat")).build(),e((function(e){return i=e,e})),i){m.next=4;break}return m.abrupt("return");case 4:return m.prev=4,m.next=7,s.a.awrap(l.start());case 7:return console.log("Connection successful!"),m.next=10,s.a.awrap(l.invoke("UserWentOfflineOrOnline",!0,i.userId));case 10:n(r.a.createElement(de,{online:!0}),"success",3e3),l.onclose((function(){var o;A(i.userId),e((function(e){return o=e,e})),o&&(n(r.a.createElement(de,{online:!1}),"warning",3e3),ge(0,l,a,n).then((function(){c(-1),t((function(e){var t=Object(u.a)(e);return t.forEach((function(e){e.msg=[],e.lastMessagesAreFetched=!1})),t}))})).catch((function(e){return console.log(e)})))})),l.on("sendToAll",(function(e,a,n){t((function(t){var r=T(a,t);if(-1!==r&&i.userId!==e){var l=Object.assign([],t);l[r].msg.push(new w.Message({id:1,message:n})),l[r].isOnline=!0;var s,u=l[r];return l.splice(r,1),l.unshift(u),o((function(e){return s=e,e})),c((function(){return T(s,l)})),l}return t}))})),l.on("UserWentOfflineOrOnline",(function(e,a,n){t((function(t){var r=Object.assign([],t);if(a!==i.userId){var c=F(t,n);if(c.found)r[T(c.id,t)].isOnline=e}return r}))})),l.on("UserDataChanged",(function(e,a,n,r){console.log(e,a,n,r),i.userId!==e&&t((function(e){var t=Object(u.a)(e),c=F(e,a);c.found&&(t[T(c.id,e)][n]=r);return t}))})),l.on("getChat",(function(e,a){i.userId===e&&(t((function(e){var t=Object.assign([],e);return t.push({id:a.chatId,image:a.image,isOnline:!0,name:a.chatName,msg:[]}),Object.assign([],t)})),n(r.a.createElement(me,{name:a.chatName}),"info",5e3))})),m.next=22;break;case 18:m.prev=18,m.t0=m.catch(4),n(r.a.createElement(de,{online:!1}),"warning",3e3),ge(0,l,a,n);case 22:return m.abrupt("return",l);case 23:case"end":return m.stop()}}),null,null,[[4,18]])})(l,t,h,te,D,M).then((function(e){return h(e)}))}),[]);var te=function(e,t,a){j(e,{appearance:t,autoDismiss:!1},(function(e){a<6e4&&setTimeout((function(){return x(e)}),a)}))},ne=function(e,t){var a;h((function(e){return a=e,e})),l((function(a){var n=Object(m.a)({},a);switch(e){case"image":n.imageUrl=t;break;case"name":n.userName=t}return n})),a.invoke("UserDataChanged",p.userId,e,t)},re=function(e,a,n){n&&M(e);var r=Object(u.a)(E),c=r[a];if(!c.lastMessagesAreFetched&&c.msg.length>10&&(c.lastMessagesAreFetched=!0),!c.lastMessagesAreFetched||!n&&c.msg.length>10){var o=c.msg.length;(function(e,t,a){var n;return s.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,s.a.awrap(N(e,t,a.msg.length));case 3:return n=r.sent,a.msg.forEach((function(e){n.push(e)})),a.lastMessagesAreFetched=!0,a.msg=[],a.msg=Object(u.a)(n),r.abrupt("return",a);case 11:throw r.prev=11,r.t0=r.catch(0),r.t0;case 14:case"end":return r.stop()}}),null,null,[[0,11]])})(e,p,c).then((function(e){o!==e.msg.length&&(t(r),document.getElementsByClassName("chat-history")[0].scrollTop=0)})).catch((function(e){console.log(e),alert("error loading messages")}))}},ce=function(e){var t=document.getElementsByTagName("audio")[0];e?t.play():t.pause()},oe=function(e){a(I,B)(e),D(0)};return Object(n.useEffect)((function(){p||K(!0)}),[O,p]),r.a.createElement(r.a.Fragment,null,r.a.createElement(pe.Provider,{value:{chatId:I,chatIndex:B,isMobile:V}},O.isMobile()?r.a.createElement(f,{setIsMobile:_}):r.a.createElement("div",null),Y?r.a.createElement(d.a,{to:"/"}):r.a.createElement("div",{className:"row"},r.a.createElement("audio",{src:function(e){switch(e){case"witcher":return v.a;case"drStone":return b.a;default:return}}(R),preload:"true",loop:!0}),V?"left"===Z?r.a.createElement(ae,{LoadTenMessages:re,createNewChat:o,logout:c,setChatIndex:function(e){D(e),ee("right")},setSong:H,updAudio:ce,UpdateUserData:ne}):r.a.createElement(ie,{LoadTenMessages:re,SendMessage:oe,GoBack:ee}):r.a.createElement(r.a.Fragment,null,r.a.createElement(ae,{LoadTenMessages:re,createNewChat:o,logout:c,setChatIndex:D,setSong:H,updAudio:ce,UpdateUserData:ne}),r.a.createElement(ie,{LoadTenMessages:re,SendMessage:oe})))))},Ee=a(60),be=a(67),we=a(21),ye=a(121),Oe=(a(114),a(39)),ke=a(47),je=a(87);a(189);function xe(e){var t=e.loginOrRegister,a=Object(n.useState)(""),c=Object(i.a)(a,2),o=c[0],l=c[1],u=Object(n.useState)(""),m=Object(i.a)(u,2),h=m[0],f=m[1],p=Object(n.useState)(""),v=Object(i.a)(p,2),E=v[0],b=v[1],w=Object(n.useState)(!1),y=Object(i.a)(w,2),O=y[0],k=y[1],j=Object(n.useState)(!1),x=Object(i.a)(j,2),C=x[0],S=x[1];function N(){return o.length>0&&E.length>0}function I(e,a){var n;return s.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return k(!0),setTimeout((function(){return console.log()}),1e3),r.prev=2,n="login"===e?{email:o,password:E}:{googleToken:a},r.next=6,s.a.awrap(t(n,e));case 6:if("duplicate"!==r.sent){r.next=9;break}throw new Error("Please finish another session before starting a new one.");case 9:S(!0),r.next=15;break;case 12:r.prev=12,r.t0=r.catch(2),setTimeout((function(){k(!1),r.t0.toString().includes("Failed to fetch")?f("No response from the server"):f(r.t0.message)}),1e3);case 15:case"end":return r.stop()}}),null,null,[[2,12]])}return r.a.createElement(r.a.Fragment,null,C?r.a.createElement(d.a,{to:"/app"}):r.a.createElement(ke.a,{className:"Login"},r.a.createElement(ke.a.Header,null," Sign In "),r.a.createElement(ke.a.Body,null,r.a.createElement("form",{onSubmit:function(e){return s.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),t.next=3,s.a.awrap(I("login"));case 3:case"end":return t.stop()}}))}},r.a.createElement(H.a,{controlId:"email"},r.a.createElement(Oe.a,null,"Email"),r.a.createElement(ye.a,{autoFocus:!0,type:"email",value:o,onChange:function(e){return l(e.target.value)}})),r.a.createElement(H.a,{controlId:"password"},r.a.createElement(Oe.a,null,"Password"),r.a.createElement(ye.a,{value:E,onChange:function(e){return b(e.target.value)},type:"password"})),h?r.a.createElement(H.a,null,r.a.createElement("div",{className:"tc dark-red"},h)):r.a.createElement(r.a.Fragment,null),r.a.createElement(H.a,{className:"tc"},r.a.createElement("a",{className:"tc",href:"/rocket-chat-front/#/register"},"Not signed up yet?"),r.a.createElement("div",{style:{marginTop:"15px"}})),r.a.createElement(g.a,{block:!0,variant:N()?"primary":"secondary",disabled:!N()||O,type:"submit"},O?r.a.createElement(je.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}):"Login")))))}function Ce(e){var t=e.loginOrRegister,a=Object(n.useState)(""),c=Object(i.a)(a,2),o=c[0],l=c[1],u=Object(n.useState)(""),m=Object(i.a)(u,2),h=m[0],f=m[1],p=Object(n.useState)(""),v=Object(i.a)(p,2),E=v[0],b=v[1],w=Object(n.useState)(!1),y=Object(i.a)(w,2),O=y[0],k=y[1],x=Object(n.useState)(""),C=Object(i.a)(x,2),S=C[0],N=C[1],I=Object(n.useState)(!1),A=Object(i.a)(I,2),M=A[0],U=A[1],T=Object(n.useState)(0),F=Object(i.a)(T,2),L=F[0],q=F[1];function B(){return o.length>0&&L>1&&h.length}return r.a.createElement(r.a.Fragment,null,M?r.a.createElement(d.a,{to:"/app"}):r.a.createElement(ke.a,{className:"Login"},r.a.createElement(ke.a.Header,null," Register "),r.a.createElement(ke.a.Body,null,r.a.createElement("form",{onSubmit:function(e){return s.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return e.preventDefault(),k(!0),setTimeout((function(){return console.log()}),1e3),a.prev=3,a.next=6,s.a.awrap(t({username:h,email:o,password:E},"register"));case 6:return a.next=8,s.a.awrap(U(!0));case 8:a.next=13;break;case 10:a.prev=10,a.t0=a.catch(3),setTimeout((function(){k(!1),a.t0.toString().includes("Failed to fetch")?N("No response from the server"):N(a.t0.message)}),500);case 13:case"end":return a.stop()}}),null,null,[[3,10]])}},r.a.createElement(H.a,{controlId:"name"},r.a.createElement(Oe.a,null,"Name"),r.a.createElement(ye.a,{autoFocus:!0,type:"text",value:h,onChange:function(e){return f(e.target.value)}})),r.a.createElement(H.a,{controlId:"email"},r.a.createElement(Oe.a,null,"Email"),r.a.createElement(ye.a,{autoFocus:!0,type:"email",value:o,onChange:function(e){return l(e.target.value)}})),r.a.createElement(H.a,{controlId:"password"},r.a.createElement(Oe.a,null,"Password"),r.a.createElement(ye.a,{style:{borderBottom:"3px solid ".concat(j[L].color)},value:E,onChange:function(e){var t=0,a=e.target.value;a.length>3&&t++,a.length>5&&t++,a.match(/\d+/g)&&t++,q(t),b(a)},type:"password"})),S?r.a.createElement(H.a,null,r.a.createElement("div",{className:"tc dark-red"},S)):r.a.createElement(r.a.Fragment,null),r.a.createElement(g.a,{block:!0,variant:B()?"primary":"secondary",disabled:!B()||O,type:"submit"},O?r.a.createElement(je.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}):"Register")))))}a(190);var Se=a(136);function Ne(e){var t=e.isFAQ;return r.a.createElement("div",null,r.a.createElement(Y.a.Container,{id:"left-tabs-example",defaultActiveKey:t?x[0].question:C[0].version},r.a.createElement(Se.a,{className:"bg-black-90 align-content-start"},r.a.createElement(G.a,{md:4,lg:4,xl:4,sm:12,xs:12},r.a.createElement(we.a,{variant:"pills",className:"flex-column b--solid b--light-blue"},t?x.map((function(e){return r.a.createElement(we.a.Item,{key:e.question},r.a.createElement(we.a.Link,{eventKey:e.question},e.question))})):C.map((function(e){return r.a.createElement(we.a.Item,{key:e.version},r.a.createElement(we.a.Link,{eventKey:e.version},e.version))})))),r.a.createElement(G.a,{sm:12,xs:12,md:8,xl:8,lg:8},r.a.createElement(Y.a.Content,{className:"white ma3"},t?x.map((function(e){return r.a.createElement(Y.a.Pane,{eventKey:e.question,key:e.answer},e.answer)})):C.map((function(e){return r.a.createElement(Y.a.Pane,{key:e.changes[0],eventKey:e.version},r.a.createElement("ul",null,e.changes.map((function(e){return r.a.createElement("li",{key:e},e)}))))})))))))}var Ie=function(e){var t=e.loginOrRegister,a=e.path;return r.a.createElement("div",{className:"/faq"===a||"/release"===a?"welcome-page overflow-hidden":"welcome-page overflow-auto"},r.a.createElement(be.a,{bg:"dark",variant:"dark",expand:"lg"},r.a.createElement(be.a.Brand,{href:"/rocket-chat-front/#/login"},"Rocket-Chat v0.2 BETA"),r.a.createElement(be.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(be.a.Collapse,{id:"basic-navbar-nav"},r.a.createElement(we.a,{className:"mr-auto "},r.a.createElement(we.a.Link,{href:"/rocket-chat-front/#/faq"},"FAQ"),r.a.createElement(we.a.Link,{href:"/rocket-chat-front/#/release"},"Release notes")),r.a.createElement(we.a,null,r.a.createElement(we.a.Link,{href:"/rocket-chat-front/#/login"},"Sign in"),r.a.createElement(we.a.Link,{href:"/rocket-chat-front/#/register"},"Register")))),r.a.createElement(J.a,{variant:"warning",className:"tc ma0"},"During the beta, please don't use your real email and don't send important messages over the chat!",r.a.createElement("br",null),r.a.createElement("strong",null,"If you had an account before, please create a new one,thanks!",r.a.createElement("br",null),"Make sure to check out our ",r.a.createElement("a",{href:"/rocket-chat-front/#/release"},"release notes"),"!")),{"/login":r.a.createElement(xe,{loginOrRegister:t}),"/register":r.a.createElement(Ce,{loginOrRegister:t}),"/faq":r.a.createElement(Ne,{isFAQ:!0}),"/release":r.a.createElement(Ne,{isFAQ:!1})}[a],r.a.createElement("img",{src:"https://dramarocket.com/wp-content/uploads/2018/01/icon-redrocket-2.png",alt:"logo",className:"center"}))},Ae=a(137),Me=r.a.createContext({user:{},chats:[]});var Ue=function(){var e=Object(n.useState)(null),t=Object(i.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)([]),l=Object(i.a)(o,2),u=l[0],m=l[1],h=Object(n.useState)(null),g=Object(i.a)(h,2),f=g[0],p=g[1];function v(e){var t,a;return s.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,s.a.awrap(S(e));case 3:return t=n.sent,a=U(t,e),m(a),n.abrupt("return","ok");case 9:n.prev=9,n.t0=n.catch(0),alert("error loading chats");case 12:case"end":return n.stop()}}),null,null,[[0,9]])}function E(e,t){var a,n;return s.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,s.a.awrap(I(e,t));case 3:if(!(a=r.sent)){r.next=11;break}if(!(n=a).isOnline){r.next=8;break}return r.abrupt("return","duplicate");case 8:return c(n),r.next=11,s.a.awrap(v(n.userId));case 11:return r.abrupt("return","ok");case 14:throw r.prev=14,r.t0=r.catch(0),console.log(r.t0),r.t0;case 18:case"end":return r.stop()}}),null,null,[[0,14]])}window.addEventListener("beforeunload",(function(e){A(a.userId),b()}));var b=function(){f.invoke("UserWentOfflineOrOnline",!1,a.userId).then((function(){return f.stop()})).catch((function(e){return console.log(e)}))},y=function(){try{var e=Ae.a.auth2.getAuthInstance();e.signOut().then(e.disconnect())}catch(t){console.log("Not a googler!")}};return r.a.createElement(fe.ToastProvider,null,r.a.createElement(Ee.a,{className:"rocket"},r.a.createElement(d.d,null,r.a.createElement(d.b,{path:"/app"},r.a.createElement(Me.Provider,{value:{user:a,chats:u}},r.a.createElement(ve,{setHubConnection:p,setUser:c,setChats:m,SendMessage:function(e,t){var n=t,r=e;return function(e){f.invoke("SendDirectMessage",a.userId,r,e).catch((function(e){return console.log(e)})),m((function(t){var a=Object.assign([],t),r=a[n];return r.msg.push(new w.Message({id:0,message:e})),a.splice(n,1),a.unshift(r),a}))}},logout:function(){return c(null),b(),p(null),void y()},createNewChat:function(e,t,n){console.log(n),f.invoke("ChatWithUserWasCreated",a.userId,e,{chatId:e,chatName:a.userName,image:a.imageUrl}),m((function(a){var r=Object.assign([],a);return r.push({id:e,image:n,name:t,msg:[]}),r}))}}))),r.a.createElement(d.b,{path:"/register"},r.a.createElement(Ie,{path:"/register",loginOrRegister:E})),r.a.createElement(d.b,{path:"/faq"},r.a.createElement(Ie,{path:"/faq"})),r.a.createElement(d.b,{path:"/release"},r.a.createElement(Ie,{path:"/release"})),r.a.createElement(d.b,null,r.a.createElement(Ie,{path:"/login",loginOrRegister:E})))))},Te=(a(191),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function Fe(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o.a.render(r.a.createElement(Ue,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/rocket-chat-front",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/rocket-chat-front","/service-worker.js");Te?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Fe(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):Fe(t,e)}))}}()}},[[144,1,2]]]);
//# sourceMappingURL=main.e68de624.chunk.js.map