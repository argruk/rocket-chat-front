{"version":3,"sources":["sounds/notification.mp3","sounds/lol.mp3","sounds/dr_stone_ending.mp3","Components/MainAppWindow/Modals/SwitchToMobileModal.js","Components/ChatWindow/Message/MessageIF.js","Constants/Const.js","Helpers/ApiFetcher.js","Helpers/ProcessData.js","Components/Settings/Modals/AudioSettingsModal.js","Components/Settings/Modals/AddContactModal.js","Components/Settings/Modals/Forms/ProfileChangeForm.js","Components/Settings/Modals/Forms/ToggleSwitch.js","Components/Settings/Modals/Forms/NotificationsForm.js","Components/Settings/Modals/MyAccountModal.js","Components/Settings/Settings.js","Components/Friends/Friends.js","Components/MainAppWindow/SubWindows/ScreenWithFriends.js","Helpers/Scroller.js","Components/InputField/Input.js","Components/ChatWindow/Panel/ChatPanel.js","Components/ChatWindow/ChatWindow.js","Components/MainAppWindow/SubWindows/ScreenWithChats.js","Components/Notifications/Notifications.js","Helpers/HubConnection.js","Components/MainAppWindow/MainAppWindow.js","Components/Welcome/Submodules/Login.js","Components/Welcome/Submodules/Register.js","Components/Welcome/Submodules/FAQorReleaseInfo.js","Components/Welcome/Submodules/EmailVerification.js","Components/Welcome/WelcomePage.js","Helpers/TokenValidation.js","App.js","serviceWorker.js","index.js"],"names":["module","exports","SwitchToMobile","setIsMobile","useState","visible","setVisible","handleClick","value","Modal","show","onHide","centered","Body","closebutton","className","Button","variant","onClick","style","marginLeft","MessageIF","dbId","id","message","dateTime","this","BackendLink","process","TokenSignature","AESKEY","AESIV","SettingsList","SongList","PasswordStrLevels","str","color","ROUTES","FAQDATA","question","answer","RELEASEDATA","version","changes","GetAllChatsByUserId","userId","a","token","jwt","sign","fetch","method","headers","body","JSON","stringify","chats","json","FetchLastMessagesByChatId","chatId","user","totalMessages","messagesToState","messages","forEach","msgDisplayId","push","messageText","createdDate","TryLoginOrRegister","loginData","endpoint","result","status","CheckForResponseCodeAndThrow","text","emailToAdd","console","log","res","sound","newchat","newmessage","connection","SetUserOffline","code","error","Error","ProcessChats","chatsToState","chat","chatToAdd","lastMessage","image","friendImageUrl","isOnline","lastMessagesAreFetched","name","friendUserName","msg","FindChatIndexByChatId","chatData","i","AddTenMessagesToState","currentChat","length","CheckIfChatIdMatchIsPresent","chatList","chatIdList","cache","output","found","AudioSettingsModal","handleClose","updateAudio","chooseSong","setValue","song","setSong","changeRadioColor","isOn","Dropdown","Toggle","Menu","map","item","Item","key","changeSong","ToggleButtonGroup","type","onChange","val","ToggleButton","Boolean","AddContactModal","createNewChat","email","setEmail","setError","useContext","UserChatsContext","Form","onSubmit","event","preventDefault","SendNewChatData","then","userName","catch","err","toString","includes","Group","controlId","Label","Control","placeholder","target","Text","FormGroup","disabled","ProfileChangeForm","UpdateUserData","input","setInput","showAlert","setShowAlert","validateForm","updatedData","isImageUrl","Row","Col","e","Alert","onClose","dismissible","ToggleSwitch","activeSwitches","handleChange","title","setTitle","useEffect","nameSplit","match","slice","finalTitle","word","CheckIfStartsWithLower","string","first","charAt","toLowerCase","toUpperCase","substring","marginRight","checked","onColor","onHandleColor","handleDiameter","uncheckedIcon","checkedIcon","boxShadow","activeBoxShadow","height","width","NotificationsForm","notificationSettings","setActiveSwitches","newState","newChatReceived","newMessageReceived","connectionChanged","UpdateNotificationSettings","alignContent","Object","keys","index","MyAccountModal","Tabs","defaultActiveKey","Tab","eventKey","imageUrl","Figure","Image","roundedCircle","alt","src","Caption","float","Settings","logout","seen","modal","setModal","size","xmlns","viewBox","d","fill","Friends","clickOnChat","setChatIndex","MainChatWindowContext","chatIndex","isMobile","unSelected","margin","backgroundColor","selected","marginBottom","marginTop","imgUrl","letter","justify","ellipsis","active","LeftPart","LoadTenMessages","updAudio","ScrollChatToBottom","chatWindow","document","getElementsByClassName","maxScrollTop","scrollHeight","clientHeight","scrollTop","useStyles","makeStyles","theme","root","padding","display","alignItems","flex","wordWrap","iconButton","divider","Input","onSendClick","classes","submitIsValid","trim","Paper","component","setTimeout","OverlayTrigger","trigger","placement","overlay","Popover","showPreview","set","onSelect","emoji","native","IconButton","aria-label","InputBase","rowsMax","multiline","inputProps","Divider","orientation","ChatPanel","ChatWindow","onSend","loadTen","GoBack","LoadMoreMessages","RightPart","SendMessage","NewChat","url","notification","autoLoad","playStatus","Sound","PLAYING","NewMessage","OnlineOrOffline","online","ReconnectFail","isLast","nextTime","timer","setTimer","interval","setInterval","clearInterval","CryptoJS","require","setUser","setChats","setHub","PopupNotification","setChatId","hubConnect","HubConnectionBuilder","withUrl","build","prev","loc_user","start","invoke","onclose","l_user","Reconnect","oldChats","newChats","on","decrypted","AES","decrypt","enc","Base64","parse","iv","Utf8","prevState","neededChatIndex","updatedChats","assign","neededChat","splice","unshift","chatIds","checkMatch","userChatIds","updatedChat","chatName","time","userNotificationSettings","Promise","resolve","reject","React","createContext","MainAppWindow","setHubConnection","detectMobile","useMobileDetect","useToasts","addToast","removeToast","redirect","setRedirect","partToShow","setPartToShow","useCookies","removeCookie","createHubConnection","PopUpNotification","hub","content","appearance","removeTimer","autoDismiss","l_hub","newUser","shouldSetChatId","currentChatsState","numberOfMessages","shouldScrollUp","alert","enable","getElementsByTagName","play","pause","SendMessageAndSetIndex","SendMessageWithChatData","Provider","to","songname","witcher","drStone","setSongMP3","preload","loop","Login","loginOrRegister","password","setPassword","isConnecting","setIsConnecting","success","setSuccess","responseGoogle","response","handleLogin","id_token","param","Card","Header","FormLabel","FormControl","autoFocus","href","clientId","buttonText","onSuccess","onFailure","cookiePolicy","block","Spinner","as","animation","role","aria-hidden","Register","setName","passwordStrength","setPasswordStrength","username","swal","borderBottom","currentStr","FAQorReleaseInfo","isFAQ","Container","md","lg","xl","sm","xs","Nav","qa","Link","vc","Content","Pane","change","EmailedVerified","done","newVal","WelcomePage","path","isLoading","spinner","Navbar","bg","expand","Brand","aria-controls","Collapse","ValidateToken","verify","App","hubConnection","cookies","setCookie","setIsLoading","isLoggedIn","setLoggedIn","GetChats","ValidateAndSetUser","parseInt","userToken","maxAge","window","addEventListener","notifyAboutLogout","stop","TryToDoGoogleLogout","auth2","gapi","getAuthInstance","signOut","disconnect","l_chatIndex","l_chatId","msgText","ciphertext","encrypt","Date","route","isLocalhost","location","hostname","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","onUpdate","ReactDOM","render","getElementById","URL","origin","contentType","get","indexOf","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.d6c93097.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/notification.56a9110c.mp3\";","module.exports = __webpack_public_path__ + \"static/media/lol.f8b7a2e4.mp3\";","module.exports = __webpack_public_path__ + \"static/media/dr_stone_ending.470614e2.mp3\";","import React, {useState} from 'react';\nimport Modal from \"react-bootstrap/Modal\";\nimport Button from \"react-bootstrap/Button\";\n\nexport default function SwitchToMobile({setIsMobile}) {\n\n    const [visible, setVisible] = useState(true);\n\n\n    const handleClick = (value) =>{\n        setIsMobile((value));\n        setVisible(false);\n    };\n    return (\n        <>\n            <Modal show={visible} onHide={()=>setVisible(false)} centered >\n                <Modal.Body closebutton = {'true'} className={'tc'} >\n                    <h3>Swtich to mobile version</h3>\n                    <div >\n                        <Button variant=\"primary\" onClick = {()=>handleClick(true)}>Yes</Button>\n                        <Button style = {{marginLeft:'10%'}} variant=\"secondary\"  onClick = {()=>handleClick(false)}>No</Button>\n                    </div>\n                </Modal.Body>\n            </Modal>\n        </>\n    );\n}","export class MessageIF {\n    constructor({dbId,id,message,dateTime}) {\n        this.dbId = dbId;\n        this.id = id;\n        this.message = message;\n        this.dateTime = dateTime;\n    }\n}","export const BackendLink = process.env.REACT_APP_APILINK;\nexport const TokenSignature = process.env.REACT_APP_TOKEN_SIGNATURE;\nexport const AESKEY = process.env.REACT_APP_AESKEY;\nexport const AESIV = process.env.REACT_APP_AESIV;\n\nexport const SettingsList = ['Audio','Add Contact','My Account','Logout'];\nexport const SongList = ['witcher','drStone'];\nexport const PasswordStrLevels = [{str:'weak',color:'red'},{str:'weakish',color:'darkorange'},{str:'medium',color:'#E1CB0C'},{str:'okay',color:'springgreen'},{str:'strong',color:'green'}];\n\nexport const ROUTES = ['/faq','/release','/vsuccess','/vfailed'];\n\nexport const FAQDATA = [{question:'Q: What do I do here?',answer:'A: You send messages to other people, could you imagine!!!'},\n    {question:'Q: How to get started?',answer:'A: Please register, then add other people and talk to them as much as you want. Please mind the warning above when you submit any data.'},\n    {question:'Q: Who are the creators of this miracle?',answer:'A: Bohdan Boss and Artem Daddy :))'},\n    {question:'Q: What are future plans for this project?',answer:'A: Show WhatsApp and Telegram how to make good apps...'},\n    {question:'Q: Why can I not send emoji without text on PC?',answer:'A: This is a known issue and might be fixed later, hold tight!'},\n    {question:'Q: Are my messages 100% secure?',answer:'A: Let\\'s say sending credit card details is not a good idea, but gossips are totally fine.'},\n    {question:'Q: How can I suggest improvements?',answer:'A: Just start a chat with one of the Creators and show us your ideas.'},\n    {question:'Q: Lorem Ipsum?',answer:'A: Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.'}\n\n    ];\n\nexport const RELEASEDATA = [\n    {version: 'v0.3.2',changes: ['Improved chat window UI and built-in emoji']},\n    {version: 'v0.3.1',changes: ['Fix login and cookie related bugs']},\n    {version: 'v0.3',changes: ['Security updates','Notification settings','More efficient live communication',\n            'Email verification','Login with Google','Bugfixes and other minor improvements','Semi-advanced security for messages', 'Added cookies support']},\n\n    {version: 'v0.2.1',changes: ['Bugfixes and UI improvements']},\n    {version: 'v0.2',changes: ['Chats are sorted based on last message','Automatic reconnection in case of disconnect',\n            'Online/Offline status of users with notifications','Account settings with live update','Emoji for desktop users','Bugfixes and other minor improvements']},\n    {version:'v0.1',changes:['Registration/Login','Live messages','Message history is saved and is reloaded on login','Can add others to contact list','Audio settings']},\n    ];\n","import {MessageIF} from \"../Components/ChatWindow/Message/MessageIF\";\nimport {BackendLink, TokenSignature} from \"../Constants/Const\";\nimport jwt from'jsonwebtoken';\n\nexport async function GetAllChatsByUserId(userId) {\n    try {\n        let token = jwt.sign({userId}, TokenSignature);\n        let chats = await fetch(`${BackendLink}/api/getallchats`, {\n            method: 'post',\n            headers: {'Content-type': 'application/json'},\n            body: JSON.stringify({token})\n        });\n        chats = await chats.json();\n        return chats;\n    } catch (e) {\n        throw e;\n    }\n}\n\n//Sends a request to the server and returns an array of messages received from there\nexport async function FetchLastMessagesByChatId(chatId,user,totalMessages) {\n    let messagesToState = [];\n    try {\n        let token = jwt.sign({chatId,totalMessages}, TokenSignature);\n        let messages = await fetch(`${BackendLink}/api/getlastmessages`, {\n            method: 'post',\n            headers: {'Content-type': 'application/json'},\n            body: JSON.stringify({token})\n        });\n        messages = await messages.json();\n        await messages.forEach(message =>{\n            let msgDisplayId = message.userId === user.userId ? 0 : 1;\n            messagesToState.push(new MessageIF({id:msgDisplayId,message:message.messageText,dateTime:message.createdDate}));\n        });\n        return messagesToState;\n    }\n    catch (error) {\n        throw error;\n    }\n}\n\nexport async function TryLoginOrRegister (loginData,endpoint) {\n    try {\n\n        let result = await fetch(`${BackendLink}/api/${endpoint}`, {\n            method: 'post',\n            headers: {'Content-type': 'application/json'},\n            body: JSON.stringify(loginData)\n        });\n        let status = result.status;\n        result = await result.json();\n        CheckForResponseCodeAndThrow(status,result.text);\n        return result;\n    } catch (e) {\n        throw e;\n    }\n}\n\nexport async function SendNewChatData (userId,emailToAdd) {\n    try {\n        console.log(BackendLink);\n        let token = jwt.sign({userId,emailToAdd}, TokenSignature);\n        let res = await fetch(`${BackendLink}/api/addchat`, {\n            method: 'post',\n            headers: {'Content-type': 'application/json'},\n            body: JSON.stringify({token})\n        });\n\n        let status = res.status;\n        res = await res.json();\n        CheckForResponseCodeAndThrow(status,res.text);\n        return res;\n\n    } catch (e) {\n        throw e;\n    }\n}\nexport async function UpdateNotificationSettings (userId,sound,newchat,newmessage,connection) {\n    try {\n        let token = jwt.sign({userId,sound,newchat,newmessage,connection}, TokenSignature);\n        let res = await fetch(`${BackendLink}/api/settingsapply`, {\n            method: 'post',\n            headers: {'Content-type': 'application/json'},\n            body: JSON.stringify({token})\n        });\n        let status = res.status;\n        CheckForResponseCodeAndThrow(status,res.text);\n        return 'ok';\n\n    } catch (e) {\n        throw e;\n    }\n}\n\nexport async function SetUserOffline(userId) {\n    let token = jwt.sign({userId}, TokenSignature);\n    let res = await fetch(`${BackendLink}/api/disconnect`, {\n        method: 'post',\n        headers: {'Content-type': 'application/json'},\n        body: JSON.stringify({token})\n    });\n    if(res.status === 404){\n        console.log('Couldnt find a user');\n    }\n}\n\nfunction CheckForResponseCodeAndThrow(code,error){\n    switch (code) {\n        case 400:\n            throw new Error(error);\n        case 500 :\n            throw new Error('Server error,try again later');\n        case 404 :\n            throw new Error('Server error,try again later');\n        default:\n            break;\n    }\n}","import {FetchLastMessagesByChatId} from \"./ApiFetcher\";\nimport {MessageIF} from \"../Components/ChatWindow/Message/MessageIF\";\n\nexport function ProcessChats (chats,userId) {\n    let chatsToState = [];\n\n    chats.forEach(chat=>{\n        let msgDisplayId,chatToAdd;\n        console.log(chat);\n        if(chat.lastMessage) {\n            msgDisplayId = chat.lastMessage.userId === userId ? 0 : 1;\n            const message = chat.lastMessage;\n            chatToAdd = {id:chat.chatId,image:chat.friendImageUrl,isOnline:chat.isOnline,lastMessagesAreFetched:false, name: chat.friendUserName,msg:[new MessageIF({id:msgDisplayId,message:message.messageText,dateTime:message.createdDate})]};\n        }\n        else{\n            // lastMessagesAreFetched value doesn't matter in this case,as the chat is empty and must be updated live time anyway\n            chatToAdd = {id:chat.chatId,image:chat.friendImageUrl,isOnline:chat.isOnline,lastMessagesAreFetched:false, name: chat.friendUserName,msg:[]};\n        }\n        chatsToState.push(chatToAdd);\n    });\n    return chatsToState;\n}\n\n//loop until u find chat with ID equal to given, return index\nexport const FindChatIndexByChatId = (chatId,chatData) =>{\n    let i = 0;\n    for(let chat of chatData){\n        if(chat.id === chatId) {\n            return i;\n        }\n        i++;\n    }\n    return -1;\n};\n\nexport const AddTenMessagesToState = async (id,user,currentChat)=>{\n    try {\n        let messages = await FetchLastMessagesByChatId(id, user, currentChat.msg.length);\n        currentChat.msg.forEach((msg) => {\n            messages.push(msg);\n        });\n        currentChat.lastMessagesAreFetched = true;\n        currentChat.msg = [];\n        currentChat.msg = [...messages];\n\n        return currentChat;\n    }\n    catch (e) {\n        throw e;\n    }\n};\n\n// O(n) function to find a match in 2 arrays\nexport const CheckIfChatIdMatchIsPresent = (chatList,chatIdList) =>{\n    let cache = {};\n    let output = {found:false};\n    chatList.forEach(chat=>{\n            const id = chat.id;\n            //value doesnt matter here\n            cache[id] = 1;\n        }\n    );\n    for(let chatId of chatIdList){\n        if(chatId in cache){\n            output.found = true;\n            output.id = chatId;\n            break;\n        }\n    }\n    return output;\n};","import React,{useState} from 'react';\nimport Modal from \"react-bootstrap/Modal\";\nimport ToggleButtonGroup from \"react-bootstrap/ToggleButtonGroup\";\nimport ToggleButton from \"react-bootstrap/ToggleButton\";\nimport Dropdown from \"react-bootstrap/Dropdown\";\nimport {SongList} from \"../../../Constants/Const\";\n\n\n// TODO use gloabl state instead of local\nfunction AudioSettingsModal({show,handleClose,updateAudio,chooseSong}) {\n    const [value, setValue] = useState(0);\n    const [song, setSong] = useState('');\n\n    const handleChange = (val) => {\n        setValue(val);\n        if(val && song){\n            updateAudio(true);\n        }\n        else if(!val) {\n            updateAudio(false);\n        }\n    };\n\n    const changeRadioColor = (isOn) =>{\n        return isOn ? 'primary' : 'secondary';\n    };\n    const changeSong = (item) =>{\n        setValue(0);\n        chooseSong(item);\n        setSong(item);\n    };\n    return (\n        <>\n        <Modal show={show} onHide={handleClose} centered>\n            <Modal.Body>\n                <h3>Audio settings</h3>\n                <h5>Current song</h5>\n                <Dropdown >\n                    <Dropdown.Toggle variant=\"success\" id=\"dropdown-basic\">\n                        {song\n                            ? <>{song}</>\n                            :<>Choose song </>\n                        }\n                    </Dropdown.Toggle>\n                    <Dropdown.Menu>\n                        {SongList.map((item)=>(\n                                <Dropdown.Item key = {item} onClick = {()=>changeSong(item)}>{item}</Dropdown.Item>\n                        ))}\n                    </Dropdown.Menu>\n                </Dropdown>\n                <h4> Playback </h4>\n                    <ToggleButtonGroup type=\"radio\" name=\"options\" value={value} onChange={handleChange}>\n                        <ToggleButton variant ={changeRadioColor(Boolean(value))} value={1} >On</ToggleButton>\n                        <ToggleButton variant ={changeRadioColor(!Boolean(value))}  value={0}>Off</ToggleButton>\n                    </ToggleButtonGroup>\n            </Modal.Body>\n        </Modal>\n        </>\n    );\n}\nexport default AudioSettingsModal;","import React, {useContext, useState} from 'react';\nimport Modal from \"react-bootstrap/Modal\";\nimport Form from \"react-bootstrap/Form\";\nimport Button from \"react-bootstrap/Button\";\nimport {FormGroup} from \"react-bootstrap\";\nimport {UserChatsContext} from \"../../../App\";\nimport {SendNewChatData} from \"../../../Helpers/ApiFetcher\";\n\n\n\nfunction AddContactModal({show,handleClose,createNewChat}) {\n\n    const [email, setEmail] = useState(\"\");\n    const [error, setError] = useState(\"\");\n\n    const {user} = useContext(UserChatsContext);\n    const userId = user? user.userId : 0;\n\n    const handleSubmit = (event) => {\n        event.preventDefault();\n        SendNewChatData(userId,email)\n            .then(res=>{\n                if(res){\n                    const {chatId,userName,friendImageUrl} = res;\n                    createNewChat(chatId,userName,friendImageUrl);\n                    handleClose();\n                }\n            })\n            .catch(err=>{\n                if(err.toString().includes('Failed to fetch')){\n                    setError('No response from the server')\n                }else {\n                    setError(err.message);\n                }\n            });\n    };\n        //if no error add a new chat in main window\n    const validateForm = () => {\n        return email.length > 0;\n    };\n    return (\n        <>\n            <Modal show={show} onHide={handleClose} centered>\n                <Modal.Body>\n                    <h3>Add contact </h3>\n                    <Form onSubmit={handleSubmit}>\n                        <Form.Group controlId=\"formBasicEmail\">\n                            <Form.Label>Email address</Form.Label>\n                            <Form.Control type=\"email\" placeholder=\"Enter email\" onChange={(event)=>setEmail(event.target.value)} />\n                            <Form.Text className=\"text-muted\">\n                                Ask creators about their current emails.\n                            </Form.Text>\n                        </Form.Group>\n                        {error\n                            ? <FormGroup>\n                                <div className='dark-red'>{error}</div>\n                            </FormGroup>\n                            : <></>\n                        }\n                        <Button variant=\"primary\" type=\"submit\" disabled={!validateForm()}>\n                            Add friend\n                        </Button>\n                    </Form>\n                </Modal.Body>\n            </Modal>\n        </>\n    );\n}\nexport default AddContactModal;","import React, { useState} from 'react';\nimport Button from \"react-bootstrap/Button\";\nimport Form from \"react-bootstrap/Form\";\nimport Col from \"react-bootstrap/Col\";\nimport Alert from \"react-bootstrap/Alert\";\nimport isImageUrl from 'is-image-url';\n\nfunction ProfileChangeForm({type,UpdateUserData}) {\n\n    const[input,setInput] = useState('');\n    const[showAlert,setShowAlert] = useState({show:false,type:''});\n\n\n    function handleSubmit(event) {\n        event.preventDefault();\n        let updatedData = {type,value:input};\n\n        //if link to image is broken show error else update data\n        if(type === 'image' && !isImageUrl(input)) {\n            setShowAlert({show:true,type:'danger'})\n        }\n        else{\n            UpdateUserData(updatedData.type,updatedData.value);\n            setShowAlert({show:true,type:'success'});\n        }\n        setInput('');\n    }\n\n    function validateForm() {\n        return input.length > 2;\n    }\n\n    return (\n        <>\n            <form onSubmit = {handleSubmit}>\n                <Form.Row>\n                    <Col>\n                        <Form.Control placeholder={'new ' + type} value={input} onChange={e => setInput(e.target.value)}/>\n                    </Col>\n                    <Col>\n                        <Button type=\"submit\" variant={!validateForm() ? 'secondary' : \"primary\"}\n                                disabled={!validateForm()}> Update!</Button>\n                    </Col>\n                    {showAlert.show\n                        ?\n                        <Alert variant={showAlert.type} onClose={() => setShowAlert({show:false,type:''})} dismissible className='ma2'>\n                            {showAlert.type === 'danger'\n                                ? `Your ${type} change failed with many errors!`\n                                : 'Your ' + type + ' was changed successfully!'\n                            }\n                        </Alert>\n                        :\n                        <div/>\n                    }\n\n                </Form.Row>\n            </form>\n        </>\n    );\n}\nexport default ProfileChangeForm;","import React, {useEffect, useState} from 'react';\nimport Switch from \"react-switch\";\n\n\nfunction ToggleSwitch({name,activeSwitches,handleChange}) {\n\n    const[title,setTitle] = useState('');\n\n    useEffect(()=>{\n        let nameSplit = name.match(/([A-Z]?[^A-Z]*)/g).slice(0,-1);\n        let finalTitle = '';\n        if(nameSplit){\n            for(let word of nameSplit){\n                word = CheckIfStartsWithLower(word);\n                finalTitle += (' ' + word);\n            }\n        }else{\n            name = CheckIfStartsWithLower(name);\n            finalTitle = name;\n        }\n        setTitle(finalTitle);\n    },);\n\n    const CheckIfStartsWithLower = (string)=>{\n        let first = string.charAt(0);\n        if (first === first.toLowerCase() && first !== first.toUpperCase())\n        {\n             return first.toUpperCase() + string.substring(1);\n        }\n        return string;\n    };\n    return (\n        <>\n            <div className='col-8' style={{marginRight:'5px'}}>\n                {title}\n            </div>\n            <div className='col-2'>\n                <label>\n                    <Switch  onChange={()=>handleChange(name)} checked={Boolean(activeSwitches[name])}\n                             onColor=\"#86d3ff\"\n                             onHandleColor=\"#2693e6\"\n                             handleDiameter={30}\n                             uncheckedIcon={false}\n                             checkedIcon={false}\n                             boxShadow=\"0px 1px 5px rgba(0, 0, 0, 0.6)\"\n                             activeBoxShadow=\"0px 0px 1px 10px rgba(0, 0, 0, 0.2)\"\n                             height={20}\n                             width={48}\n                    />\n                </label>\n            </div>\n        </>\n    );\n}\nexport default ToggleSwitch;","import React, {useContext, useState} from 'react';\nimport ToggleSwitch from \"./ToggleSwitch\";\nimport Button from \"react-bootstrap/Button\";\nimport {UserChatsContext} from \"../../../../App\";\nimport Alert from \"react-bootstrap/Alert\";\nimport {UpdateNotificationSettings} from \"../../../../Helpers/ApiFetcher\";\n\n\nfunction NotificationsForm({UpdateUserData,handleClose}) {\n\n    const {user} = useContext(UserChatsContext);\n\n    const[activeSwitches,setActiveSwitches] = useState(user.notificationSettings);\n    const[showAlert,setShowAlert] = useState({show:false,type:''});\n\n\n    function handleSubmit(event) {\n        event.preventDefault();\n        UpdateUserData('notifications',activeSwitches);\n        const {sound,newChatReceived,newMessageReceived,connectionChanged} = activeSwitches;\n        UpdateNotificationSettings(user.userId,sound,newChatReceived,newMessageReceived,connectionChanged)\n            .then(()=>setShowAlert({show:true,type:'success'}))\n            .catch(err=>{\n                setShowAlert({show:true,type:'danger'});\n                console.log(err);\n            })\n\n    }\n\n    function handleChange(val){\n        let newState = {...activeSwitches};\n        newState[val] = !newState[val];\n        setActiveSwitches(newState);\n    }\n    return (\n        <>\n            <form onSubmit = {handleSubmit}>\n                <label>\n                    <div className='container'>\n                        <div className='row h-auto' style={{alignContent:'start'}}>\n                            {\n                                Object.keys(activeSwitches).map((key, index) => (\n                                    index === 0\n                                        ? <div key={key}/>\n                                        : <ToggleSwitch handleChange={handleChange} activeSwitches={activeSwitches}\n                                                        name={key} key={key}/>\n                                ))\n                            }\n                        </div>\n                    </div>\n                </label>\n                <br/>\n                {showAlert.show\n                    ?\n                    <Alert variant={showAlert.type} onClose={() => setShowAlert({show:false,type:''})} dismissible className='ma2'>\n                        {showAlert.type === 'danger'\n                            ? `Failed to save notification settings!`\n                            : 'Notification settings changed successfully!'\n                        }\n                    </Alert>\n                    :<div/>\n                }\n                <br/> <Button type={'submit'}> Save </Button>\n            </form>\n        </>\n    );\n}\nexport default NotificationsForm;","import React, {useContext} from 'react';\nimport Modal from \"react-bootstrap/Modal\";\nimport {UserChatsContext} from \"../../../App\";\nimport Figure from \"react-bootstrap/Figure\";\nimport Button from \"react-bootstrap/Button\";\nimport Tab from \"react-bootstrap/Tab\";\nimport Tabs from \"react-bootstrap/Tabs\";\nimport ProfileChangeForm from \"./Forms/ProfileChangeForm\";\nimport NotificationsForm from \"./Forms/NotificationsForm\";\n\nfunction MyAccountModal({show,handleClose,UpdateUserData}) {\n\n    const {user} = useContext(UserChatsContext);\n    return (\n        <>\n            <Modal show={show} onHide={handleClose} centered >\n                <Modal.Body>\n                    <h3>My Account</h3>\n                    <Tabs defaultActiveKey=\"Picture\" id=\"uncontrolled-tab-example\">\n                        <Tab eventKey=\"Picture\" title=\"Picture\">\n                            {\n                                user.imageUrl\n                                    ? <Figure >\n                                        <Figure.Image\n                                            roundedCircle = {true}\n                                            width={100}\n                                            height={120}\n                                            alt=\"profile picc\"\n                                            src={user.imageUrl}\n                                        />\n                                        <Figure.Caption>\n                                            Your profile picture.\n                                        </Figure.Caption>\n                                        <div><ProfileChangeForm UpdateUserData={UpdateUserData} type={'image'}/></div>\n                                    </Figure>\n                                    : <span className='ma2'> You have no pic<div><ProfileChangeForm UpdateUserData={UpdateUserData} type={'image'}/></div></span>\n                            }\n                        </Tab>\n                        <Tab eventKey=\"Name\" title=\"Name\">\n                            <div className='ma2 '>\n                                <h6>Your current name is <strong>{user.userName}</strong></h6>\n                                <ProfileChangeForm UpdateUserData={UpdateUserData} type={'name'}/>\n                            </div>\n                        </Tab>\n                        <Tab eventKey=\"Notifications\" title=\"Notifications\">\n                            <div className='ma2 '>\n                                <NotificationsForm UpdateUserData={UpdateUserData}/>\n                            </div>\n                        </Tab>\n                    </Tabs>\n                    <Button style = {{float:'right'}} onClick = {()=>handleClose()}>Close</Button>\n                </Modal.Body>\n            </Modal>\n        </>\n    );\n}\nexport default MyAccountModal;","import React,{useState} from 'react';\nimport Dropdown from \"react-bootstrap/Dropdown\";\nimport AudioSettingsModal from \"./Modals/AudioSettingsModal\";\nimport AddContactModal from \"./Modals/AddContactModal\";\nimport {SettingsList} from \"../../Constants/Const\";\nimport MyAccountModal from \"./Modals/MyAccountModal\";\n\n\n\nfunction Settings({updateAudio,logout,chooseSong,createNewChat,UpdateUserData}) {\n    const [modal, setModal] = useState({type:'',seen:false});\n\n    const handleClose = () => setModal({type:'',seen:false});\n    const handleShow = (type) => setModal({type:type,seen:true});\n\n    return (\n        <>\n        <Dropdown>\n            <Dropdown.Toggle variant=\"secondary\" size={'sm'} id=\"dropdown-basic\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path d=\"M0 0h24v24H0z\" fill=\"none\"/>\n                <path d=\"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z\"/>\n                </svg>\n            </Dropdown.Toggle>\n            <Dropdown.Menu>\n                {SettingsList.map((item,index)=>(\n                    (item ==='Logout')\n                        ?\n                        <Dropdown.Item key = {item} onClick = {logout}>{SettingsList[index]}</Dropdown.Item>\n                        :\n                        <Dropdown.Item key = {item} onClick = {()=>handleShow(SettingsList[index])} >{SettingsList[index]} </Dropdown.Item>\n                ))}\n            </Dropdown.Menu>\n        </Dropdown>\n            {\n                {\n                    'Add Contact': <AddContactModal show={modal.seen} handleClose={handleClose} createNewChat={createNewChat}/>,\n                    'Audio': <AudioSettingsModal show = {modal.seen} handleClose = {handleClose} updateAudio={updateAudio} chooseSong={chooseSong} />,\n                    'My Account' : <MyAccountModal show={modal.seen} handleClose={handleClose} UpdateUserData={UpdateUserData}/>,\n                    'Logout': <></>\n                }[modal.type]\n            }\n           </>\n\n    );\n}\nexport default Settings;","import React, {useContext} from 'react';\nimport './Friends.css';\nimport {ThemeProvider,Avatar,Row,ChatList,ChatListItem,Column,Title,Subtitle}\n    from '@livechat/ui-kit';\nimport 'status-indicator/styles.css'\n\nimport {UserChatsContext} from \"../../App\";\nimport {MainChatWindowContext} from \"../MainAppWindow/MainAppWindow\";\n\nfunction Friends({clickOnChat,setChatIndex}) {\n\n    const {chats} = useContext(UserChatsContext);\n    const {chatIndex,isMobile} = useContext(MainChatWindowContext);\n\n\n    const unSelected = {\n        margin: '2px',\n        backgroundColor: '#383838',\n        color: 'white'\n};\n    const selected = {\n        margin: '0px ',\n        marginBottom: '5px ',\n        marginTop: '5px ',\n        backgroundColor: 'black',\n        color: 'white'\n    };\n\n    const handleClick = (id,index) => {\n        clickOnChat(id,index,true);\n        setChatIndex(index);\n    };\n    return (\n        <ThemeProvider>\n            <ChatList className = {'scrollable'}>\n            {chats.map((chat,index) =>(\n                <div onClick={()=>handleClick(chat.id,index)} key = {chat.id} >\n                    <ChatListItem style = {(index === chatIndex && !isMobile) ? selected :unSelected } >\n                        {\n                            chat.image\n                                ?<Avatar imgUrl={chat.image}/>\n                                :<Avatar letter= {chat.name.charAt(0)} style={{color: 'black !important'}}/>\n                        }\n                        <Column>\n                            <Row justify>\n                                <Title ellipsis>{chat.name}</Title>\n                                <Subtitle style={{marginLeft:'5px'}} >{chat.isOnline\n                                    ? <status-indicator active ></status-indicator>\n                                    :<div/>}\n                                </Subtitle>\n                            </Row>\n                            <Subtitle ellipsis>{\n                                chat.msg.length > 0\n                                    ? chat.msg[chat.msg.length-1].message\n                                    : 'Say something'\n                                }\n                            </Subtitle>\n                        </Column>\n                    </ChatListItem>\n                </div>\n            ) )}\n            </ChatList>\n        </ThemeProvider>\n    );\n}\nexport default Friends;","import React, {useContext} from 'react';\nimport {MainChatWindowContext} from \"../MainAppWindow\";\nimport Settings from \"../../Settings/Settings\";\nimport Friends from \"../../Friends/Friends\";\n\nexport default function LeftPart({createNewChat,LoadTenMessages,updAudio,setSong,logout,setChatIndex,UpdateUserData}) {\n\n\n    const {isMobile} = useContext(MainChatWindowContext);\n\n    return (\n        <div className={ isMobile ? 'left-side col-12' : 'left-side col-4 col-sm-4 col-md-4 col-lg-2 col-xl-2'}>\n            <Settings createNewChat={createNewChat} updateAudio={updAudio} chooseSong={setSong} logout={()=>logout()} UpdateUserData={UpdateUserData}/>\n            <Friends clickOnChat={LoadTenMessages} setChatIndex = {setChatIndex}/>\n        </div>\n    );\n}\n","export const ScrollChatToBottom = () =>{\n    const chatWindow = document.getElementsByClassName(\"chat-panel\")[0];\n    const scrollHeight = chatWindow.scrollHeight;\n    const height = chatWindow.clientHeight;\n    const maxScrollTop = scrollHeight - height;\n    chatWindow.scrollTop = maxScrollTop > 0 ? maxScrollTop : 0;\n};","import React, {useEffect, useState} from 'react';\nimport OverlayTrigger from \"react-bootstrap/OverlayTrigger\";\nimport Popover from \"react-bootstrap/Popover\";\nimport { makeStyles } from '@material-ui/core/styles';\nimport Paper from '@material-ui/core/Paper';\nimport InputBase from '@material-ui/core/InputBase';\nimport Divider from '@material-ui/core/Divider';\nimport IconButton from '@material-ui/core/IconButton';\nimport SendIcon from '@material-ui/icons/Send';\nimport SentimentVeryDissatisfiedSharpIcon from '@material-ui/icons/SentimentVeryDissatisfiedSharp';\nimport CloudUploadIcon from '@material-ui/icons/CloudUpload';\nimport 'emoji-mart/css/emoji-mart.css'\nimport {Picker} from \"emoji-mart\";\nimport {ScrollChatToBottom} from \"../../Helpers/Scroller\";\n\nconst useStyles = makeStyles(theme => ({\n    root: {\n        padding: '2px 4px',\n        display: 'flex',\n        alignItems: 'center',\n    },\n    input: {\n        flex: 1,\n        wordWrap:'break-word'\n    },\n    iconButton: {\n        padding: 10,\n        height:'100%'\n    },\n    divider: {\n        margin: 4,\n        height:'100%'\n    },\n}));\n\nexport default function Input({onSendClick}) {\n    const classes = useStyles();\n    const[input,setInput] = useState('');\n\n\n    const onEmojiClick = (emoji) => {\n        const text = `${input}${emoji.native}`;\n        setInput(text);\n    };\n    const SendMessageToDatabaseAndScreen = () => {\n        onSendClick(input);\n        setInput('');\n        setTimeout(()=>{\n            ScrollChatToBottom();\n        },20);\n\n    };\n    const onTyping = (event)=>{\n        setInput(event.target.value);\n        ScrollChatToBottom();\n    };\n    const submitIsValid = () => {\n        return input.trim().length > 0;\n    };\n\n    return (\n        <Paper component=\"form\" className={classes.root} onSubmit={SendMessageToDatabaseAndScreen}>\n            <OverlayTrigger trigger=\"click\" placement=\"top\" overlay={\n                <Popover id=\"popover-basic\">\n                    <Picker title={'Emoji v2'} showPreview={false} set='emojione' onSelect={onEmojiClick} />\n                </Popover>\n            }>\n                <IconButton className={classes.iconButton} aria-label=\"emoji\">\n                    <SentimentVeryDissatisfiedSharpIcon />\n                </IconButton>\n            </OverlayTrigger>\n\n            <InputBase\n                onChange={onTyping}\n                value={input}\n                rowsMax={8}\n                multiline={true}\n                className={classes.input}\n                placeholder=\"write smth\"\n                inputProps={{ 'aria-label': 'search google maps' }}\n            />\n            <IconButton className={classes.iconButton} aria-label=\"upload\">\n                <CloudUploadIcon />\n            </IconButton>\n            <Divider className={classes.divider} orientation=\"vertical\" />\n            <IconButton type='submit' color={submitIsValid() ? 'primary' : 'secondary'} disabled={!submitIsValid()} className={classes.iconButton} aria-label=\"send\">\n                <SendIcon />\n            </IconButton>\n        </Paper>\n    );\n}\n","import React, {useEffect} from 'react';\nimport {ScrollChatToBottom} from \"../../../Helpers/Scroller\";\n\nfunction ChatPanel({messages}) {\n\n    useEffect(()=>{\n        ScrollChatToBottom();\n        },[]);\n\n    return (\n        <ul className={'chat-panel'}>\n            {\n            messages.map((message,i)=>(\n                <li key ={i} className= {message.id === 0 ? 'me' : 'him' }> <div className={'messsage-text'}>{message.message}</div></li>\n            ))\n        }\n        </ul>\n    );\n\n\n}\nexport default ChatPanel;","import React, {useContext, useEffect} from 'react';\nimport Input from \"../InputField/Input\";\nimport './Chat.css';\nimport {MainChatWindowContext} from \"../MainAppWindow/MainAppWindow\";\nimport Button from \"react-bootstrap/Button\";\nimport ChatPanel from \"./Panel/ChatPanel\";\n\n\n\nfunction ChatWindow({chatData,onSend,loadTen,GoBack}) {\n\n    const {chatId,chatIndex,isMobile} = useContext(MainChatWindowContext);\n\n    const LoadMoreMessages = (event) => {\n        loadTen(chatId,chatIndex,false);\n    };\n    return (\n            <div id = {'chat-side'}>\n                {\n                    isMobile\n                        ?<div className=\"container\" >\n                            <div className=\"row header\">\n                                    <Button type=\"button\" variant='secondary' className=\"col-2 arrow-back \" onClick={()=>GoBack('left')}>\n                                        <span className=\"btn-label\">\n                                            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\n                                            <path fill=\"none\" d=\"M0 0h24v24H0V0z\"/>\n                                            <path d=\"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z\"/>\n                                            </svg>\n                                        </span>\n                                        Back\n                                    </Button>\n                                <div className='white tc col-10' style={{backgroundColor:'#6c757d'}}>\n                                    <strong className='black'>{chatData.name}</strong> is<span className={chatData.isOnline?'dark-blue':'white'}> {chatData.isOnline ? ' online' : ' offline'}</span>\n\n                                    <h5 className= 'hover-bg-white-40 pointer' onClick={LoadMoreMessages}>\n                                        Load more messages\n                                    </h5>\n                                </div>\n                            </div>\n                        </div>\n                        : <h4 className='white tc hover-bg-white-40 pointer col-10 flex-none' onClick={LoadMoreMessages}>\n                            Load more\n                        </h4>\n                }\n\n                {\n                    <ChatPanel\n                        messages={chatData.msg}>\n                    </ChatPanel>\n                }\n                <footer className={'footer'}>\n                    <Input onSendClick={onSend}/>\n                </footer>\n            </div>\n    );\n\n\n}\nexport default ChatWindow;","import React, {useContext} from 'react';\nimport ChatWindow from \"../../ChatWindow/ChatWindow\";\nimport {MainChatWindowContext} from \"../MainAppWindow\";\nimport {UserChatsContext} from \"../../../App\";\n\nexport default function RightPart({LoadTenMessages,SendMessage,GoBack}) {\n\n    const {chats} = useContext(UserChatsContext);\n    const {chatIndex,isMobile} = useContext(MainChatWindowContext);\n\n    return (\n        <div className={ isMobile ? 'right-side col-12' :'right-side col-8 col-sm-8 col-md-8 col-lg-10 col-xl-10 '}>\n            <div className='overflow-hidden'>\n                <div className=\"container\">\n                    <div className=\"row\">\n                        {chatIndex === -1\n                            ?\n                                chats.length !== 0\n                                    ?\n                                    <div className='tc center col align-self-center'\n                                       id={'idle-msg'}>{'Click on a chat to start messaging!'}\n                                    </div>\n                                    :\n                                    <div className='tc center col align-self-center'\n                                         id={'idle-msg'}>{'Click on a button in top left corner and add someone!'}\n                                    </div>\n                            : <div className='col'>\n                                <ChatWindow loadTen={LoadTenMessages} chatData={chats[chatIndex]} onSend={SendMessage} GoBack = {GoBack}/>\n                            </div>\n                        }\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n}\n","import React, {useEffect, useState} from \"react\";\nimport notification from '../../sounds/notification.mp3';\nimport Sound from 'react-sound';\n\n\nexport  function NewChat({name,sound}) {\n    return (\n        <div>\n            <strong>New chat!</strong>\n            <div>\n                <strong>{name}</strong> created a chat with you!\n            </div>\n            {sound\n                ?<Sound url= {notification} autoLoad={true} playStatus={Sound.status.PLAYING}/>\n                :<div/>\n            }\n        </div>\n    );\n}\nexport  function NewMessage({name,body,sound}) {\n    return (\n        <div>\n            <strong>{name}</strong>\n            <div>\n                {body}\n            </div>\n            {sound\n                ?<Sound url= {notification} autoLoad={true} playStatus={Sound.status.PLAYING}/>\n                :<div/>\n            }\n        </div>\n    );\n}\n\nexport  function OnlineOrOffline({online,sound}) {\n\n    return (\n        <div>\n            <strong>Connection status changed!</strong>\n            <div>\n                { online ? 'You are online now':'You went offline, your messages will not be sent!' }\n            </div>\n            {\n                !online?\n                    <div>\n                        We will try to reconnect you!\n                    </div>\n                    :\n                    <div/>\n            }\n            {sound\n                ?<Sound url= {notification} autoLoad={true} playStatus={Sound.status.PLAYING}/>\n                :<div/>\n            }\n        </div>\n    );\n}\nexport  function ReconnectFail({isLast,nextTime,sound}) {\n\n    const[timer,setTimer] = useState(nextTime);\n\n\n    useEffect(()=>{\n        const interval = setInterval(() => setTimer(timer-1), 1000);\n        return function cleanup() {\n            clearInterval(interval);\n        }},[timer]\n    );\n    return (\n        <div>\n            <strong>Reconnection failed!</strong>\n            <div>\n                { isLast ? 'Failed to reconnect, please reload the page or try again later.':`We will try again in ${timer} seconds.` }\n            </div>\n            {sound\n                ? <Sound url= {notification} autoLoad={true} playStatus={Sound.status.PLAYING}/>\n                :<div/>\n            }\n\n        </div>\n    );\n}\n\n","import {HubConnectionBuilder} from \"@aspnet/signalr\";\nimport { FindChatIndexByChatId,CheckIfChatIdMatchIsPresent} from \"./ProcessData\";\nimport {AESKEY,AESIV, BackendLink} from \"../Constants/Const\";\nimport {SetUserOffline} from \"./ApiFetcher\";\nimport {ReconnectFail,OnlineOrOffline,NewChat,NewMessage} from \"../Components/Notifications/Notifications\";\nimport React from \"react\";\nimport {MessageIF} from \"../Components/ChatWindow/Message/MessageIF\";\nconst CryptoJS = require(\"crypto-js\");\n\n//very very hacky\nexport async function createHubConnection (setUser,setChats,setHub,PopupNotification,setChatIndex,setChatId) {\n\n    const hubConnect = new HubConnectionBuilder()\n        .withUrl(`${BackendLink}/chat`)\n        .build();\n\n    // my fav hack\n    let loc_user;\n    setUser(prev=>{\n        loc_user = prev;\n        return prev;\n    });\n\n    if(!loc_user) return;\n\n    try {\n        await hubConnect.start();\n\n        //show others u went online\n        await hubConnect.invoke('UserWentOfflineOrOnline',true,loc_user.userId);\n\n        const {sound,connectionChanged} = loc_user.notificationSettings;\n\n        if(connectionChanged) PopupNotification(<OnlineOrOffline online = {true} sound={sound}/>,'success',3000);\n\n        //after socket dies, it sends a request to put user offline in the db\n        hubConnect.onclose(() => {\n            SetUserOffline(loc_user.userId);\n            // need to use this hack again :((\n            let l_user;\n            setUser(prev=>{\n                l_user = prev;\n                return prev;});\n            // if user still exists -> show notification that he is offline else he logged out and try to reconnect\n                if (l_user) {\n                    const {sound,connectionChanged} = l_user.notificationSettings;\n                    if(connectionChanged) PopupNotification(<OnlineOrOffline sound={sound} online={false}/>, 'warning', 3000);\n                    Reconnect(0,hubConnect,setHub,PopupNotification,l_user.notificationSettings)\n                        .then(()=>{\n                                //TODO load messages that were missed and add to state instead of discarding all\n                                //discard all chats, load them on click\n                                setChatIndex(-1);\n                                setChats(oldChats=>{\n                                    let newChats = [...oldChats];\n                                    newChats.forEach(chat=>{\n                                        chat.msg = [];\n                                        chat.lastMessagesAreFetched = false;\n                                    });\n                                    return newChats;\n                                })\n                            })\n                        .catch(err=>console.log(err));\n                   }}\n                );\n        hubConnect.on('sendDirectMessage', (userId,chatId,messageText)=>{\n            //can't move the insides of to a different method -> it crashes\n\n            let decrypted =  CryptoJS.AES.decrypt(messageText,\n                CryptoJS.enc.Base64.parse(AESKEY),\n                {iv:CryptoJS.enc.Base64.parse(AESIV) });\n\n            messageText = CryptoJS.enc.Utf8.stringify(decrypted);\n\n            // need to use this hack again :((\n            let l_user;\n            setUser(prev=>{\n                l_user = prev;\n                return prev;});\n            const {sound,newMessageReceived} = l_user.notificationSettings;\n            setChats(prevState => {\n                // index where the chat is located for current client\n                const neededChatIndex = FindChatIndexByChatId(chatId,prevState);\n                // update state if the user has chat with this id\n                if(neededChatIndex !== -1 && l_user.userId !== userId){\n                    let updatedChats = Object.assign([],prevState);\n                    updatedChats[neededChatIndex].msg.push(new MessageIF({id:1,message:messageText}));\n                    updatedChats[neededChatIndex].isOnline = true;\n\n                    if (newMessageReceived) PopupNotification(<NewMessage sound={sound} name={ updatedChats[neededChatIndex].name} body={messageText}/>,'info',5000);\n\n                    const neededChat = updatedChats[neededChatIndex];\n                    updatedChats.splice(neededChatIndex, 1);\n                    updatedChats.unshift(neededChat);\n                    let id;\n                    setChatId(prev=>{\n                        id = prev;\n                        return prev;\n                    });\n                    setChatIndex(()=>{\n                        const currentChatIndex = FindChatIndexByChatId(id,updatedChats);\n                        return currentChatIndex;\n                    });\n                    return updatedChats;\n                }\n                else{\n                    return prevState;\n                }\n            })\n        });\n\n        //check if user who came online is not you -> update state\n        hubConnect.on('UserWentOfflineOrOnline',(online,userId,chatIds)=> {\n            setChats(chats=>{\n                let updatedChats = Object.assign([],chats);\n                if(userId !== loc_user.userId){\n                    const checkMatch = CheckIfChatIdMatchIsPresent(chats,chatIds);\n                    if(checkMatch.found){\n                        let index = FindChatIndexByChatId(checkMatch.id,chats);\n                        //put user online/offline depending on that invoke parameter\n                        updatedChats[index].isOnline = online;\n                    }\n                }\n                return updatedChats;\n            })\n        });\n\n        hubConnect.on('UserDataChanged',(userId,userChatIds,type,value)=>{\n           if(loc_user.userId !== userId){\n               setChats(chats=> {\n                   let updatedChats = [...chats];\n                   const checkMatch = CheckIfChatIdMatchIsPresent(chats, userChatIds);\n                   if (checkMatch.found) {\n                       let index = FindChatIndexByChatId(checkMatch.id, chats);\n                       const neededChat = updatedChats[index];\n                       neededChat[type] = value;\n                   }\n               return updatedChats;\n               });\n           }\n        });\n        //when getCHat is received add an empty chat\n        hubConnect.on('getChat', (userId,chat)=>{\n            let l_user;\n            setUser(prev=>{\n                l_user = prev;\n                return prev;});\n\n            if(loc_user.userId === userId){\n                setChats(prev=>{\n                    let updatedChat = Object.assign([],prev);\n                    updatedChat.push({id:chat.chatId,image:chat.image,isOnline:true,name:chat.chatName,msg:[]});\n                    return Object.assign([],updatedChat);\n                });\n            const {sound,newChatReceived} = l_user.notificationSettings;\n            if(newChatReceived) PopupNotification(<NewChat name={chat.chatName} sound={sound}/>,'info',5000);\n        }});\n    }\n    // if user logged in but didnt connect to webSocket after\n    catch (err) {\n        console.log(err);\n        PopupNotification(<OnlineOrOffline online={false}/>, 'warning', 3000);\n        Reconnect(0,hubConnect,setHub,PopupNotification,loc_user.notificationSettings);\n    }\n    return hubConnect;\n}\n// function that tries to connect to socket every x,2x,3x,4x seconds after which it stops\nasync function Reconnect (time,hubConnect,setHub,PopupNotification,userNotificationSettings) {\n    let timeout = 3000;\n    const {sound,connectionChanged} = userNotificationSettings;\n    setTimeout(()=>{\n        hubConnect.start()\n            .then(()=>{\n                setHub(hubConnect);\n                if(connectionChanged) PopupNotification(<OnlineOrOffline online = {true} sound={sound}/>,'success',4000);\n                return new Promise((resolve,reject) => resolve(true));\n            })\n            .catch(()=>{\n                if(time < 4) {\n                    if(connectionChanged) PopupNotification(<ReconnectFail sound={sound} nextTime={timeout * (time+1) / 1000} isLast={false}/>,'warning',timeout * (time+1));\n                    Reconnect(time+1,hubConnect,setHub,PopupNotification,userNotificationSettings);\n                }\n                else {\n                    PopupNotification(<ReconnectFail isLast={true}/>,'error',70000);\n                    return false;\n                }\n            });\n    },timeout * time);\n}\n\n\n\n\n","import React,{useState,useEffect,useContext} from 'react';\nimport {Redirect } from \"react-router-dom\";\nimport {UserChatsContext} from \"../../App\";\nimport SwitchToMobileModal from \"./Modals/SwitchToMobileModal\";\nimport '../../App.css';\nimport witcher from '../../sounds/lol.mp3';\nimport drStone from '../../sounds/dr_stone_ending.mp3';\nimport {AddTenMessagesToState} from \"../../Helpers/ProcessData\";\nimport useMobileDetect from 'use-mobile-detect-hook';\nimport LeftPart from \"./SubWindows/ScreenWithFriends\";\nimport RightPart from \"./SubWindows/ScreenWithChats\";\nimport {createHubConnection} from \"../../Helpers/HubConnection\";\nimport {useToasts} from \"react-toast-notifications\";\nimport {useCookies} from 'react-cookie';\nimport {ScrollChatToBottom} from \"../../Helpers/Scroller\";\n\nexport const MainChatWindowContext = React.createContext({chatId:null,chatIndex:null,isMobile:false});\n\nconst MainAppWindow =({setChats,SendMessage,logout,createNewChat,setUser,setHubConnection})=> {\n\n    const {user,chats} = useContext(UserChatsContext);\n    const detectMobile = useMobileDetect();\n    const {addToast,removeToast } = useToasts();\n\n    const[chatId,setChatId] = useState(-1);\n    const[chatIndex,setChatIndex] = useState(-1);\n    const[song,setSong] = useState(null);\n    const[redirect,setRedirect] = useState(false);\n    const[isMobile,setIsMobile] = useState(false);\n    const[partToShow,setPartToShow] = useState('left');\n    const [cookies,setCookie,removeCookie] = useCookies(['userToken']);\n\n\n    useEffect( ()=>{\n            createHubConnection(setUser,setChats,setHubConnection,PopUpNotification,setChatIndex,setChatId)\n                .then(hub=>{\n                    setHubConnection(hub)\n                });\n    },[]);\n\n    //Add toast with desired style and content, remove it after the timeout\n    const PopUpNotification = (content,appearance,removeTimer) =>{\n        addToast(content, {\n                appearance: appearance,\n                autoDismiss: false,\n            },(id)=> {\n                // if timer is more then a minute just keep it there forever, else destroy after timeout\n                if (removeTimer < 60000) setTimeout(() => removeToast(id), removeTimer);\n            }\n        );\n    };\n    const setSongMP3 = (songname) =>{\n        switch (songname) {\n            case 'witcher':\n                return witcher;\n            case 'drStone':\n                return drStone;\n            default:\n                return;\n        }\n    };\n\n    const UpdateUserData = (type,value) =>{\n        //hack will be removed later, when Redux will be used\n        let l_hub;\n        setHubConnection(hub=>{\n          l_hub = hub;\n          return hub;\n         });\n      setUser(user=>{\n          let newUser = {...user};\n          switch (type) {\n              case 'image':\n                  newUser.imageUrl = value;\n                  break;\n              case 'name':\n                  newUser.userName = value;\n                  break;\n              case 'notifications':\n                  newUser.notificationSettings = value;\n                  break;\n              default:\n                  break;\n          }\n          return newUser;\n      });\n      if(type !== 'notifications'){\n          l_hub.invoke('UserDataChanged',user.userId,type,value);\n      }\n      removeCookie('userToken');\n    };\n\n    //Fetches the messages and updates the state of chats\n    const LoadTenMessages = (id,index,shouldSetChatId) =>{\n\n        // if should set chat id => method was called when clicking on a chat on the left, else from a chat itself\n        if(shouldSetChatId) setChatId(id);\n\n        let currentChatsState = [...chats];\n        // works as a pointer (e.g changing this object will change it in the array as well)\n        let currentChat = currentChatsState[index];\n\n        //if there are more than 10 messages in the chat already, don't load new on first click\n        if(!currentChat.lastMessagesAreFetched && currentChat.msg.length > 10) currentChat.lastMessagesAreFetched = true;\n\n        //fetch only if it is first click on chat or when more messages are requested from chat + chat has more than 10 messages already\n        if(!currentChat.lastMessagesAreFetched || (!shouldSetChatId && currentChat.msg.length > 10)) {\n            const numberOfMessages = currentChat.msg.length;\n            const shouldScrollUp = currentChat.lastMessagesAreFetched;\n            const chatWindow = document.getElementsByClassName(\"chat-panel\")[0];\n            AddTenMessagesToState(id,user,currentChat)\n                .then(newState => {\n                    // if anything has changed, update and scroll\n                    if(numberOfMessages !== newState.msg.length){\n                        setChats(currentChatsState);\n                        if(shouldScrollUp) chatWindow.scrollTop = 0;\n                        else ScrollChatToBottom();\n                    }\n                })\n                .catch(err => {\n                    console.log(err);\n                    alert('error loading messages');\n                });\n        }\n    };\n\n    const updAudio = (enable) => {\n        const a = document.getElementsByTagName(\"audio\")[0];\n        enable ? a.play() : a.pause();\n    };\n\n    const setChatOnMobile = (index) =>{\n        setChatIndex(index);\n        setPartToShow('right');\n    };\n\n    const SendMessageAndSetIndex = (text) =>{\n      const SendMessageWithChatData = SendMessage(chatId,chatIndex);\n      SendMessageWithChatData(text);\n      setChatIndex(0);\n    };\n\n    useEffect(()=>{\n        if(!user){\n            setRedirect(true);\n        }\n    }, [detectMobile, user]);\n\n    return (\n        <>\n            <MainChatWindowContext.Provider value = {{chatId,chatIndex,isMobile}} >\n                {detectMobile.isMobile()\n                    ?<SwitchToMobileModal setIsMobile={setIsMobile}/>\n                    :<div/>}\n                {redirect\n                    ? <Redirect to ={'/'}/>\n                    : <div className=\"row\">\n                        <audio src={setSongMP3(song)} preload={'true'} loop/>\n                        {isMobile\n                            ?\n                            partToShow === 'left'\n                                ?<LeftPart LoadTenMessages={LoadTenMessages} createNewChat={createNewChat} logout={logout} setChatIndex={setChatOnMobile} setSong={setSong} updAudio={updAudio} UpdateUserData={UpdateUserData}/>\n                                :<RightPart  LoadTenMessages={LoadTenMessages} SendMessage={SendMessageAndSetIndex} GoBack = {setPartToShow} />\n                            : <>\n                                <LeftPart LoadTenMessages={LoadTenMessages} createNewChat={createNewChat} logout={logout} setChatIndex={setChatIndex} setSong={setSong} updAudio={updAudio} UpdateUserData={UpdateUserData}/>\n                                <RightPart LoadTenMessages={LoadTenMessages} SendMessage={SendMessageAndSetIndex} />\n                            </>\n                        }\n                    </div>\n                }\n            </MainChatWindowContext.Provider>\n        </>\n    );\n};\nexport default MainAppWindow;\n","import React, {useState} from \"react\";\nimport { Button, FormGroup, FormControl } from \"react-bootstrap\";\nimport '../Login.css';\nimport FormLabel from \"react-bootstrap/FormLabel\";\nimport Card from \"react-bootstrap/Card\";\nimport Spinner from \"react-bootstrap/Spinner\";\nimport GoogleLogin from 'react-google-login';\n\n\nimport {\nRedirect\n} from \"react-router-dom\";\n\nexport default function Login({loginOrRegister}) {\n\n    const [email, setEmail] = useState(\"\");\n    const [error, setError] = useState(\"\");\n    const [password, setPassword] = useState(\"\");\n    const [isConnecting, setIsConnecting] = useState(false);\n    const [success,setSuccess] = useState(false);\n\n\n    function validateForm() {\n        return email.length > 0 && password.length > 0;\n    }\n    const responseGoogle = async (response) => {\n        await handleLogin('google',response.id_token);\n    };\n\n\n    async function handleSubmit(event) {\n        event.preventDefault();\n        await handleLogin('login');\n    }\n\n    async function handleLogin (endpoint,token){\n        setIsConnecting(true);\n        setTimeout(()=>console.log(),1000);\n        try {\n            const param = endpoint === 'login' ? {email, password} : {token};\n            let loginStatus = await loginOrRegister(param,endpoint);\n            if(loginStatus === 'duplicate'){\n                throw new Error('Please finish another session before starting a new one.');\n            }\n            setSuccess(true);\n        }\n        catch(error) {\n            setTimeout(() => {\n                setIsConnecting(false);\n                if(error.toString().includes('Failed to fetch')){\n                    setError('No response from the server')\n                }else {\n                    setError(error.message);\n                }\n            }, 1000);\n        }\n    }\n    return (\n        <>\n        {success\n            ? <Redirect to={'/app'}/>\n            : <Card className=\"Login\">\n                <Card.Header> Sign In </Card.Header>\n                <Card.Body>\n                    <form onSubmit={handleSubmit}>\n                        <FormGroup controlId=\"email\">\n                            <FormLabel>Email</FormLabel>\n                            <FormControl\n                                autoFocus\n                                type=\"email\"\n                                value={email}\n                                onChange={e => setEmail(e.target.value)}\n                            />\n                        </FormGroup>\n                        <FormGroup controlId=\"password\">\n                            <FormLabel>Password</FormLabel>\n                            <FormControl\n                                value={password}\n                                onChange={e => setPassword(e.target.value)}\n                                type=\"password\"\n                            />\n                        </FormGroup>\n                        {error\n                            ? <FormGroup>\n                                <div className='tc dark-red'>{error}</div>\n                            </FormGroup>\n                            : <></>\n                        }\n\n                        <FormGroup className='tc'>\n                            <a className='tc' href={'/rocket-chat-front/#/register'}>Not signed up yet?</a>\n                            <div style={{marginTop:'15px'}}>\n                                {\n\n                                <GoogleLogin\n                                    clientId={process.env.REACT_APP_GOOGLE_ID}\n                                    buttonText=\"I am real\"\n                                    onSuccess={responseGoogle}\n                                    onFailure={()=>{\n                                        setError('Failed to login with Google!')\n                                    }}\n                                    cookiePolicy={'single_host_origin'}\n                                />\n                                }\n                            </div>\n                        </FormGroup>\n                        <Button block variant={!validateForm() ? 'secondary' : \"primary\"}\n                                disabled={!validateForm() || isConnecting} type=\"submit\">\n                            {!isConnecting\n                                ? 'Login'\n                                : <Spinner\n                                    as=\"span\"\n                                    animation=\"border\"\n                                    size=\"sm\"\n                                    role=\"status\"\n                                    aria-hidden=\"true\"\n                                />\n                            }\n                        </Button>\n                    </form>\n                </Card.Body>\n            </Card>\n        }\n</>\n    );\n}","import React, { useState } from \"react\";\nimport { Button, FormGroup, FormControl } from \"react-bootstrap\";\nimport '../Login.css';\nimport FormLabel from \"react-bootstrap/FormLabel\";\nimport Card from \"react-bootstrap/Card\";\nimport Spinner from \"react-bootstrap/Spinner\";\nimport {Redirect} from \"react-router-dom\";\nimport {PasswordStrLevels} from \"../../../Constants/Const\";\nimport swal from \"sweetalert\";\n\nexport default function Register({loginOrRegister}) {\n\n    const [email, setEmail] = useState(\"\");\n    const [name, setName] = useState(\"\");\n    const [password, setPassword] = useState(\"\");\n    const [isConnecting, setIsConnecting] = useState(false);\n    const [error, setError] = useState(\"\");\n    const [success,setSuccess] = useState(false);\n    const [passwordStrength,setPasswordStrength] = useState(0);\n\n\n    function validateForm() {\n        return email.length > 0 && passwordStrength > 2 && name.length;\n    }\n\n    async function handleSubmit(event) {\n        event.preventDefault();\n\n        setIsConnecting(true);\n        setTimeout(()=>console.log(),1000);\n        try {\n            await loginOrRegister({username:name,email, password}, 'register');\n            setIsConnecting(false);\n            await swal(\"Almost there\", `We saved all your data, confirm your email to start using our app!`, \"success\");\n             (setSuccess(true));\n        }\n        catch(error) {\n            setTimeout(() => {\n                setIsConnecting(false);\n                if(error.toString().includes('Failed to fetch')){\n                    setError('No response from the server')\n                }else {\n                    setError(error.message);\n                }\n            }, 500);\n        }\n    }\n    const checkPassWordStrength = (event) =>{\n        let currentStr = 0;\n        let input = event.target.value;\n\n        if(input.length > 5) currentStr++;\n        if(input.length > 7) currentStr++;\n        //if has a number\n        if(input.match(/\\d+/g)) currentStr++;\n        //if has an uppercase\n        const low = input.toLowerCase();\n        if(low !== input) currentStr ++;\n\n        setPasswordStrength(currentStr);\n        setPassword(input);\n\n    };\n    return (\n        <>\n            {success\n                ? <Redirect to={'/login'}/>\n                : <Card className=\"Login\">\n                    <Card.Header> Register </Card.Header>\n                    <Card.Body>\n                        <form onSubmit={handleSubmit}>\n                            <FormGroup controlId='name'>\n                                <FormLabel>Name</FormLabel>\n                                <FormControl\n                                    autoFocus\n                                    type=\"text\"\n                                    value={name}\n                                    onChange={e => setName(e.target.value)}\n                                />\n                            </FormGroup>\n                            <FormGroup controlId=\"email\">\n                                <FormLabel>Email</FormLabel>\n                                <FormControl\n                                    autoFocus\n                                    type=\"email\"\n                                    value={email}\n                                    onChange={e => setEmail(e.target.value)}\n                                />\n                            </FormGroup>\n                            <FormGroup controlId=\"password\" >\n                                <FormLabel>Password</FormLabel>\n                                <FormControl\n                                    style = {{borderBottom: `3px solid ${PasswordStrLevels[passwordStrength].color}`}}\n                                    value={password}\n                                    onChange={checkPassWordStrength}\n                                    type=\"password\"\n                                />\n                            </FormGroup>\n                            {error\n                                ? <FormGroup>\n                                    <div className='tc dark-red'>{error}</div>\n                                </FormGroup>\n                                : <></>\n                            }\n                                <Button block variant={!validateForm() ? 'secondary' : \"primary\"}\n                                        disabled={!validateForm() || isConnecting} type=\"submit\">\n                                    {!isConnecting\n                                        ? 'Register'\n                                        : <Spinner\n                                            as=\"span\"\n                                            animation=\"border\"\n                                            size=\"sm\"\n                                            role=\"status\"\n                                            aria-hidden=\"true\"\n                                        />\n                                    }\n                                </Button>\n                        </form>\n                    </Card.Body>\n                </Card>\n            }\n            </>\n    );\n}","import React from 'react';\nimport Tab from \"react-bootstrap/Tab\";\nimport Row from \"react-bootstrap/Row\";\nimport Col from \"react-bootstrap/Col\";\nimport Nav from \"react-bootstrap/Nav\";\nimport {FAQDATA,RELEASEDATA} from \"../../../Constants/Const\";\n\nexport default function FAQorReleaseInfo({isFAQ}) {\n\n    return (\n        <div>\n            <Tab.Container id=\"left-tabs-example\" defaultActiveKey={isFAQ ? FAQDATA[0].question : RELEASEDATA[0].version }>\n                <Row className = 'bg-black-90 align-content-start'>\n                    <Col md={4} lg={4} xl={4} sm={12} xs={12} >\n                        <Nav variant='pills' className=\"flex-column b--solid b--light-blue\">\n                            { isFAQ\n                                ? FAQDATA.map((qa) =>(\n                                    <Nav.Item key = {qa.question}>\n                                        <Nav.Link  eventKey={qa.question}>{qa.question}</Nav.Link>\n                                    </Nav.Item>\n                                ))\n                                : RELEASEDATA.map((vc) =>(\n                                    <Nav.Item key = {vc.version}>\n                                        <Nav.Link  eventKey={vc.version}>{vc.version}</Nav.Link>\n                                    </Nav.Item>\n                                ))\n                            }\n                        </Nav>\n                    </Col>\n                    <Col sm={12} xs={12} md={8} xl={8} lg={8} >\n                        <Tab.Content className = 'white ma3'>\n                            {isFAQ\n                                ? FAQDATA.map((qa) =>(\n                                    <Tab.Pane eventKey={qa.question} key = {qa.answer}>\n                                        {qa.answer}\n                                    </Tab.Pane>\n                                ))\n                                :\n                                    RELEASEDATA.map((vc) => (\n                                        <Tab.Pane key = {vc.changes[0]} eventKey={vc.version}>\n                                            <ul>\n                                                {vc.changes.map(change=>(\n                                                    <li key = {change}>{change}</li>\n                                                ))}\n                                            </ul>\n                                        </Tab.Pane>\n                                    ))\n                                }\n                        </Tab.Content>\n                    </Col>\n                </Row>\n            </Tab.Container>\n        </div>\n    );\n}\n","import React, {useEffect, useState} from \"react\";\nimport '../Login.css';\nimport Card from \"react-bootstrap/Card\";\nimport {Redirect} from \"react-router-dom\";\n\nexport  function EmailedVerified({success}) {\n\n    const [redirect,setRedirect] = useState({done:false,time:4});\n\n    useEffect(()=>{\n        const interval = setInterval(() => {\n            let newVal = {...redirect};\n            if(redirect.time < 2){\n                newVal.done = true\n            }\n            newVal.time -=1;\n            setRedirect(newVal)\n        }, 1000);\n        return function cleanup() {\n            clearInterval(interval);\n        }},[redirect]\n    );\n\n    return (\n        <>\n            {redirect.done\n                ? <Redirect to={'/login'}/>\n                : <Card className=\"Login\">\n                    <Card.Header>Email verification</Card.Header>\n                    <Card.Body>\n                        {\n                            success\n                                ? <div>Your email was verified <span\n                                    className={'green'}>successfully</span> :)<br/> Redirecting you in {redirect.time}</div>\n                                : <div>Email verification <span className={'red'}>failed</span> :( <br/> Redirecting you\n                                    in {redirect.time} </div>\n                        }\n                    </Card.Body>\n                </Card>\n            }\n        </>\n    );\n};\n","import React, {useContext} from 'react';\nimport Navbar from \"react-bootstrap/Navbar\";\nimport Alert from \"react-bootstrap/Alert\";\nimport Nav from \"react-bootstrap/Nav\";\nimport Login from \"./Submodules/Login\";\nimport Register from \"./Submodules/Register\";\nimport './welcome.css';\nimport LoadingOverlay from 'react-loading-overlay';\nimport FAQorReleaseInfo from \"./Submodules/FAQorReleaseInfo\";\nimport {EmailedVerified} from \"./Submodules/EmailVerification\";\nimport {UserChatsContext} from \"../../App\";\nimport {RELEASEDATA} from \"../../Constants/Const\";\n\nfunction WelcomePage({loginOrRegister,path}) {\n\n    const {isLoading} = useContext(UserChatsContext);\n\n    return (\n        <>\n            <LoadingOverlay\n                active={isLoading}\n                spinner\n                text='Loading your data'\n            >\n                <div className='welcome-page overflow-y-auto overflow-x-hidden' >\n                    <Navbar bg=\"dark\" variant={'dark'} expand=\"lg\">\n                        <Navbar.Brand href = {'/rocket-chat-front/#/login'} >Rocket-Chat {RELEASEDATA[0].version} BETA</Navbar.Brand>\n                        <Navbar.Toggle aria-controls=\"basic-navbar-nav\" />\n                        <Navbar.Collapse id=\"basic-navbar-nav\">\n                            <Nav className=\"mr-auto \">\n                                <Nav.Link href = {'/rocket-chat-front/#/faq'}>FAQ</Nav.Link>\n                                <Nav.Link href = {'/rocket-chat-front/#/release'}>Release notes</Nav.Link>\n                            </Nav>\n                            <Nav>\n                                <Nav.Link href = {'/rocket-chat-front/#/login'}>Sign in</Nav.Link>\n                                <Nav.Link href = {'/rocket-chat-front/#/register'}>Register</Nav.Link>\n                            </Nav>\n                        </Navbar.Collapse>\n                    </Navbar>\n                    <Alert  variant={'warning'} className={'tc ma0'}>\n                        <strong>99.9% sure your account won't be deleted again!!<br/>\n                            Make sure to check out our <a href={'/rocket-chat-front/#/release'}>release notes</a>!\n                        </strong>\n                    </Alert>\n                    {\n                        {\n                            '/login': <Login loginOrRegister={loginOrRegister}/>,\n                            '/register': <Register loginOrRegister={loginOrRegister}/>,\n                            '/faq':<FAQorReleaseInfo isFAQ={true}/>,\n                            '/release':<FAQorReleaseInfo isFAQ={false}/>,\n                            '/vsuccess':<EmailedVerified success={true}/>,\n                            '/vfailed':<EmailedVerified success={false}/>\n                        }[path]\n                    }\n                    {path === '/login' || path === '/register'\n                        ? <img src={'https://dramarocket.com/wp-content/uploads/2018/01/icon-redrocket-2.png'} alt={'logo'}\n                               className={'center'}/>\n                        : <div/>\n                    }\n                </div>\n            </LoadingOverlay>\n        </>\n    );\n}\nexport default WelcomePage;","import jwt from'jsonwebtoken';\nimport {TokenSignature} from \"../Constants/Const\";\n\n\nexport const ValidateToken = (token) => {\n\n    try {\n        let decoded = jwt.verify(token, TokenSignature);\n        return decoded;\n    } catch(err) {\n        throw err;\n    }\n};\n","import React, {useEffect, useState} from 'react';\nimport MainAppWindow from \"./Components/MainAppWindow/MainAppWindow\";\nimport { HashRouter as Router, Switch, Route, Redirect} from \"react-router-dom\";\nimport './App.css';\nimport WelcomePage from \"./Components/Welcome/WelcomePage\";\nimport {GetAllChatsByUserId, SetUserOffline, TryLoginOrRegister} from \"./Helpers/ApiFetcher\";\nimport {ProcessChats} from \"./Helpers/ProcessData\";\nimport {ToastProvider} from \"react-toast-notifications\";\nimport {gapi} from \"gapi-script\";\nimport {AESKEY,AESIV, ROUTES} from \"./Constants/Const\";\nimport {ValidateToken} from \"./Helpers/TokenValidation\";\nimport {useCookies} from \"react-cookie\"\nimport {MessageIF} from \"./Components/ChatWindow/Message/MessageIF\";\nconst CryptoJS = require(\"crypto-js\");\n\nexport const UserChatsContext = React.createContext({user:{},chats:[],isLoading:false});\n\nfunction App() {\n\n    const[user,setUser] = useState(null);\n    const [chats,setChats] = useState([]);\n    const[hubConnection,setHubConnection] = useState(null);\n    const [cookies, setCookie, removeCookie] = useCookies(['userToken']);\n    const[isLoading,setIsLoading] = useState(false);\n    const[isLoggedIn,setLoggedIn] = useState(false);\n\n    // A function to load chats with last message, to be used on login\n    //Determines what is going to be displayed on the left side of main chat window\n    // Check every chat data received from the backed and renders accordingly\n    async function GetChats(userId)  {\n        try {\n            let chats = await GetAllChatsByUserId(userId);\n            const chatsToState = ProcessChats(chats,userId);\n            setChats(chatsToState);\n            return 'ok';\n        }\n        catch(err){ alert('error loading chats') }\n    }\n\n    const CreateNewChat = (chatId,chatName,friendImageUrl) => {\n        hubConnection.invoke('ChatWithUserWasCreated',user.userId,chatId,{chatId,chatName:user.userName,image:user.imageUrl});\n        setChats(prevState => {\n            let updatedChat = Object.assign([],prevState);\n            updatedChat.push({id:chatId,image:friendImageUrl,name:chatName,msg:[]});\n            return updatedChat;\n        })\n    };\n\n    useEffect(()=>{\n        const token = cookies.userToken;\n        ValidateAndSetUser(token)\n            .then((user)=> {\n                setUser(user);\n                setLoggedIn(true)\n            })\n            .catch(()=>console.log('No cookie :('));\n    },[]);\n\n    async function ValidateAndSetUser(token){\n        try {\n            let user = ValidateToken(token);\n            user.notificationSettings = JSON.parse(user.notificationSettings);\n            user.isOnline = user.isOnline === 'true';\n            user.userId = parseInt(user.userId);\n            if(user.isOnline){\n                //TODO make proper two device logic\n                //return 'duplicate';\n            }\n            setUser(user);\n            setIsLoading(true);\n            await GetChats(user.userId);\n            setIsLoading(false);\n\n            return user;\n        }\n        catch (e) {throw e;}\n    }\n    //Function that tries to log in or register based on parameter\n    //if successful, starts socket communication and invokes GetChats method defined above\n    async function loginOrRegister (loginData,endpoint){\n        try {\n            let result = await TryLoginOrRegister(loginData,endpoint);\n            if (result) {\n                // in case of registration\n                if(result.text) return result.text;\n                //expires in one day\n                setCookie('userToken',result.userToken,{maxAge:86400});\n                await ValidateAndSetUser(result.userToken);\n            }\n            return 'ok';\n        }\n        catch(err) {\n            console.log(err);\n            throw err;\n        }\n    }\n    //Function that uses a closure(google it)\n    //after determining chat data, renders a new message + sends it to the server on the next invoke\n    const SendMessage = (chatId,chatIndex) => {\n        let l_chatIndex = chatIndex;\n        let l_chatId = chatId;\n        //invoke 'sendMessage' with chatId most likely\n        return function (msgText) {\n            let ciphertext = CryptoJS.AES.encrypt(msgText,\n                CryptoJS.enc.Base64.parse(AESKEY),\n                {iv:CryptoJS.enc.Base64.parse(AESIV) }).toString();\n\n            hubConnection.invoke('SendDirectMessage',user.userId,l_chatId,ciphertext).catch(err=>console.log(err));\n\n            setChats(prevState => {\n\n                let updatedChats = Object.assign([],prevState);\n                const neededChat = updatedChats[l_chatIndex];\n                neededChat.msg.push(new MessageIF({id:0,message:msgText,dateTime:new Date()}));\n\n                updatedChats.splice(l_chatIndex, 1);\n                updatedChats.unshift(neededChat);\n                return updatedChats;\n            });\n        };\n    };\n\n    const logout = () => {\n        setUser(null);\n        notifyAboutLogout();\n        setHubConnection(null);\n        TryToDoGoogleLogout();\n        removeCookie('userToken');\n    };\n\n    //when tab closes\n    window.addEventListener(\"beforeunload\", function (e) {\n        SetUserOffline(user.userId);\n        notifyAboutLogout();\n    });\n\n    const notifyAboutLogout = () =>{\n        hubConnection.invoke('UserWentOfflineOrOnline',false,user.userId)\n            .then(()=>hubConnection.stop())\n            .catch(err=>console.log(err));\n    };\n\n    const TryToDoGoogleLogout= () => {\n        try{\n            const auth2 = gapi.auth2.getAuthInstance();\n            auth2.signOut().then(auth2.disconnect());\n        }\n        catch (e) {console.log('Not a googler!')};\n\n    };\n\n    return (\n        <ToastProvider>\n            <Router className = {'rocket'}>\n                <Switch>\n                        <Route path=\"/app\">\n                            <UserChatsContext.Provider value={{user,chats,isLoading}}>\n                                <MainAppWindow setHubConnection={setHubConnection} setUser={setUser} setChats={setChats} SendMessage={SendMessage} logout={logout} createNewChat = {CreateNewChat}/>\n                             </UserChatsContext.Provider>\n                        </Route>\n                        {\n                            ROUTES.map(route => (\n                                <Route path={route} key={route}>\n                                    <UserChatsContext.Provider value={{user,chats,isLoading}}>\n                                         <WelcomePage path={route}/>\n                                    </UserChatsContext.Provider>\n                                </Route>\n                            ))\n                        }\n                        <Route path={'/register'}>\n                            <UserChatsContext.Provider value={{user,chats,isLoading}}>\n                                 <WelcomePage path={'/register'}  loginOrRegister={loginOrRegister}/>\n                            </UserChatsContext.Provider>\n                        </Route>\n                        <Route>\n                            <UserChatsContext.Provider value={{user,chats,isLoading}}>\n                                <WelcomePage path={'/login'}  loginOrRegister={loginOrRegister}/>\n                            </UserChatsContext.Provider>\n                        </Route>\n                </Switch>\n                {isLoggedIn\n                    ?<Redirect to={'/app'}/>\n                    :<div/>\n                }\n            </Router>\n        </ToastProvider>\n        );\n}\nexport default App;","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nimport {RELEASEDATA} from \"./Constants/Const\";\nimport swal from \"sweetalert\";\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              swal(\"New update!\", `Rocket chat ${RELEASEDATA[0].version} was downloaded, close all tabs to update!`, \"success\");\n\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport App from \"./App\";\nimport 'tachyons';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n        <App />\n    , document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register();\n"],"sourceRoot":""}